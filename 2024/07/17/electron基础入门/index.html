<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  <title>electron基础入门 | jinux</title>
  <meta name="description" content="前端 学习 javascript">
  <meta name="keywords" content>
  <meta name="HandheldFriendly" content="True">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="alternate" href="/atom.xml" title="jinux">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="electron+vue3+pinia构建一个桌面应用">
<meta name="keywords" content="vue,electron">
<meta property="og:type" content="article">
<meta property="og:title" content="electron基础入门">
<meta property="og:url" content="/2024/07/17/electron基础入门/index.html">
<meta property="og:site_name" content="jinux">
<meta property="og:description" content="electron+vue3+pinia构建一个桌面应用">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2025-06-24T03:15:44.283Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="electron基础入门">
<meta name="twitter:description" content="electron+vue3+pinia构建一个桌面应用">

  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="icon" href="/favicon.ico">
  <link href="https://fonts.googleapis.com/css?family=Ubuntu" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Inconsolata|Titillium+Web" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet">
  <link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link href="//cdn.bootcss.com/node-waves/0.7.5/waves.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/style.css">
  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>
</head>
</html>
<body>
  <div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>


  <script>setLoadingBarProgress(20)</script>
  <header class="l_header">
	<div class='wrapper'>
		<div class="nav-main container container--flex">
			<a class="logo flat-box" href='/' >
				<!-- <i class="fa fa-home"></i> -->
				jinux
			</a>

				<div class='menu'>
					<ul class='h-list'>
						
							<li>
								<a class='flat-box nav-home' href='/'>
									<i class="fa fa-home"></i>
									主页
								</a>
							</li>
						
							<li>
								<a class='flat-box nav-cube' href='/categories'>
									<i class="fa fa-cube"></i>
									导航
								</a>
							</li>
						
							<li>
								<a class='flat-box nav-github' href='https://github.com/jinux7'>
									<i class="fa fa-github"></i>
									github
								</a>
							</li>
						
							<li>
								<a class='flat-box nav-archive' href='/archives'>
									<i class="fa fa-archive"></i>
									归档
								</a>
							</li>
						
					</ul>
					<div class='underline'></div>
				</div>

			
				<div class="m_search">
					<form name="searchform" class="form u-search-form">
						<input type="text" class="input u-search-input" placeholder="Search" />
						<span class="icon"><i class="fa fa-search"></i></span>
					</form>
				</div>
			
			<ul class='switcher h-list'>
				
					<li class='s-search'><a href='javascript:void(0)'><i class="fa fa-search flat-box"></i></span></a></li>
				
				<li class='s-menu'><a href='javascript:void(0)'><i class="fa fa-navicon flat-box"></i></a></li>
			</ul>
		</div>

		<div class='nav-sub container container--flex'>
			<a class="logo" class="flat-box" href='javascript:void(0)'>
				xaoxuu
			</a>

			<ul class='switcher h-list'>
				<li class='s-comment'><a href='javascript:void(0)'><i class="fa fa-comments flat-box"></i></a></li>
				<li class='s-top'><a href='javascript:void(0)'><i class="fa fa-arrow-up flat-box"></i></a></li>
				<li class='s-toc'><a href='javascript:void(0)'><i class="fa fa-list-ul flat-box"></i></a></li>
			</ul>
		</div>
	</div>
</header>
	<aside class="menu-phone">
        <div class="header">jinux</div>
		<nav>
			
				<a href="/" class="nav-home nav">
					<i class="fa fa-home"></i>
					主页
				</a>
			
				<a href="/categories" class="nav-cube nav">
					<i class="fa fa-cube"></i>
					导航
				</a>
			
				<a href="https://github.com/jinux7" class="nav-github nav">
					<i class="fa fa-github"></i>
					github
				</a>
			
				<a href="/archives" class="nav-archive nav">
					<i class="fa fa-archive"></i>
					归档
				</a>
			
		</nav>
	</aside>

    <script>setLoadingBarProgress(40);</script>
  <div class="l_body">
    <div class='container clearfix'>
      <div class='l_main'>
        <article id="post-electron基础入门" class="post white-box article-type-post" itemscope itemprop="blogPost">
    <section class='meta'>
        <h1 class="title">
            
                electron基础入门
            
        </h1>
        <time>
            2024-07-17 Wednesday&nbsp;&nbsp;
            <i class="fa fa-eye" aria-hidden="true"></i>&nbsp;<span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span>
        </time>
        
    
    <div class='cats'>
        <a href="/categories/nodejs/">nodejs</a>
    </div>


    </section>
    
        <section class="toc-wrapper">
            <div class="header"><i class="fa fa-list" aria-hidden="true"></i>&nbsp;&nbsp;目录</div>
            <div class='content'>
                <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#基础功能"><span class="toc-number">1.</span> <span class="toc-text">基础功能</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#vue3"><span class="toc-number">1.1.</span> <span class="toc-text">vue3</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#安装vue3"><span class="toc-number">1.1.1.</span> <span class="toc-text">安装vue3</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#electron"><span class="toc-number">1.2.</span> <span class="toc-text">electron</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#安装electron"><span class="toc-number">1.2.1.</span> <span class="toc-text">安装electron</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#安装nodemon"><span class="toc-number">1.2.2.</span> <span class="toc-text">安装nodemon</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#安装electron-win-state"><span class="toc-number">1.2.3.</span> <span class="toc-text">安装electron-win-state</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#编写electron应用"><span class="toc-number">1.2.4.</span> <span class="toc-text">编写electron应用</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#添加新功能"><span class="toc-number">2.</span> <span class="toc-text">添加新功能</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#安装对应的库"><span class="toc-number">2.1.</span> <span class="toc-text">安装对应的库</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#改造vue内容"><span class="toc-number">2.2.</span> <span class="toc-text">改造vue内容</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#修改App-vue"><span class="toc-number">2.2.1.</span> <span class="toc-text">修改App.vue</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#新建views"><span class="toc-number">2.2.2.</span> <span class="toc-text">新建views</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#新建router"><span class="toc-number">2.2.3.</span> <span class="toc-text">新建router</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修改Home-vue"><span class="toc-number">2.2.4.</span> <span class="toc-text">修改Home.vue</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修改Detail-vue"><span class="toc-number">2.2.5.</span> <span class="toc-text">修改Detail.vue</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#添加pinia"><span class="toc-number">2.2.6.</span> <span class="toc-text">添加pinia</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#添加loading"><span class="toc-number">2.2.7.</span> <span class="toc-text">添加loading</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#改造electron内容"><span class="toc-number">2.3.</span> <span class="toc-text">改造electron内容</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#electron主进程"><span class="toc-number">2.3.1.</span> <span class="toc-text">electron主进程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#在main-js里新增"><span class="toc-number">2.3.1.1.</span> <span class="toc-text">在main.js里新增</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#controller"><span class="toc-number">2.3.1.2.</span> <span class="toc-text">controller</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#electron渲染进程"><span class="toc-number">2.3.2.</span> <span class="toc-text">electron渲染进程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#后续修改略"><span class="toc-number">2.4.</span> <span class="toc-text">后续修改略</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#自定义Menu"><span class="toc-number">2.5.</span> <span class="toc-text">自定义Menu</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#渲染进程新增事件注册"><span class="toc-number">2.5.1.</span> <span class="toc-text">渲染进程新增事件注册</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#vue侧调用"><span class="toc-number">2.5.2.</span> <span class="toc-text">vue侧调用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#新建buildMenu-js"><span class="toc-number">2.5.3.</span> <span class="toc-text">新建buildMenu.js</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#托盘-amp-app图标"><span class="toc-number">3.</span> <span class="toc-text">托盘&amp;app图标</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#mac端"><span class="toc-number">3.1.</span> <span class="toc-text">mac端</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#window端"><span class="toc-number">3.2.</span> <span class="toc-text">window端</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#全屏"><span class="toc-number">4.</span> <span class="toc-text">全屏</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#打包"><span class="toc-number">5.</span> <span class="toc-text">打包</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#方法一"><span class="toc-number">5.1.</span> <span class="toc-text">方法一</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#window端-1"><span class="toc-number">5.1.1.</span> <span class="toc-text">window端</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#方法二"><span class="toc-number">5.2.</span> <span class="toc-text">方法二</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#window端-2"><span class="toc-number">5.2.1.</span> <span class="toc-text">window端</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#方法三"><span class="toc-number">5.3.</span> <span class="toc-text">方法三</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#打包问题"><span class="toc-number">5.4.</span> <span class="toc-text">打包问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#打包后resources文件加密"><span class="toc-number">5.5.</span> <span class="toc-text">打包后resources文件加密</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#安装asar"><span class="toc-number">5.5.1.</span> <span class="toc-text">安装asar</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#执行asar封装源码"><span class="toc-number">5.5.2.</span> <span class="toc-text">执行asar封装源码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#如何使用"><span class="toc-number">5.5.3.</span> <span class="toc-text">如何使用</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#应用更新"><span class="toc-number">6.</span> <span class="toc-text">应用更新</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#总结"><span class="toc-number">7.</span> <span class="toc-text">总结</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#代码1"><span class="toc-number">7.1.</span> <span class="toc-text">代码1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#代码2"><span class="toc-number">7.2.</span> <span class="toc-text">代码2</span></a></li></ol></li></ol>
            </div>
        </section>
    

    <section class="article typo">

        <div class="article-entry" itemprop="articleBody">
            <p>electron+vue3+pinia构建一个桌面应用<br><a id="more"></a><br>Electron是使用JavaScript，HTML和CSS构建跨平台的桌面应用程序框架。Electron兼容Mac、Windows和Linux，可以构建出三个平台的应用程序。</p>
<p>本教程使用vite+vue3+pinia配合electron开发一个桌面应用。</p>
<blockquote>
<p>app应用功能，点击添加按钮，弹出dialog，填写内容后提交，将内容保存在<code>public/files</code>文件夹下，并且当前列表会展示出目前的文件列表。点击相应的文件会跳转到详情页展示。</p>
</blockquote>
<h1 id="基础功能"><a href="#基础功能" class="headerlink" title="基础功能"></a>基础功能</h1><h2 id="vue3"><a href="#vue3" class="headerlink" title="vue3"></a>vue3</h2><h3 id="安装vue3"><a href="#安装vue3" class="headerlink" title="安装vue3"></a>安装vue3</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm create vite@latest</span><br></pre></td></tr></table></figure>
<p>按照命令行提示输入项目名<code>base-tutorial</code>,之后选择<code>vue</code>项目，语言<code>javascript</code>。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd base-tutorial</span><br><span class="line">npm install</span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure></p>
<p>通过上边的命令可以启动vue3项目了。</p>
<h2 id="electron"><a href="#electron" class="headerlink" title="electron"></a>electron</h2><h3 id="安装electron"><a href="#安装electron" class="headerlink" title="安装electron"></a>安装electron</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i electron -D</span><br></pre></td></tr></table></figure>
<p>electron比较大，根据网络情况可能会安装失败，多尝试几次。</p>
<h3 id="安装nodemon"><a href="#安装nodemon" class="headerlink" title="安装nodemon"></a>安装nodemon</h3><p>开发方便<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i nodemon -D</span><br></pre></td></tr></table></figure></p>
<p>之后在<code>package.json</code>中添加<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">  &quot;start&quot;: &quot;nodemon --exec electron . --watch ./ --ext .js,.html,.css,.vue&quot;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p>
<p>监控<code>.js,.html,.css,.vue</code>这些文件变化，自动重启<code>electron</code>应用。</p>
<h3 id="安装electron-win-state"><a href="#安装electron-win-state" class="headerlink" title="安装electron-win-state"></a>安装electron-win-state</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i electron-win-state --save</span><br></pre></td></tr></table></figure>
<p><code>electron-win-state</code>可以记录应用上次关闭前窗口大小和位置。</p>
<h3 id="编写electron应用"><a href="#编写electron应用" class="headerlink" title="编写electron应用"></a>编写electron应用</h3><p>在<code>package.json</code>中添加<code>electron</code>应用的主入口文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;main&quot;: &quot;main.js&quot;</span><br></pre></td></tr></table></figure></p>
<p>在项目根目录下新建<code>main.js</code>文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">import &#123; app, BrowserWindow &#125; from &apos;electron&apos;;</span><br><span class="line">import WinState from &apos;electron-win-state&apos;; // 保存窗口位置和大小的调整</span><br><span class="line"></span><br><span class="line">const createWindow = ()=&gt; &#123;</span><br><span class="line">  const winState = new WinState.default(&#123;</span><br><span class="line">    defaultWidth: 1000,</span><br><span class="line">    defaultHeight: 800,</span><br><span class="line">    electronStoreOptions: &#123;</span><br><span class="line">      name: &apos;window-state-main&apos; // 开启多个窗口的时候分别记录</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">  const win = new BrowserWindow(&#123;</span><br><span class="line">    ...winState.winOptions,</span><br><span class="line">    show: false,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  win.loadURL(&apos;http://localhost:5173&apos;);</span><br><span class="line">  win.webContents.openDevTools();</span><br><span class="line">  winState.manage(win);</span><br><span class="line">  win.on(&apos;ready-to-show&apos;, ()=&gt; &#123;</span><br><span class="line">    win.show();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app.whenReady().then(()=&gt; &#123;</span><br><span class="line">  createWindow();</span><br><span class="line"></span><br><span class="line">  app.on(&apos;activate&apos;, () =&gt; &#123;</span><br><span class="line">    if (BrowserWindow.getAllWindows().length === 0) &#123;</span><br><span class="line">      createWindow()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.on(&apos;window-all-closed&apos;, () =&gt; &#123;</span><br><span class="line">  if (process.platform !== &apos;darwin&apos;) &#123;</span><br><span class="line">    app.quit()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>运行<code>npm start</code>,app顺利启动<br>但是在调试工具打印台会看到<code>Electron Security Warning (Insecure Content-Security-Policy)</code>警告，解决办法是在index.html中加入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta http-equiv=&quot;content-security-policy&quot; content=&quot;default-src &apos;self&apos;; script-src &apos;self&apos;; img-src &apos;self&apos; data:; style-src &apos;self&apos; &apos;unsafe-inline&apos;&quot;&gt;</span><br></pre></td></tr></table></figure></p>
<h1 id="添加新功能"><a href="#添加新功能" class="headerlink" title="添加新功能"></a>添加新功能</h1><p>添加路由，状态管理，ui库，css预编译，css初始化，lodash等</p>
<h2 id="安装对应的库"><a href="#安装对应的库" class="headerlink" title="安装对应的库"></a>安装对应的库</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">npm i vue-router --save</span><br><span class="line">npm i stylus --save</span><br><span class="line">npm i pinia --save</span><br><span class="line">npm i normalize.css --save</span><br><span class="line">npm i lodash --save</span><br><span class="line">npm i element-plus --save</span><br></pre></td></tr></table></figure>
<h2 id="改造vue内容"><a href="#改造vue内容" class="headerlink" title="改造vue内容"></a>改造vue内容</h2><h3 id="修改App-vue"><a href="#修改App-vue" class="headerlink" title="修改App.vue"></a>修改App.vue</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h1&gt;electron基础入门&lt;/h1&gt;</span><br><span class="line">    &lt;router-view&gt;&lt;/router-view&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;style lang=&quot;stylus&quot; scoped&gt;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<p>添加路由插槽<code>&lt;router-view&gt;&lt;/router-view&gt;</code></p>
<h3 id="新建views"><a href="#新建views" class="headerlink" title="新建views"></a>新建views</h3><p>在<code>src</code>目录下，新建<code>views</code>文件夹<br>在<code>views</code>下新建<code>Home.vue，Detail.vue</code>文件</p>
<h3 id="新建router"><a href="#新建router" class="headerlink" title="新建router"></a>新建router</h3><p>在<code>src</code>目录下，新建<code>router</code>文件夹<br>在<code>router</code>下新建<code>index.js</code>文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import &#123; createRouter, createWebHashHistory &#125; from &apos;vue-router&apos;;</span><br><span class="line">import Home from &apos;@/views/Home.vue&apos;;</span><br><span class="line">const routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: &apos;/&apos;,</span><br><span class="line">    redirect: &apos;/home&apos;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: &apos;/home&apos;,</span><br><span class="line">    name: &apos;home&apos;,</span><br><span class="line">    component: Home</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: &apos;/detail&apos;,</span><br><span class="line">    name: &apos;detail&apos;,</span><br><span class="line">    component: ()=&gt; import(&apos;@/views/Detail.vue&apos;)</span><br><span class="line">  &#125;</span><br><span class="line">];</span><br><span class="line">const router = createRouter(&#123;</span><br><span class="line">  history: createWebHashHistory(),</span><br><span class="line">  routes</span><br><span class="line">&#125;);</span><br><span class="line">export default router;</span><br></pre></td></tr></table></figure></p>
<h3 id="修改Home-vue"><a href="#修改Home-vue" class="headerlink" title="修改Home.vue"></a>修改Home.vue</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; ref, reactive, onMounted, nextTick &#125; from &apos;vue&apos;;</span><br><span class="line">import useLoadingStore from &apos;../store/loading&apos;;</span><br><span class="line">import List from &apos;./List.vue&apos;;</span><br><span class="line"></span><br><span class="line">const loadingSotate = useLoadingStore();</span><br><span class="line"></span><br><span class="line">const dialogVisible = ref(false);</span><br><span class="line">const list = ref([]);</span><br><span class="line">const refForm = ref(null);</span><br><span class="line">const form = reactive(&#123;</span><br><span class="line">  title: &apos;&apos;,</span><br><span class="line">  city: &apos;&apos;,</span><br><span class="line">  desc: &apos;&apos;,</span><br><span class="line">&#125;);</span><br><span class="line">const rules = &#123;</span><br><span class="line">  title: [</span><br><span class="line">    &#123; required: true, message: &apos;请输入题目&apos;, trigger: &apos;blur&apos; &#125;  </span><br><span class="line">  ],</span><br><span class="line">  city: [</span><br><span class="line">    &#123; required: true, message: &apos;请选择城市&apos;, trigger: &apos;change&apos; &#125;  </span><br><span class="line">  ],</span><br><span class="line">  desc: [</span><br><span class="line">    &#123; required: true, message: &apos;请输入描述&apos;, trigger: &apos;blur&apos; &#125;  </span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line">const onAdd = ()=&gt; &#123;</span><br><span class="line">  dialogVisible.value = true;</span><br><span class="line">  nextTick(()=&gt; &#123;</span><br><span class="line">    refForm.value.resetFields();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line">const sunmitHandle = ()=&gt; &#123;</span><br><span class="line">  refForm.value.validate(async valid=&gt; &#123;</span><br><span class="line">    if(valid) &#123;</span><br><span class="line">      dialogVisible.value = false;</span><br><span class="line">      loadingSotate.set(true);</span><br><span class="line">      // 调用渲染进程提供的方法</span><br><span class="line">      await rendererApi.saveText(JSON.stringify(form));</span><br><span class="line">      loadingSotate.set(false);</span><br><span class="line">      getList();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line">const getList = async ()=&gt; &#123;</span><br><span class="line">  list.value = await rendererApi.getText();</span><br><span class="line">&#125;</span><br><span class="line">// 主进程调用vue侧的函数</span><br><span class="line">rendererApi.showAddDialog(()=&gt; &#123;</span><br><span class="line">  onAdd();</span><br><span class="line">&#125;);</span><br><span class="line">onMounted(async ()=&gt; &#123;</span><br><span class="line">  getList();</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;el-button type=&quot;primary&quot; @click=&quot;onAdd&quot;&gt;+&lt;/el-button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;List :listData=&quot;list&quot;&gt;&lt;/List&gt;</span><br><span class="line">    &lt;el-dialog</span><br><span class="line">      v-model=&quot;dialogVisible&quot;</span><br><span class="line">      title=&quot;添加内容&quot;</span><br><span class="line">      width=&quot;80%&quot;</span><br><span class="line">    &gt;</span><br><span class="line">    &lt;el-form :model=&quot;form&quot; ref=&quot;refForm&quot; :rules=&quot;rules&quot; label-width=&quot;auto&quot; style=&quot;max-width: 600px&quot;&gt;</span><br><span class="line">      &lt;el-form-item label=&quot;题目&quot; prop=&quot;title&quot;&gt;</span><br><span class="line">        &lt;el-input v-model=&quot;form.title&quot; /&gt;</span><br><span class="line">      &lt;/el-form-item&gt;</span><br><span class="line">      &lt;el-form-item label=&quot;城市&quot; prop=&quot;city&quot;&gt;</span><br><span class="line">        &lt;el-select v-model=&quot;form.city&quot; placeholder=&quot;请选择城市&quot;&gt;</span><br><span class="line">          &lt;el-option label=&quot;沈阳&quot; value=&quot;沈阳&quot; /&gt;</span><br><span class="line">          &lt;el-option label=&quot;大连&quot; value=&quot;大连&quot; /&gt;</span><br><span class="line">        &lt;/el-select&gt;</span><br><span class="line">      &lt;/el-form-item&gt;</span><br><span class="line">      &lt;el-form-item label=&quot;描述&quot; prop=&quot;desc&quot;&gt;</span><br><span class="line">        &lt;el-input v-model=&quot;form.desc&quot; type=&quot;textarea&quot; :row=&quot;5&quot; /&gt;</span><br><span class="line">      &lt;/el-form-item&gt;</span><br><span class="line">    &lt;/el-form&gt;</span><br><span class="line">      &lt;template #footer&gt;</span><br><span class="line">        &lt;div class=&quot;dialog-footer&quot;&gt;</span><br><span class="line">          &lt;el-button @click=&quot;dialogVisible = false&quot;&gt;取消&lt;/el-button&gt;</span><br><span class="line">          &lt;el-button type=&quot;primary&quot; @click=&quot;sunmitHandle&quot;&gt;</span><br><span class="line">            确定</span><br><span class="line">          &lt;/el-button&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">    &lt;/el-dialog&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;stylus&quot; scoped&gt;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<h3 id="修改Detail-vue"><a href="#修改Detail-vue" class="headerlink" title="修改Detail.vue"></a>修改Detail.vue</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; useRoute, useRouter &#125; from &apos;vue-router&apos;;</span><br><span class="line"></span><br><span class="line">const route = useRoute();</span><br><span class="line">const router = useRouter();</span><br><span class="line">const query = route.query;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;div class=&quot;go-back&quot;&gt;</span><br><span class="line">      &lt;el-button type=&quot;primary&quot; @click=&quot;router.go(-1)&quot;&gt;返回&lt;/el-button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;h1&gt;&#123;&#123; query.title &#125;&#125;&lt;/h1&gt;</span><br><span class="line">    &lt;div&gt;来自-&#123;&#123; query.city &#125;&#125;&lt;/div&gt;</span><br><span class="line">    &lt;pre&gt;&#123;&#123; query.desc &#125;&#125;&lt;/pre&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;stylus&quot; scoped&gt;</span><br><span class="line">.go-back &#123;</span><br><span class="line">  text-align: right;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<h3 id="添加pinia"><a href="#添加pinia" class="headerlink" title="添加pinia"></a>添加pinia</h3><p>在<code>src</code>下新建<code>store</code>文件夹，新建<code>loading.js</code>文件。<br>此文件内容控制<code>Loading</code>组件显示隐藏<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">import &#123; defineStore &#125; from &apos;pinia&apos;;</span><br><span class="line">const useLoadingStore = defineStore(&apos;websiteStore&apos;, &#123;</span><br><span class="line">	state() &#123;</span><br><span class="line">		return &#123;</span><br><span class="line">			bShow: false</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;,</span><br><span class="line">	actions: &#123;</span><br><span class="line">		set(val) &#123;</span><br><span class="line">			this.bShow = val;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;,</span><br><span class="line">	getters: &#123;</span><br><span class="line">		getBShow() &#123;</span><br><span class="line">      return this.bShow;</span><br><span class="line">    &#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br><span class="line">export default useLoadingStore;</span><br></pre></td></tr></table></figure></p>
<h3 id="添加loading"><a href="#添加loading" class="headerlink" title="添加loading"></a>添加loading</h3><p>在<code>App.vue</code>文件夹下添加<code>Loading</code>组件。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import useLoadingStore from &apos;../store/loading&apos;;</span><br><span class="line"></span><br><span class="line">const loadingSotate = useLoadingStore();</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;loading-wrap&quot; v-if=&quot;loadingSotate.getBShow&quot;&gt;</span><br><span class="line">    &lt;svg class=&quot;circular&quot; viewBox=&quot;0 0 50 50&quot;&gt;&lt;circle class=&quot;path&quot; cx=&quot;25&quot; cy=&quot;25&quot; r=&quot;20&quot; fill=&quot;none&quot;&gt;&lt;/circle&gt;&lt;/svg&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;stylus&quot; scoped&gt;</span><br><span class="line">.loading-wrap &#123;</span><br><span class="line">  position: fixed;</span><br><span class="line">  top: 0;</span><br><span class="line">  left: 0;</span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 100%;</span><br><span class="line">  background-color: rgba(255, 255, 255, .8);</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: center;</span><br><span class="line">  align-items: center;</span><br><span class="line">  .circular &#123;</span><br><span class="line">    stroke: #000000;</span><br><span class="line">    width: 50px;</span><br><span class="line">    height: 50px;</span><br><span class="line">    animation: loading-rotate .5s linear infinite alternate;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">@keyframes loading-rotate &#123;</span><br><span class="line">  0% &#123;</span><br><span class="line">    transform: scale(1);</span><br><span class="line">    opacity: 0</span><br><span class="line">  &#125;</span><br><span class="line">  100% &#123;</span><br><span class="line">    transform: scale(1.2);</span><br><span class="line">    opacity: 1</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure></p>
<p>比如在Home页面控制Loading组件显示隐藏<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">loadingSotate.set(true);</span><br><span class="line">setTimeout(() =&gt; &#123;</span><br><span class="line">  loadingSotate.set(false);</span><br><span class="line">&#125;, 3000);</span><br></pre></td></tr></table></figure></p>
<p>显示后3秒隐藏</p>
<h2 id="改造electron内容"><a href="#改造electron内容" class="headerlink" title="改造electron内容"></a>改造electron内容</h2><p><code>vue</code>侧提交内容后，需要将内容保存到文件里。需要修改<code>electron</code>的主进程和渲染进程</p>
<h3 id="electron主进程"><a href="#electron主进程" class="headerlink" title="electron主进程"></a>electron主进程</h3><h4 id="在main-js里新增"><a href="#在main-js里新增" class="headerlink" title="在main.js里新增"></a>在<code>main.js</code>里新增</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">webPreferences: &#123;</span><br><span class="line">  preload: path.resolve(__dirname, &apos;./preload/index.js&apos;)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p>引入渲染进程文件。</p>
<h4 id="controller"><a href="#controller" class="headerlink" title="controller"></a>controller</h4><p>在根目录下新建<code>controller</code>文件夹，再新建<code>saveText.js</code>文件，用于保存<code>vue</code>侧保存的内容。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import &#123; ipcMain &#125; from &apos;electron&apos;;</span><br><span class="line">import path from &apos;path&apos;;</span><br><span class="line">import fs from &apos;fs&apos;;</span><br><span class="line">import &#123; __dirnameFn &#125; from &apos;../utils.js&apos;;</span><br><span class="line"></span><br><span class="line">ipcMain.handle(&apos;on-save-text-event&apos;, (e, str)=&gt; &#123;</span><br><span class="line">  const data = JSON.parse(str);</span><br><span class="line">  const filePath = path.resolve(__dirnameFn(import.meta.url), &apos;../public/files/&apos;, data.title + &apos;-&apos; + data.city + &apos;.txt&apos;);</span><br><span class="line">  fs.writeFileSync(filePath, data.desc);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p><code>ipcMain.handle</code>用来注册事件，渲染进程可以触发这个事件的回调函数。</p>
<h3 id="electron渲染进程"><a href="#electron渲染进程" class="headerlink" title="electron渲染进程"></a>electron渲染进程</h3><p>在根目录下新建<code>preload</code>文件夹，再新建<code>index.js</code>文件，这里都是渲染进程的功能。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">const &#123; contextBridge, ipcRenderer &#125; = require(&apos;electron&apos;)</span><br><span class="line"></span><br><span class="line">const saveText = async data=&gt; &#123;</span><br><span class="line">  let result = await ipcRenderer.invoke(&apos;on-save-text-event&apos;, data);</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br><span class="line">contextBridge.exposeInMainWorld(&apos;myApi&apos;, &#123;</span><br><span class="line">  saveText,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>渲染进程将<code>saveText</code>这个方法暴露给vue侧，可以<code>window.saveText</code>来调用，调用时，渲染进程会触发主进程注册的对应事件的回调函数完成保存文件的功能。</p>
<blockquote>
<p>通过vue侧-&gt;渲染进程-&gt;主进程,也就是vue侧向主进程发起的通讯，后边还会实现electron主进程向vue侧发起的通讯。</p>
</blockquote>
<h2 id="后续修改略"><a href="#后续修改略" class="headerlink" title="后续修改略"></a>后续修改略</h2><p>之后还会对vue侧，渲染进程，主进程代码修改，这里就不一一列举。思路还是主进程注册事件，渲染进程暴漏给vue侧全局方法调用来触发主进程的事件回调函数。</p>
<h2 id="自定义Menu"><a href="#自定义Menu" class="headerlink" title="自定义Menu"></a>自定义Menu</h2><p>可以自定义<code>Menu</code>，这里为了使用主进程-&gt;渲染进程-&gt;vue侧的通讯，也就是在菜单中点击按钮，调用vue侧的一个方法。<br>这个流程与上面vue侧-&gt;渲染进程-&gt;主进程的调用正好相反。</p>
<h3 id="渲染进程新增事件注册"><a href="#渲染进程新增事件注册" class="headerlink" title="渲染进程新增事件注册"></a>渲染进程新增事件注册</h3><p>在preload的index.js中，新增<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 主进程触发渲染进程</span><br><span class="line">const showAddDialog = cb=&gt; ipcRenderer.on(&apos;on-show-add-dialog-event&apos;, (e, value)=&gt; &#123;</span><br><span class="line">  cb(value);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h3 id="vue侧调用"><a href="#vue侧调用" class="headerlink" title="vue侧调用"></a>vue侧调用</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 主进程调用vue侧的函数</span><br><span class="line">rendererApi.showAddDialog(()=&gt; &#123;</span><br><span class="line">  onAdd();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="新建buildMenu-js"><a href="#新建buildMenu-js" class="headerlink" title="新建buildMenu.js"></a>新建buildMenu.js</h3><p>在<code>controller</code>下新建<code>buildMenu.js</code>。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line">import &#123; app, Menu, ipcMain &#125; from &apos;electron&apos;;</span><br><span class="line">import &#123; inject &#125; from &apos;vue&apos;;</span><br><span class="line"></span><br><span class="line">const isMac = process.platform === &apos;darwin&apos;;</span><br><span class="line"></span><br><span class="line">let mainWindow = null;</span><br><span class="line"></span><br><span class="line">const template = [</span><br><span class="line">  // &#123; role: &apos;appMenu&apos; &#125;</span><br><span class="line">  ...(isMac</span><br><span class="line">    ? [&#123;</span><br><span class="line">        label: app.name,</span><br><span class="line">        submenu: [</span><br><span class="line">          &#123; role: &apos;about&apos; &#125;,</span><br><span class="line">          &#123; type: &apos;separator&apos; &#125;,</span><br><span class="line">          &#123; role: &apos;services&apos; &#125;,</span><br><span class="line">          &#123; type: &apos;separator&apos; &#125;,</span><br><span class="line">          &#123; role: &apos;hide&apos; &#125;,</span><br><span class="line">          &#123; role: &apos;hideOthers&apos; &#125;,</span><br><span class="line">          &#123; role: &apos;unhide&apos; &#125;,</span><br><span class="line">          &#123; type: &apos;separator&apos; &#125;,</span><br><span class="line">          &#123; role: &apos;quit&apos; &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;]</span><br><span class="line">    : []),</span><br><span class="line">  // &#123; role: &apos;fileMenu&apos; &#125;</span><br><span class="line">  &#123;</span><br><span class="line">    label: &apos;File&apos;,</span><br><span class="line">    submenu: [</span><br><span class="line">      isMac ? &#123; role: &apos;close&apos; &#125; : &#123; role: &apos;quit&apos; &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  // &#123; role: &apos;editMenu&apos; &#125;</span><br><span class="line">  &#123;</span><br><span class="line">    label: &apos;Edit&apos;,</span><br><span class="line">    submenu: [</span><br><span class="line">      &#123; role: &apos;undo&apos; &#125;,</span><br><span class="line">      &#123; role: &apos;redo&apos; &#125;,</span><br><span class="line">      &#123; type: &apos;separator&apos; &#125;,</span><br><span class="line">      &#123; role: &apos;cut&apos; &#125;,</span><br><span class="line">      &#123; role: &apos;copy&apos; &#125;,</span><br><span class="line">      &#123; role: &apos;paste&apos; &#125;,</span><br><span class="line">      ...(isMac</span><br><span class="line">        ? [</span><br><span class="line">            &#123; role: &apos;pasteAndMatchStyle&apos; &#125;,</span><br><span class="line">            &#123; role: &apos;delete&apos; &#125;,</span><br><span class="line">            &#123; role: &apos;selectAll&apos; &#125;,</span><br><span class="line">            &#123; type: &apos;separator&apos; &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              label: &apos;Speech&apos;,</span><br><span class="line">              submenu: [</span><br><span class="line">                &#123; role: &apos;startSpeaking&apos; &#125;,</span><br><span class="line">                &#123; role: &apos;stopSpeaking&apos; &#125;</span><br><span class="line">              ]</span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        : [</span><br><span class="line">            &#123; role: &apos;delete&apos; &#125;,</span><br><span class="line">            &#123; type: &apos;separator&apos; &#125;,</span><br><span class="line">            &#123; role: &apos;selectAll&apos; &#125;</span><br><span class="line">          ])</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  // &#123; role: &apos;viewMenu&apos; &#125;</span><br><span class="line">  &#123;</span><br><span class="line">    label: &apos;View&apos;,</span><br><span class="line">    submenu: [</span><br><span class="line">      &#123; role: &apos;reload&apos; &#125;,</span><br><span class="line">      &#123; role: &apos;forceReload&apos; &#125;,</span><br><span class="line">      &#123; role: &apos;toggleDevTools&apos; &#125;,</span><br><span class="line">      &#123; type: &apos;separator&apos; &#125;,</span><br><span class="line">      &#123; role: &apos;resetZoom&apos; &#125;,</span><br><span class="line">      &#123; role: &apos;zoomIn&apos; &#125;,</span><br><span class="line">      &#123; role: &apos;zoomOut&apos; &#125;,</span><br><span class="line">      &#123; type: &apos;separator&apos; &#125;,</span><br><span class="line">      &#123; role: &apos;togglefullscreen&apos; &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  // &#123; role: &apos;windowMenu&apos; &#125;</span><br><span class="line">  &#123;</span><br><span class="line">    label: &apos;Window&apos;,</span><br><span class="line">    submenu: [</span><br><span class="line">      &#123; role: &apos;minimize&apos; &#125;,</span><br><span class="line">      &#123; role: &apos;zoom&apos; &#125;,</span><br><span class="line">      ...(isMac</span><br><span class="line">        ? [</span><br><span class="line">            &#123; type: &apos;separator&apos; &#125;,</span><br><span class="line">            &#123; role: &apos;front&apos; &#125;,</span><br><span class="line">            &#123; type: &apos;separator&apos; &#125;,</span><br><span class="line">            &#123; role: &apos;window&apos; &#125;</span><br><span class="line">          ]</span><br><span class="line">        : [</span><br><span class="line">            &#123; role: &apos;close&apos; &#125;</span><br><span class="line">          ])</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    role: &apos;help&apos;,</span><br><span class="line">    submenu: [</span><br><span class="line">      &#123;</span><br><span class="line">        label: &apos;Learn More&apos;,</span><br><span class="line">        click: async () =&gt; &#123;</span><br><span class="line">          const &#123; shell &#125; = require(&apos;electron&apos;)</span><br><span class="line">          await shell.openExternal(&apos;https://electronjs.org&apos;)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    label: &apos;actions&apos;,</span><br><span class="line">    submenu: [</span><br><span class="line">      &#123;</span><br><span class="line">        label: &apos;添加&apos;,</span><br><span class="line">        click: async ()=&gt; &#123;</span><br><span class="line">          // 触发renderer进程的on-show-add-dialog-event事件</span><br><span class="line">          mainWindow.webContents.send(&apos;on-show-add-dialog-event&apos;);</span><br><span class="line">        &#125;,</span><br><span class="line">        accelerator: &apos;CommandOrControl+Alt+O&apos;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">const menu = Menu.buildFromTemplate(template)</span><br><span class="line">Menu.setApplicationMenu(menu)</span><br><span class="line">export const injectMainWindow = win=&gt; &#123;</span><br><span class="line">  mainWindow = win;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>在<code>vue</code>侧调用渲染进程暴露的函数，把需要执行的<code>vue</code>侧回调函数传进去。</li>
<li>渲染进程函数执行后注册了<code>on-show-add-dialog-event</code>这个渲染进程事件。</li>
<li><code>Menu</code>菜单点击后，主进程触发渲染进程事件，这个事件的回调函数中会执行<code>vue</code>侧提供的回调函数。</li>
</ul>
<p>通过上述步骤即可完成主进程-&gt;渲染进程-&gt;<code>vue</code>侧的通信</p>
<h1 id="托盘-amp-app图标"><a href="#托盘-amp-app图标" class="headerlink" title="托盘&amp;app图标"></a>托盘&amp;app图标</h1><h2 id="mac端"><a href="#mac端" class="headerlink" title="mac端"></a>mac端</h2><p>在<code>controller</code>下新建<code>tray.js</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">// 兼容mac电脑</span><br><span class="line">import &#123; Tray &#125; from &apos;electron&apos;;</span><br><span class="line">import path from &apos;path&apos;;</span><br><span class="line">import &#123; __dirnameFn &#125; from &apos;../utils.js&apos;;</span><br><span class="line"></span><br><span class="line">const createTray = (app, win)=&gt; &#123;</span><br><span class="line">  const tray = new Tray(path.resolve(__dirnameFn(import.meta.url), &apos;../icon.png&apos;));</span><br><span class="line">  tray.setToolTip(&apos;electron-tutorial&apos;);</span><br><span class="line">  tray.on(&apos;click&apos;, e=&gt; &#123;</span><br><span class="line">    if(e.shiftKey) &#123;</span><br><span class="line">      app.quit();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default createTray;</span><br></pre></td></tr></table></figure></p>
<p>在<code>main.js</code>增加<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// tray 兼容mac托盘</span><br><span class="line">import createTray from &apos;./controller/tray.js&apos;;</span><br><span class="line"></span><br><span class="line">createTray(app, win);</span><br></pre></td></tr></table></figure></p>
<h2 id="window端"><a href="#window端" class="headerlink" title="window端"></a>window端</h2><p>在<code>main.js</code>增加<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">icon: nativeImage.createFromPath(path.resolve(__dirnameFn(import.meta.url), &apos;./icon.png&apos;)),</span><br></pre></td></tr></table></figure></p>
<h1 id="全屏"><a href="#全屏" class="headerlink" title="全屏"></a>全屏</h1><p>全屏功能可以应用在一些终端设备中，比如商场或者机场的自助终端。<br>在<code>main.js</code>中增加<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 取消浏览器头部菜单栏</span><br><span class="line">frame: false</span><br><span class="line">// 设置全屏</span><br><span class="line">win.maximize();</span><br></pre></td></tr></table></figure></p>
<h1 id="打包"><a href="#打包" class="headerlink" title="打包"></a>打包</h1><h2 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h2><p><code>electron</code>打包需要打包工具，安装<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm i @electron-forge/cli -D</span><br><span class="line">npm i @electron-forge/maker-squirrel -D</span><br></pre></td></tr></table></figure></p>
<h3 id="window端-1"><a href="#window端-1" class="headerlink" title="window端"></a>window端</h3><p>在根目录下新增<code>forge.config.js</code>文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">export default &#123;</span><br><span class="line">  // ...</span><br><span class="line">  makers: [</span><br><span class="line">    &#123;</span><br><span class="line">      name: &apos;@electron-forge/maker-squirrel&apos;,</span><br><span class="line">      config: &#123;</span><br><span class="line">        certificateFile: &apos;./cert.pfx&apos;,</span><br><span class="line">        certificatePassword: process.env.CERTIFICATE_PASSWORD</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">  // ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>package.json</code>增加<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;make&quot;: &quot;electron-forge make&quot;</span><br></pre></td></tr></table></figure></p>
<p>执行<code>npm run make</code>,（网络不好有时会失败，重试几次），在根目录输出一个<code>out</code>文件夹。在里边找到项目名称的<code>exe</code>文件就是可执行app。</p>
<h2 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h2><p><code>electron</code>打包需要打包工具，安装<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i electron-packager -D</span><br></pre></td></tr></table></figure></p>
<h3 id="window端-2"><a href="#window端-2" class="headerlink" title="window端"></a>window端</h3><p>配置可以直接写在scripts脚本中,<code>package.json</code>增加<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;make2&quot;: &quot;electron-packager . godex-printer --platform=win32 --arch=x64 --icon=build/icon.ico --out=out --overwrite&quot;</span><br></pre></td></tr></table></figure></p>
<p>这个打包方式比第一个要快很多，<code>--icon=build/icon.ico</code>这个参数是生成的exe图标设置</p>
<h2 id="方法三"><a href="#方法三" class="headerlink" title="方法三"></a>方法三</h2><blockquote>
<p>此方法可以打包生成安装文件</p>
</blockquote>
<p><code>electron</code>打包需要打包工具，安装<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i electron-builder -D</span><br></pre></td></tr></table></figure></p>
<p>在项目根目录下创建<code>electron-builder.yml</code>文件，内容如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">nsis:</span><br><span class="line">  oneClick: false # 创建一键安装程序还是辅助安装程序（默认是一键安装）</span><br><span class="line">  allowElevation: true # 是否允许请求提升，如果为false，则用户必须使用提升的权限重新启动安装程序 （仅作用于辅助安装程序）</span><br><span class="line">  allowToChangeInstallationDirectory: true # 是否允许修改安装目录 （仅作用于辅助安装程序）</span><br><span class="line">  createStartMenuShortcut: true # 是否创建开始菜单快捷方式</span><br><span class="line">  artifactName: $&#123;productName&#125;-$&#123;version&#125;-$&#123;platform&#125;-$&#123;arch&#125;.$&#123;ext&#125;</span><br><span class="line">  shortcutName: $&#123;productName&#125;</span><br><span class="line">  uninstallDisplayName: $&#123;productName&#125;</span><br><span class="line">  createDesktopShortcut: always</span><br></pre></td></tr></table></figure></p>
<p>在<code>package.json</code>增加<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">  &quot;makebuilder&quot;: &quot;electron-builder --win --config&quot;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p>
<p>第一次执行打包时需要下载打包工具，根据网络实际情况可能会失败，多尝试几次。<br>打包后在<code>dist</code>目录下的<code>.exe</code>文件就是安装执行文件，双击下一步即可安装。</p>
<h2 id="打包问题"><a href="#打包问题" class="headerlink" title="打包问题"></a>打包问题</h2><p>开发调试时，<code>main.js</code>中，引入<code>vue</code>侧是<code>win.loadURL(&#39;http://localhost:5173&#39;);</code>这样引入的，这样打包的话，执行<code>app</code>应用时还需要启动<code>vue</code>项目才可以使用。<br>如果想直接把<code>vue</code>侧直接打到<code>app</code>应用包中，修改<code>main.js</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// win.loadURL(&apos;http://localhost:5173&apos;);</span><br><span class="line">win.loadFile(path.resolve(__dirnameFn(import.meta.url), &apos;./dist/index.html&apos;));</span><br></pre></td></tr></table></figure></p>
<p>还需要修改<code>dist/index.html</code>中引入的js和css的路径<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- &lt;script type=&quot;module&quot; crossorigin src=&quot;/assets/index-W5Tu2U3a.js&quot;&gt;&lt;/script&gt; --&gt;</span><br><span class="line">&lt;!-- &lt;link rel=&quot;stylesheet&quot; crossorigin href=&quot;/assets/index-CrynHw1J.css&quot;&gt; --&gt;</span><br><span class="line">&lt;script type=&quot;module&quot; crossorigin src=&quot;./assets/index-W5Tu2U3a.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;link rel=&quot;stylesheet&quot; crossorigin href=&quot;./assets/index-CrynHw1J.css&quot;&gt;</span><br></pre></td></tr></table></figure></p>
<p>将绝对路径改成相对路径。</p>
<h2 id="打包后resources文件加密"><a href="#打包后resources文件加密" class="headerlink" title="打包后resources文件加密"></a>打包后resources文件加密</h2><p>在打包之后，输出的可执行exe文件夹下有一个resources文件夹，里边是源代码，因为执行时需要这些源代码文件，不能删除。但是，代码暴露了，为了安全，可以使用<code>asar</code>对源代码封装加密。</p>
<h3 id="安装asar"><a href="#安装asar" class="headerlink" title="安装asar"></a>安装asar</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 全局安装</span><br><span class="line">npm i -g asar</span><br></pre></td></tr></table></figure>
<h3 id="执行asar封装源码"><a href="#执行asar封装源码" class="headerlink" title="执行asar封装源码"></a>执行asar封装源码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">asar pack src src.asar</span><br></pre></td></tr></table></figure>
<p>将src文件夹封装成了src.asar</p>
<h3 id="如何使用"><a href="#如何使用" class="headerlink" title="如何使用"></a>如何使用</h3><p>比如，之前<code>main.js</code>文件需要调用<code>src</code>文件夹里的内容<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import &apos;./src/index.js&apos;;</span><br></pre></td></tr></table></figure></p>
<p>封装之后<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import &apos;./src.asar/index.js&apos;;</span><br></pre></td></tr></table></figure></p>
<p>就这么简单，重新打包之后在resources下可以看到src.asar文件了，asar文件轻易破解不了的，起到了一定的安全性，这时可以把文件夹下src源代码删除，提供给客户使用。</p>
<h1 id="应用更新"><a href="#应用更新" class="headerlink" title="应用更新"></a>应用更新</h1><p>使用<code>electron-updater</code>实现应用更新<br>详情暂略</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>以上完成了一个简单的electron+vue的项目。</p>
<h2 id="代码1"><a href="#代码1" class="headerlink" title="代码1"></a>代码1</h2><p>本教程代码<a href="https://github.com/jinux7/study-collections/tree/master/electron/base-tutorial" target="_blank" rel="noopener">source</a></p>
<h2 id="代码2"><a href="#代码2" class="headerlink" title="代码2"></a>代码2</h2><p>保存网站的app<br>代码<a href="https://github.com/jinux7/study-collections/tree/master/electron/readit" target="_blank" rel="noopener">source</a></p>

        </div>

        
            <div class="article-tags tags">
                
                    <a href="/tags/vue/"><i class="fa fa-tag"></i>&nbsp;&nbsp;vue</a>
                
                    <a href="/tags/electron/"><i class="fa fa-tag"></i>&nbsp;&nbsp;electron</a>
                
            </div>
        

        
            <div class="art-item-footer">
                
                    <span class="art-item-left">
                        <i class="fa fa-chevron-left" aria-hidden="true"></i>&nbsp;
                        <a href="/2024/08/01/TypeScript教程-一/" rel="prev" title="TypeScript教程(一)">
                            TypeScript教程(一)
                        </a>
                    </span>
                
                
                    <span class="art-item-right">
                        <a href="/2024/07/04/pnpm创建monorepo项目/" rel="next" title="pnpm创建monorepo项目">
                            pnpm创建monorepo项目
                        </a>&nbsp;
                        <i class="fa fa-chevron-right" aria-hidden="true"></i>
                    </span>
                
            </div>
        

    </section>

</article>

<br>

<!-- 显示推荐文章和评论 -->


<script>
    window.subData = {
        title: 'electron基础入门',
        tools: true
    }
</script>


      </div>
      <aside class='l_side'>
        
  <section class='m_widget about'>
    
        <img class='avatar waves-image' src='https://avatars2.githubusercontent.com/u/20313228?s=400&u=81b6a332e9a0f8c63e4841766106f3c8f881cfb5&v=4' />
    
</section>


  <section class='m_widget categories'>
<div class='header'><i class="fa fa-sitemap" aria-hidden="true"></i>&nbsp;&nbsp;分类</div>
<div class='content'>
    
    <ul class="entry">
    
        <li><a class="flat-box" href="/categories/css/"><div class='name'>css</div><div class='badge'>11</div></a></li>
    
        <li><a class="flat-box" href="/categories/javascript/"><div class='name'>javascript</div><div class='badge'>190</div></a></li>
    
        <li><a class="flat-box" href="/categories/nodejs/"><div class='name'>nodejs</div><div class='badge'>23</div></a></li>
    
        <li><a class="flat-box" href="/categories/python-rust/"><div class='name'>python&amp;rust</div><div class='badge'>5</div></a></li>
    
        <li><a class="flat-box" href="/categories/服务器/"><div class='name'>服务器</div><div class='badge'>17</div></a></li>
    
        <li><a class="flat-box" href="/categories/计算机原理/"><div class='name'>计算机原理</div><div class='badge'>21</div></a></li>
    
    </ul>
    
</div>
</section>


  
<div class="m_widget tagcloud">
    <div class="header"><i class="fa fa-tags" aria-hidden="true"></i>&nbsp;&nbsp;标签</div>
    <div class='content'>
        <a href="/tags/3D/" style="font-size: 14.77px; color: #949494">3D</a> <a href="/tags/AI/" style="font-size: 18.62px; color: #7a7a7a">AI</a> <a href="/tags/MYSQL笔记/" style="font-size: 20.92px; color: #6a6a6a">MYSQL笔记</a> <a href="/tags/Rust/" style="font-size: 14px; color: #999">Rust</a> <a href="/tags/Tensorflow-js/" style="font-size: 16.31px; color: #898989">Tensorflow.js</a> <a href="/tags/Threejs/" style="font-size: 15.54px; color: #8f8f8f">Threejs</a> <a href="/tags/WEB3/" style="font-size: 15.54px; color: #8f8f8f">WEB3</a> <a href="/tags/ajax/" style="font-size: 17.85px; color: #7f7f7f">ajax</a> <a href="/tags/canvas/" style="font-size: 14.77px; color: #949494">canvas</a> <a href="/tags/cordova/" style="font-size: 14px; color: #999">cordova</a> <a href="/tags/docker/" style="font-size: 14px; color: #999">docker</a> <a href="/tags/electron/" style="font-size: 14px; color: #999">electron</a> <a href="/tags/github/" style="font-size: 17.85px; color: #7f7f7f">github</a> <a href="/tags/hexo/" style="font-size: 14px; color: #999">hexo</a> <a href="/tags/html/" style="font-size: 17.08px; color: #848484">html</a> <a href="/tags/jquery/" style="font-size: 15.54px; color: #8f8f8f">jquery</a> <a href="/tags/linux/" style="font-size: 14.77px; color: #949494">linux</a> <a href="/tags/nodejs/" style="font-size: 15.54px; color: #8f8f8f">nodejs</a> <a href="/tags/npm/" style="font-size: 14px; color: #999">npm</a> <a href="/tags/typescript/" style="font-size: 15.54px; color: #8f8f8f">typescript</a> <a href="/tags/uniapp/" style="font-size: 14px; color: #999">uniapp</a> <a href="/tags/vue/" style="font-size: 21.69px; color: #656565">vue</a> <a href="/tags/webSocket/" style="font-size: 14px; color: #999">webSocket</a> <a href="/tags/webpack/" style="font-size: 17.85px; color: #7f7f7f">webpack</a> <a href="/tags/web图形/" style="font-size: 17.85px; color: #7f7f7f">web图形</a> <a href="/tags/web安全/" style="font-size: 17.85px; color: #7f7f7f">web安全</a> <a href="/tags/web性能/" style="font-size: 19.38px; color: #747474">web性能</a> <a href="/tags/worker/" style="font-size: 14.77px; color: #949494">worker</a> <a href="/tags/兼容性/" style="font-size: 15.54px; color: #8f8f8f">兼容性</a> <a href="/tags/后端/" style="font-size: 17.08px; color: #848484">后端</a> <a href="/tags/后端代理服务/" style="font-size: 14px; color: #999">后端代理服务</a> <a href="/tags/图片处理/" style="font-size: 17.85px; color: #7f7f7f">图片处理</a> <a href="/tags/基础知识/" style="font-size: 24px; color: #555">基础知识</a> <a href="/tags/少儿编程/" style="font-size: 14px; color: #999">少儿编程</a> <a href="/tags/工具库/" style="font-size: 23.23px; color: #5a5a5a">工具库</a> <a href="/tags/微信/" style="font-size: 14.77px; color: #949494">微信</a> <a href="/tags/手写/" style="font-size: 20.15px; color: #6f6f6f">手写</a> <a href="/tags/打印/" style="font-size: 14px; color: #999">打印</a> <a href="/tags/文章收集/" style="font-size: 14px; color: #999">文章收集</a> <a href="/tags/日语/" style="font-size: 17.85px; color: #7f7f7f">日语</a> <a href="/tags/样式/" style="font-size: 17.85px; color: #7f7f7f">样式</a> <a href="/tags/正则/" style="font-size: 14px; color: #999">正则</a> <a href="/tags/浏览器/" style="font-size: 17.85px; color: #7f7f7f">浏览器</a> <a href="/tags/爬虫/" style="font-size: 14px; color: #999">爬虫</a> <a href="/tags/移动端/" style="font-size: 21.69px; color: #656565">移动端</a> <a href="/tags/算法/" style="font-size: 15.54px; color: #8f8f8f">算法</a> <a href="/tags/编译/" style="font-size: 17.08px; color: #848484">编译</a> <a href="/tags/网络基础/" style="font-size: 20.92px; color: #6a6a6a">网络基础</a> <a href="/tags/调试/" style="font-size: 14.77px; color: #949494">调试</a> <a href="/tags/资源导航/" style="font-size: 14.77px; color: #949494">资源导航</a> <a href="/tags/软考/" style="font-size: 14px; color: #999">软考</a> <a href="/tags/面试题/" style="font-size: 22.46px; color: #5f5f5f">面试题</a> <a href="/tags/面试题系列/" style="font-size: 17.85px; color: #7f7f7f">面试题系列</a>
    </div>
</div>




      </aside>
      <script>setLoadingBarProgress(60);</script>
    </div>
  </div>
  <footer id="footer" class="clearfix">
    <div class="social-wrapper">
      
    </div>
    <br>
    <div>博客内容遵循 <a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="licenses">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></div>
    <div>本站使用 <a href="https://github.com/xaoxuu/hexo-theme-material-x" target="_blank" class="codename">Material-X</a> 作为主题，
		总访问量为 <span id="busuanzi_value_site_pv"><i class="fa fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span> 次。
    </div>

</footer>

  <script>setLoadingBarProgress(80);</script>
  <!-- <script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script> -->
<script src="/js/jquery.min.js"></script>
<!-- <script src='//cdn.bootcss.com/node-waves/0.7.5/waves.min.js'></script> -->
<script src="/js/waves.min.js"></script>
<!-- <script src="//cdn.bootcss.com/scrollReveal.js/3.3.2/scrollreveal.min.js"></script> -->
<script src="/js/scrollreveal.min.js"></script>
<!-- 访问统计 -->
<!-- <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script> -->
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<!-- 推荐文章 -->
<!-- <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script> -->
<!-- <script src="//unpkg.com/valine/dist/Valine.min.js"></script> -->
<script src="/js/jquery.fitvids.js"></script>
<script>
var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
var ALGOLIA_API_KEY = "";
var ALGOLIA_APP_ID = "";
var ALGOLIA_INDEX_NAME = "";
var AZURE_SERVICE_NAME = "";
var AZURE_INDEX_NAME = "";
var AZURE_QUERY_KEY = "";
var BAIDU_API_ID = "";
var SEARCH_SERVICE = "hexo";
var ROOT = "/"||"/";
if(!ROOT.endsWith('/'))ROOT += '/';
</script>
<script src="/js/search.js"></script>
<script src="/js/app.js"></script>


    
    
    


  <script>setLoadingBarProgress(100);</script>
</body>
</html>
