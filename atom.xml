<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>jinux</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="/"/>
  <updated>2019-10-08T06:23:13.962Z</updated>
  <id>/</id>
  
  <author>
    <name>jinux</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>SVG动画介绍</title>
    <link href="/2019/09/30/SVG%E5%8A%A8%E7%94%BB%E4%BB%8B%E7%BB%8D/"/>
    <id>/2019/09/30/SVG动画介绍/</id>
    <published>2019-09-30T03:19:26.000Z</published>
    <updated>2019-10-08T06:23:13.962Z</updated>
    
    <content type="html"><![CDATA[<p>SVG动画效果简单入门介绍<br><a id="more"></a></p><h1 id="SVG动画介绍"><a href="#SVG动画介绍" class="headerlink" title="SVG动画介绍"></a>SVG动画介绍</h1><p>本文主要是讲解关于 SVG 的一些高级动画特效，比如 SVG 动画标签，图形渐变，路径动画，线条动画，SVG 裁剪等。<br>例如：路径动画<br><img src="/2019/09/30/SVG动画介绍/1.gif" alt="img"><br>图形渐变：<br><img src="/2019/09/30/SVG动画介绍/2.gif" alt="img"><br>线条动画：<br><img src="/2019/09/30/SVG动画介绍/3.gif" alt="img"><br>以及，相关的动画的矩阵知识，这个也是现在 CSS 动画里面最重要，同时也是最为欠缺的知识点：<br><img src="/2019/09/30/SVG动画介绍/4.png" alt="img"><br>文章会先从基本语法入手，然后，慢慢深入。介绍一些动画基本原理和对应的数学原理知识点。并且文章后面，还附有相关语法的介绍，当你在遇到不熟悉语法的时候可以参考参考。<br><a href="https://jinux7.github.io/2019/09/29/SVG入门教程/" target="_blank" rel="noopener">前面一篇文章</a>，主要介绍了一些 SVG 的基本概念和基本图形。接下来我们需要了解一下，SVG 处理矢量这个特性之外，还有啥内容吸引我们，能让 SVG 现在普及度这么高？</p><h2 id="SVG-Animation"><a href="#SVG-Animation" class="headerlink" title="SVG Animation"></a>SVG Animation</h2><p>在 SVG 中，如果我们想实现一个动画效果，可以使用 CSS，JS，或者直接使用 SVG 中自带的 animate 元素添加动画。<br>使用 CSS 的话，有两种选择一种是通过 style 直接内联在里面，另外是直接使用相关的动画属性– transform。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;use id=<span class="string">"star"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"starStyle"</span> xlink:href=<span class="string">"#starDef"</span></span><br><span class="line">       transform=<span class="string">"translate(100, 100)"</span></span><br><span class="line">       style=<span class="string">"fill: #008000; stroke: #008000"</span>/&gt;</span><br></pre></td></tr></table></figure></p><p>而使用 SVG 中自定的 animate 主要还是 SVG 自己的东西，比较好用。如果想用 CSS 的动画，这都无所谓。<br>先看一个 SVG animate DEMO:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;rect x=<span class="string">"10"</span> y=<span class="string">"10"</span> width=<span class="string">"200"</span> height=<span class="string">"20"</span> stroke=<span class="string">"black"</span> fill=<span class="string">"none"</span>&gt;</span><br><span class="line">  &lt;animate</span><br><span class="line">    attributeName=<span class="string">"width"</span></span><br><span class="line">    attributeType=<span class="string">"XML"</span></span><br><span class="line">    <span class="keyword">from</span>=<span class="string">"200"</span> to=<span class="string">"20"</span></span><br><span class="line">    begin=<span class="string">"0s"</span> dur=<span class="string">"5s"</span></span><br><span class="line">    fill=<span class="string">"freeze"</span> /&gt;</span><br><span class="line">&lt;<span class="regexp">/rect&gt;</span></span><br></pre></td></tr></table></figure></p><p>通过将 animate 标签嵌套在指定的图形里面，即可实现变换的效果。另外，还有 animateTransform，它主要是用来做变形动画的。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;rect x=<span class="string">"-10"</span> y=<span class="string">"-10"</span> width=<span class="string">"20"</span> height=<span class="string">"20"</span></span><br><span class="line">    style=<span class="string">"fill: #ff9; stroke: black;"</span>&gt;</span><br><span class="line">    &lt;animateTransform attributeType=<span class="string">"XML"</span></span><br><span class="line">      attributeName=<span class="string">"transform"</span> type=<span class="string">"scale"</span></span><br><span class="line">      <span class="keyword">from</span>=<span class="string">"1"</span> to=<span class="string">"4 2"</span></span><br><span class="line">      begin=<span class="string">"0s"</span> dur=<span class="string">"4s"</span> fill=<span class="string">"freeze"</span>/&gt;</span><br><span class="line">&lt;<span class="regexp">/rect&gt;</span></span><br></pre></td></tr></table></figure></p><p>简单来说：</p><ul><li>animate: 相当于 CSS 中的 transition</li><li>animateTransform: 相当于 CSS 中的 transform</li></ul><p>里面一些技术细节我们这里就不过多讲解了。这里，主要想介绍一下 animate 中的 morph 的效果。</p><h3 id="animate-morph"><a href="#animate-morph" class="headerlink" title="animate morph"></a>animate morph</h3><p>该效果主要做的就是图形内部的渐变。如图：<br><img src="/2019/09/30/SVG动画介绍/2.gif" alt="img"><br>这种动画是怎么实现呢？<br>直接看代码吧：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">&lt;path fill=<span class="string">"#1EB287"</span>&gt;</span><br><span class="line">    &lt;animate </span><br><span class="line">             attributeName=<span class="string">"d"</span> </span><br><span class="line">             dur=<span class="string">"1440ms"</span> </span><br><span class="line">             repeatCount=<span class="string">"indefinite"</span></span><br><span class="line">             keyTimes=<span class="string">"0;</span></span><br><span class="line"><span class="string">                       .0625;</span></span><br><span class="line"><span class="string">                       .208333333;</span></span><br><span class="line"><span class="string">                       .3125;</span></span><br><span class="line"><span class="string">                       .395833333;</span></span><br><span class="line"><span class="string">                       .645833333;</span></span><br><span class="line"><span class="string">                       .833333333;</span></span><br><span class="line"><span class="string">                       1"</span></span><br><span class="line">             calcMode=<span class="string">"spline"</span> </span><br><span class="line">             keySplines=<span class="string">"0,0,1,1;</span></span><br><span class="line"><span class="string">                         .42,0,.58,1;</span></span><br><span class="line"><span class="string">                         .42,0,1,1;</span></span><br><span class="line"><span class="string">                         0,0,.58,1;</span></span><br><span class="line"><span class="string">                         .42,0,.58,1;</span></span><br><span class="line"><span class="string">                         .42,0,.58,1;</span></span><br><span class="line"><span class="string">                         .42,0,.58,1"</span></span><br><span class="line">             values=<span class="string">"M 0,0 </span></span><br><span class="line"><span class="string">                     C 50,0 50,0 100,0</span></span><br><span class="line"><span class="string">                     100,50 100,50 100,100</span></span><br><span class="line"><span class="string">                     50,100 50,100 0,100</span></span><br><span class="line"><span class="string">                     0,50 0,50 0,0</span></span><br><span class="line"><span class="string">                     Z;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                     M 0,0 </span></span><br><span class="line"><span class="string">                     C 50,0 50,0 100,0</span></span><br><span class="line"><span class="string">                     100,50 100,50 100,100</span></span><br><span class="line"><span class="string">                     50,100 50,100 0,100</span></span><br><span class="line"><span class="string">                     0,50 0,50 0,0</span></span><br><span class="line"><span class="string">                     Z;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                     M 50,0 </span></span><br><span class="line"><span class="string">                     C 75,25 75,25 100,50 </span></span><br><span class="line"><span class="string">                     75,75 75,75 50,100</span></span><br><span class="line"><span class="string">                     25,75 25,75 0,50</span></span><br><span class="line"><span class="string">                     25,25 25,25 50,0</span></span><br><span class="line"><span class="string">                     Z;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                     M 25,50 </span></span><br><span class="line"><span class="string">                     C 37.5,25 37.5,25 50,0 </span></span><br><span class="line"><span class="string">                     75,50 75,50 100,100</span></span><br><span class="line"><span class="string">                     50,100 50,100 0,100</span></span><br><span class="line"><span class="string">                     12.5,75 12.5,75 25,50</span></span><br><span class="line"><span class="string">                     Z;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                     M 25,50 </span></span><br><span class="line"><span class="string">                     C 37.5,25 37.5,25 50,0 </span></span><br><span class="line"><span class="string">                     75,50 75,50 100,100</span></span><br><span class="line"><span class="string">                     50,100 50,100 0,100</span></span><br><span class="line"><span class="string">                     12.5,75 12.5,75 25,50</span></span><br><span class="line"><span class="string">                     Z;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                     M 50,0</span></span><br><span class="line"><span class="string">                     C 77.6,0 100,22.4 100,50 </span></span><br><span class="line"><span class="string">                     100,77.6 77.6,100 50,100</span></span><br><span class="line"><span class="string">                     22.4,100, 0,77.6, 0,50</span></span><br><span class="line"><span class="string">                     0,22.4, 22.4,0, 50,0</span></span><br><span class="line"><span class="string">                     Z;</span></span><br><span class="line"><span class="string">                     </span></span><br><span class="line"><span class="string">                     M 50,0</span></span><br><span class="line"><span class="string">                     C 77.6,0 100,22.4 100,50 </span></span><br><span class="line"><span class="string">                     100,77.6 77.6,100 50,100</span></span><br><span class="line"><span class="string">                     22.4,100, 0,77.6, 0,50</span></span><br><span class="line"><span class="string">                     0,22.4, 22.4,0, 50,0</span></span><br><span class="line"><span class="string">                     Z;</span></span><br><span class="line"><span class="string">                     </span></span><br><span class="line"><span class="string">                     M 100,0 </span></span><br><span class="line"><span class="string">                     C 100,50 100,50 100,100</span></span><br><span class="line"><span class="string">                     50,100 50,100 0,100</span></span><br><span class="line"><span class="string">                     0,50 0,50 0,0</span></span><br><span class="line"><span class="string">                     50,0 50,0 100,0</span></span><br><span class="line"><span class="string">                     Z;"</span>/&gt;</span><br><span class="line">  &lt;<span class="regexp">/path&gt;</span></span><br></pre></td></tr></table></figure></p><ul><li>这么多，是不是感觉有点懵逼。不过，我们细分来看一下其实很简单。里面主要是利用 animate 中的 keyTimes，calcMode，keySplines，以及 values 这几个属性。不急，我们一个一个来解释一下。</li><li>keyTimes: 这其实和 CSS 中定义的 @keyframes 一样。通过 0-1 之间的值，定义每段动画完成的时间。格式为：value;value…。例如 0;.0625;.208333333;.3125;.395833333;.645833333;.833333333;1。从第一个动画，到第二个动画经历的时间比例为 6.25%。并且，keyTimes 需要和 values 里面定义的帧数一致。</li><li>calcMode: 用来定义动画具体的插值模型。取值有: discrete | linear[default] | paced | spline。具体可以参考 MDN。这里我们主要介绍一下 spline。该值表示每个动画间使用自定的贝塞尔变换曲线。如果没有特殊要求，使用 linear 其实已经足够了，这样就不用麻烦去定义下面的 keySplines 属性。</li><li>keySplines：该值用来具体定义动画执行时的 贝塞尔曲线。使用格式是通过 ; 来分隔每一个值。即，cubic-bezier(.31,.57,.93,.46) 为一组。使用 keySplines 表达，则为：keySplines = “.31,.57,.93,.46;”。当然，里面的贝塞尔曲线组数为 整个动画帧数 - 1。</li></ul><p>而 values 就很简单了。它是直接结合 attributeName 属性，来设置具体的值，每个值之间使用 ; 进行分隔。<br>像上面那样，可以在指定元素里面嵌套多个 animate，既实现了形状的改变，又实现了颜色的改变。Morph 比较常用于数字的更迭，比如，<a href="https://codepen.io/felixhornoiu/pen/dovub" target="_blank" rel="noopener">倒数 10s 的相关动画</a>。到这里，Morpah 相关的知识点就结束了。</p><p>接着，让我们来看一下 SVG 中，另外一非常重要的标签 – animateMotion。<br>该标签可以让指定的元素，绕着指定的路径进行运动。所以这对于复杂的路径来说非常有用，因为我们很难使用 transform 去模拟复杂的变换路径。看一个 DEMO<br><img src="/2019/09/30/SVG动画介绍/1.gif" alt="img"></p><h3 id="animateMotion"><a href="#animateMotion" class="headerlink" title="animateMotion"></a>animateMotion</h3><p>animateMotion 大致的属性和 animate 差不多，不过，它还拥有自己特有的属性，比如 keyPoints、rotate、path 等。不过，calcMode 在 AM(animateMotion) 中的默认属性由，linear 变为 paced。<br>这些属性，我们慢慢介绍，先从最简单的开始吧。首先，我们来看一个 DEMO：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;g&gt;</span><br><span class="line">  &lt;rect x=<span class="string">"0"</span> y=<span class="string">"0"</span> width=<span class="string">"30"</span> height=<span class="string">"30"</span> style=<span class="string">"fill: #ccc;"</span>/&gt;</span><br><span class="line">  &lt;circle cx=<span class="string">"30"</span> cy=<span class="string">"30"</span> r=<span class="string">"15"</span> style=<span class="string">"fill: #cfc; stroke: green;"</span>/&gt;</span><br><span class="line">  &lt;animateMotion <span class="keyword">from</span>=<span class="string">"0,0"</span> to=<span class="string">"60,30"</span> dur=<span class="string">"4s"</span> fill=<span class="string">"freeze"</span>/&gt;</span><br><span class="line">&lt;<span class="regexp">/g&gt;</span></span><br></pre></td></tr></table></figure></p><ul><li>from，to：指定两点的位置，位置参数是以元素的坐标为原点的。</li><li>dur：执行渲染时间</li><li>fill：指定动画结束后停留的装填。有 freeze 和 remove 效果。remove 表示回到动画开始的位置，freeze 表示停留在动画结束的位置。</li></ul><p>如果，你想要更复杂的路径，可以直接使用 path 属性来指定路径。用法和 path 标签中 d 属性是一样的。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;rect x=<span class="string">"0"</span> y=<span class="string">"0"</span> width=<span class="string">"30"</span> height=<span class="string">"30"</span> style=<span class="string">"fill: #ccc;"</span>&gt;</span><br><span class="line">    &lt;animateMotion</span><br><span class="line">    path=<span class="string">"M50,125 C 100,25 150,225, 200, 125"</span></span><br><span class="line">    dur=<span class="string">"6s"</span> fill=<span class="string">"freeze"</span>/&gt;</span><br><span class="line">&lt;<span class="regexp">/rect&gt;</span></span><br></pre></td></tr></table></figure></p><p>或者使用 mpath 标签，引用外部的 path。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;path d=<span class="string">"M10,110 A120,120 -45 0,1 110 10 A120,120 -45 0,1 10,110"</span></span><br><span class="line">      stroke=<span class="string">"lightgrey"</span> stroke-width=<span class="string">"2"</span> </span><br><span class="line">      fill=<span class="string">"none"</span> id=<span class="string">"theMotionPath"</span>/&gt;</span><br><span class="line">  &lt;circle cx=<span class="string">"10"</span> cy=<span class="string">"110"</span> r=<span class="string">"3"</span> fill=<span class="string">"lightgrey"</span>  /&gt;</span><br><span class="line">  &lt;circle cx=<span class="string">"110"</span> cy=<span class="string">"10"</span> r=<span class="string">"3"</span> fill=<span class="string">"lightgrey"</span>  /&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- Red circle which will be moved along the motion path. --&gt;</span><br><span class="line">  &lt;circle cx=<span class="string">""</span> cy=<span class="string">""</span> r=<span class="string">"5"</span> fill=<span class="string">"red"</span>&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- Define the motion path animation --&gt;</span><br><span class="line">    &lt;animateMotion dur=<span class="string">"6s"</span> repeatCount=<span class="string">"indefinite"</span>&gt;</span><br><span class="line">      &lt;mpath xlink:href=<span class="string">"#theMotionPath"</span>/&gt;</span><br><span class="line">    &lt;<span class="regexp">/animateMotion&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>circle&gt;</span><br></pre></td></tr></table></figure></p><p>动画效果为：<br><img src="/2019/09/30/SVG动画介绍/6.gif" alt="img"><br>所以，一般而言我们在定义 AM 的路径的时候，只用一种方式定义即可，否则会发生相应的覆盖：mpath&gt;path&gt;values&gt;from/to。<br>在 AM 运动中，还有一个很重要的概念就是旋转角。默认情况下，运动物体的角度是按照它和坐标轴的初始角度确定的。例如：<br><img src="/2019/09/30/SVG动画介绍/7.gif" alt="img"><br>这样看起来确实有些别扭，那能不能让物体垂直于路径进行运动呢？<br>有的，根据 rotate 属性值，一共有 3 个值可供选择。</p><ul><li>auto：让物体垂直于路径的切线方向运动。不过，如果你的路径是闭合曲线的话，需要注意起始点的位置。</li></ul><p>例如：<br><img src="/2019/09/30/SVG动画介绍/8.gif" alt="img"></p><ul><li>auto-reverse：让物体垂直于路径的切线方向并 + 180°。也就是和 auto 运动关于切线对称。<br><img src="/2019/09/30/SVG动画介绍/9.gif" alt="img"></li><li>Number：让物体以固定的旋转角度运动。这个就相当于使用 transform:rotate(deg) 进行控制。</li></ul><h3 id="set"><a href="#set" class="headerlink" title="set"></a>set</h3><p>该标签也是用来模拟 transition 效果的。它和 animate 的主要区别是，它仅仅需要 to 的指定属性，而不需要其他的参考属性，比如 from，by 等。那它有啥特别的存在意义吗？<br>有的，因为 set 针对于所有属性，甚至包括 style 里面的相关 CSS 属性。所以，可以靠它来很好描述一些非 number 的属性值。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;text text-anchor=<span class="string">"middle"</span> x=<span class="string">"60"</span> y=<span class="string">"60"</span> style=<span class="string">"visibility: hidden;"</span>&gt;</span><br><span class="line">  &lt;set attributeName=<span class="string">"visibility"</span> attributeType=<span class="string">"CSS"</span></span><br><span class="line">    to=<span class="string">"visible"</span> begin=<span class="string">"4.5s"</span> dur=<span class="string">"1s"</span> fill=<span class="string">"freeze"</span>/&gt;</span><br><span class="line">  All gone!</span><br><span class="line">&lt;<span class="regexp">/text&gt;</span></span><br></pre></td></tr></table></figure></p><h2 id="矩阵动画"><a href="#矩阵动画" class="headerlink" title="矩阵动画"></a>矩阵动画</h2><p>上面差不多简单阐述了关于 SVG 一些比较有特点的动画。当然，还有比较重要的线条动画，这个我们放到后面进行讲解。这里先来看一下所有动画中，非常重要的矩阵原理。线性代数应该是大学里面来说，最容易学的一门科目，MD。。。还记得，大学线代期末考试的时候，100 分的同学应该说是如韭菜地般，一抓一大片（对不起，我没能和他们同流合污。）<br>那矩阵是如何在动画中使用的呢？<br>简单的说，矩阵中的每个元素其实可以等价代换为每个因式里面的系数：<br><img src="/2019/09/30/SVG动画介绍/27.png" alt="img"><br>上面也叫作 三维矩阵。即，它涉及到 x,y,z 轴的计算。那对于我们平面 2D 变换来说，那么此时矩阵又是哪种形式呢？<br>很简单，只要将 z 轴永远置为一个常数就 OK。这里，惯例上是直接取 0 0 1 来设置。<br><img src="/2019/09/30/SVG动画介绍/10.png" alt="img"><br>不信的话，大家只要代进去乘以乘，应该就可以得到结果了。所以，在二维中，具体变换方式为：<br><img src="/2019/09/30/SVG动画介绍/4.png" alt="img"><br>后面，我们也会依据这个公式进行相关的变形操作。那矩阵变换是怎么运用到 CSS/SVG 当中呢？<br>在 CSS 中，是直接使用 transform 中的属性：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">transform: matrix(a,b,c,d,e,f);</span><br></pre></td></tr></table></figure></p><p>当然，在 SVG 中也是一样的：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;g transform=<span class="string">"matrix(1,2,3,4,5,6)"</span>&gt;</span><br><span class="line">    &lt;line x1=<span class="string">"10"</span> y1=<span class="string">"20"</span> x2=<span class="string">"30"</span> y2=<span class="string">"40"</span> style=<span class="string">"stroke-width: 10px; stroke: blue;"</span>/&gt;</span><br><span class="line">  &lt;<span class="regexp">/g&gt;</span></span><br></pre></td></tr></table></figure></p><p>所以，我们主要的重点就是讲解一下 matrix 这个属性。它的格式为：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">matrix(a,b,c,d,e,f);</span><br></pre></td></tr></table></figure></p><p>对应于我们上面的公式有：<br><img src="/2019/09/30/SVG动画介绍/10.png" alt="img"><br>在接触 transform 的时候，大家应该了解到 transform 里面有很多固定的动画属性：</p><ul><li>translate()</li><li>rotate()</li><li>scale()</li><li>skew()<br>实际上，在底层还是使用 matrix 实现的变换。就拿 translate 举个例子吧。<br>translate 的格式为：<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">translate(dx,dy)</span><br></pre></td></tr></table></figure></li></ul><p>相当于参考当前原点，在 x/y 轴上移动 dx/dy 的距离。那么映射到矩阵，应该如何表示呢？<br>很简单，它等同于：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">matrix(<span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> dx dy);</span><br></pre></td></tr></table></figure></p><p>使用代数证明一下：<br>假设有 matrix(1 0 0 1 20 30)<br>变为矩阵为：<br><img src="/2019/09/30/SVG动画介绍/11.png" alt="img"><br>根据，上面的表达式有：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">X = x<span class="string">'*1 + y'</span>*<span class="number">0</span> + <span class="number">20</span> = x<span class="string">' + 20</span></span><br><span class="line"><span class="string">Y = x'</span>*<span class="number">0</span> + y<span class="string">'*1 + 30 = y'</span> + <span class="number">30</span></span><br></pre></td></tr></table></figure></p><p>所以，就是 X 在原有 X 轴坐标上向右移动 20 的距离，Y 相对于原有移动 30 的距离。<br>那么其他几个属性呢？也是怎么变化的吗？<br>恩，类似。只是里面取值不一样：</p><ul><li>scale(x,y): 放大 X/Y 轴，矩阵的表达为 matrix(x 0 0 y 0 0)。</li><li>rotate(θ): 坐标旋转，矩阵的表达为 matrix(cosθ sinθ -sinθ cosθ 0 0)。</li><li>skew(θx,θy): X/Y 轴拉伸，矩阵的表达为 matrix(1 tanθx tanθy 1 0 0)。</li></ul><p>注意，上面三个都会改变原有物体的坐标系！！！ 这点很重要，换句话说，后面每次变换都是基于前面一个的变换结果的。<br>详情看图：<br><img src="/2019/09/30/SVG动画介绍/12.png" alt="img"><br>详情可以参考：<a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/transform" target="_blank" rel="noopener">MDN matrix</a><br>不过，这并不是我们使用 matrix 的重点，也不是它的优势。它的优势在于可计算，即，能够将复杂的动画集合到一个表达式中，并且，后续的变换可以直接基于当前的 matrix。<br>我们先来了解一下，如果多个变换动画一起使用，matrix 应该如何表达呢？<br><strong>只需要找到我们变换动画对应的矩阵，然后相乘即可。</strong>例如，先旋转 45°，然后放大 1.5 倍，则有变换动画为：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">transform: rotate(<span class="number">45</span>deg) scale(<span class="number">1.5</span>,<span class="number">1.5</span>);</span><br></pre></td></tr></table></figure></p><p>注意，虽然，你定义动画是分开的，但此时的动画是同时进行的。为啥？因为，这两个动画实际上可以整合成为一个变换矩阵：<br><img src="/2019/09/30/SVG动画介绍/13.png" alt="img"><br>并且，位置是不可以调换的。比如，transform: scale(2,2) translate(20px,30px)。即，你先放大两倍，然后移动 20,30 的距离。注意，这里移动的 20,30 相对的是已经放大过后的坐标，相对于原坐标而言就是 40,60 了。 如果，你调换位置，即 transform: translate(20px,30px) scale(2,2)。就变成现在原坐标移动 20,30，然后再放大两倍。<br>而上面强调的顺序关系，实际上就可以理解为矩阵不满足交换律的原则。因为一旦交换，结果很可能不一样。</p><h3 id="矩阵高级用法"><a href="#矩阵高级用法" class="headerlink" title="矩阵高级用法"></a>矩阵高级用法</h3><p>上面的内容只是简单的描述了关于矩阵的概念。在实际中，矩阵可以说是真正利器。<br>假设现在有一个动画，要求你将一个物体从一个点通过抛物线的方式移动到另外一个点，那么此时要求 JS/CSS 随你挑。此时，你会不会感觉，呼吸急促，头脑发热呢？<br>恩，matrix 可以治，而且包治百病。不过，matrix 有一个限制点，它只能用于一次线性动画表达式。即，针对于抛物线，椭圆曲线这类复杂曲线来说，不太合适。那么有什么办法吗？<br>有的，微分思想。每一段动画其实都可以通过一定范围内的直线拼接而成，那么这样，我们就可以将一段抛物线拆分为由几段线段构成的曲线。当然，如果你分的越细，拟合度就越高。这里我们不打算过度你和，我们简单的将一段抛物线分为 5段。<br>如图：<br><img src="/2019/09/30/SVG动画介绍/14.png" alt="img"><br>那么接下来就是抠细节。这里，依次取倾角为 45°，30°，0°，-45°，-30° 这 5 段直线。每段分配的时间比例为 20%、25%、10%、25%、20% 这主要是用于 keyframe 的设定。现在，用数学来分析一下，这个动画到底该怎么弄。<br>现在，已知两点之间的距离为 100px。那么我们同样根据上述比例分，则有 20px, 25px, 10px, 25px, 20px。<br>这里我们以 45° 倾角为参考点，则终点坐标为 (20,20); 。那么，该段的矩阵为：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 注意 Y 轴需要取负值！</span></span><br><span class="line"></span><br><span class="line"> <span class="number">1</span> <span class="number">0</span> <span class="number">20</span></span><br><span class="line"> <span class="number">0</span> <span class="number">1</span> <span class="number">-20</span></span><br><span class="line"> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span></span><br></pre></td></tr></table></figure></p><p>CSS 中的变形动画为：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">transform: matrix(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">20</span>,<span class="number">-20</span>);</span><br></pre></td></tr></table></figure></p><p>然后，第二段就为：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="number">0</span> <span class="number">25</span></span><br><span class="line"><span class="number">0</span> <span class="number">1</span> <span class="number">-14.4</span></span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">1</span></span><br></pre></td></tr></table></figure></p><p>使用矩阵的乘法法，则有：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="number">0</span> <span class="number">45</span></span><br><span class="line"> <span class="number">0</span> <span class="number">1</span> <span class="number">-34.4</span></span><br><span class="line"> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span></span><br></pre></td></tr></table></figure></p><p> 变形动画为：<br> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">transform: matrix(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">45</span>,<span class="number">-34.4</span>);</span><br></pre></td></tr></table></figure></p><p>剩余几段也是这样的做法。最终，整个 keyframe 就应该表示为：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@keyframe Parabola&#123;</span><br><span class="line">    <span class="number">20</span>%&#123;</span><br><span class="line">        transform: matrix(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">20</span>,<span class="number">-20</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">45</span>%&#123;</span><br><span class="line">        transform: matrix(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">45</span>,<span class="number">-34.4</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>整个动画过程差不多都是这样。当然，矩阵也不仅仅局限于这几个动画，凭借着高度定制化和灵活性的特点，这它还常常用于进行回弹，弹跳等动画中。如果大家有兴趣，后期也可以对这类动画进行简单的讲解。<br>后面，我们最后来了解一下 SVG 中很重要的线条动画。</p><h2 id="线条动画"><a href="#线条动画" class="headerlink" title="线条动画"></a>线条动画</h2><p>SVG 中的线条动画常常用作过渡屏（splash screen）中。例如：</p><p><img src="/2019/09/30/SVG动画介绍/15.gif" alt="img"></p><p>或者，一些比较炫酷的 LOGO 中，比如 AllowTeam 的：</p><p><img src="/2019/09/30/SVG动画介绍/16.gif" alt="img"><br>看到这些炫酷的效果，大家有没有动心想学一学，看看自己到底能否做的这么好呢？<br>OK，我们现在来正式介绍一下线条动画。在 SVG 中，最长用到的线条标签就是 Path。这里我前面一篇文章已经做了介绍，我这里就不赘述了。<br>而在具体变化当中用到的是关于 stroke 的相关属性：（下面的属性都可以直接用在 CSS 当中！）</p><ul><li>stroke：定义笔触的颜色。例如：stroke=”green”</li><li>stroke-dasharray：定义 dash 和 gap 的长度。它主要是通过使用 , 来分隔 实线 和 间隔 的值。例如：stroke-dasharray=”5, 5” 表示，按照 实线为 5，间隔为 5 的排布重复下去。如下图：<br><img src="/2019/09/30/SVG动画介绍/28.png" alt="img"><br>放大看有：<br><img src="/2019/09/30/SVG动画介绍/17.png" alt="img"><br>另外，stroke-dasharray 并不局限于只能设置两个值，要知道，它本身的含义是设置最小重复单元，即，dash,gap,dash,gap…。比如，我定义 stroke-dasharray=”15, 10, 5” 则相当于，[15,10,5] 为一段。则有：<br><img src="/2019/09/30/SVG动画介绍/18.png" alt="img"><br>放大看则有：<br><img src="/2019/09/30/SVG动画介绍/19.png" alt="img"></li><li>stroke-dashoffset: 用来设置 dasharray 定义其实 dash 线条开始的位置。值可以为 number || percentage。百分数是相对于 SVG 的 viewport。通常结合 dasharray 可以实现线条的运动。</li><li>stroke-linecap: 线条的端点样式。</li><li>stroke-linejoin: 线条连接的样式</li><li>stroke-miterlimit: 一个比较复杂的概念，如果我们只是画一些一般的线段，使用上面 linejoin 即可。如果涉及对边角要求比较高的，则可以使用该属性进行定义。它的值，其实就是角长度比上线宽：<br><img src="/2019/09/30/SVG动画介绍/20.png" alt="img"><br>而实际理解的话，就是假设当 width 为 1。此时比例为 2。那么 miter = 2。那么超过 2 的 miter 部分则会被 cut 掉。可以参照：<br><img src="/2019/09/30/SVG动画介绍/21.png" alt="img"><br>他主要是配合 linejoin 一起使用。因为 linejoin 默认取值就是 miter。所以，默认情况下就可以使用该标签属性。它默认值为 4。其余的大家下去实践一下即可。详细可以参考: <a href="https://www.oxxostudio.tw/articles/201409/svg-16-storke-miterlimit.html" target="_blank" rel="noopener">miter</a></li><li>stroke-opacity：线段的透明度</li><li>stroke-width：线的粗细。</li></ul><p>OK，介绍完关于 path 的所有 stroke 属性之后，我们就要开始动手写一下让线条动起来的代码。简单来说，就是通过 stroke-dashoffset 和 stroke-dasharray 来做。整个动画可以分为两个过程：</p><ul><li>通过 dasharray 将实线部分隐藏，空余为全线段长。然后，将实线部分增加至全长。比如：dasharray: 0,1000 变为 dasharray: 1000,1000。</li><li>同时，通过 dashoffset 来移动新增的实线部分，造成线段移动的效果。有: dashoffset:0，变为 dashoffset:1000。</li></ul><p>不过，这里我们不打算使用 Path 来做啥复杂的动画，这主要考虑到手头没有一些 SVG 生成工具。所以，这里我们就以 Text 来做吧（因为做起来真的简单）。<br>这里，先以 IV-WEB 这段文字来做动画。<br>先给大家看一下最终结果：<br><img src="/2019/09/30/SVG动画介绍/3.gif" alt="img"><br>那么这种动画是怎么做的呢？<br>这里，我主要介绍一下关于 CSS 相关，SVG 就一个 Text 我直接贴代码了：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg viewBox=<span class="string">"0 0 1320 300"</span>&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- <span class="built_in">Symbol</span> --&gt;</span><br><span class="line">  &lt;symbol id=<span class="string">"s-text"</span>&gt;</span><br><span class="line">    &lt;text text-anchor=<span class="string">"middle"</span></span><br><span class="line">          x=<span class="string">"50%"</span> y=<span class="string">"50%"</span> dy=<span class="string">".35em"</span>&gt;</span><br><span class="line">      IV-WEB</span><br><span class="line">    &lt;<span class="regexp">/text&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>symbol&gt;  </span><br><span class="line"></span><br><span class="line">  &lt;!-- Duplicate symbols --&gt;</span><br><span class="line">  &lt;use xlink:href=<span class="string">"#s-text"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"text"</span></span><br><span class="line">       &gt;&lt;/use&gt;</span><br><span class="line">  &lt;use xlink:href=<span class="string">"#s-text"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"text"</span></span><br><span class="line">       &gt;&lt;/use&gt;</span><br><span class="line">  &lt;use xlink:href=<span class="string">"#s-text"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"text"</span></span><br><span class="line">       &gt;&lt;/use&gt;</span><br><span class="line">&lt;<span class="regexp">/svg&gt;</span></span><br></pre></td></tr></table></figure></p><p>上面是通过创建一个居中定位的字体，然后使用 3 个 text 重叠。具体 CSS 我们下面来说一下。首先，我们营造的效果是从无到有，就需要使用 dasharray 将 gap 设置的足够大。这里我取 300 即可。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stroke-dasharray: <span class="number">0</span> <span class="number">300</span>;</span><br></pre></td></tr></table></figure></p><p>然后，通过 nth-child 选择器，给每一个文字使用不同的颜色值：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">.text:nth-child(<span class="number">3</span>n + <span class="number">1</span>) &#123;</span><br><span class="line">  stroke: #F60A0A;</span><br><span class="line">&#125;</span><br><span class="line">.text:nth-child(<span class="number">3</span>n + <span class="number">2</span>) &#123;</span><br><span class="line">  stroke: #F2FF14;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.text:nth-child(<span class="number">3</span>n + <span class="number">3</span>) &#123;</span><br><span class="line">  stroke: #FB9505;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>下面才是重点内容。此时，这 3 个 text 的起始点重合。我现在既要他们在运行时不完全重合，又要他们的线条能进行滚动。不啰嗦了，直接看代码吧：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">@keyframes stroke &#123;</span><br><span class="line">  <span class="number">100</span>% &#123;</span><br><span class="line">    stroke-dashoffset: <span class="number">1000</span>;</span><br><span class="line">    stroke-dasharray: <span class="number">80</span> <span class="number">160</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@keyframes stroke1 &#123;</span><br><span class="line">  <span class="number">100</span>% &#123;</span><br><span class="line">    stroke-dashoffset: <span class="number">1080</span>;</span><br><span class="line">    stroke-dasharray: <span class="number">80</span> <span class="number">160</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@keyframes stroke2 &#123;</span><br><span class="line">  <span class="number">100</span>% &#123;</span><br><span class="line">    stroke-dashoffset: <span class="number">1160</span>;</span><br><span class="line">    stroke-dasharray: <span class="number">80</span> <span class="number">160</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>这就是上面 3 个不同的 text 运用的动画。dashoffet 由 0 到 1000。这完成了滚动的目的。同时，为了让字体不重合，我还需要在对应字体的 dashoffset 上，加上不同的间隔距离。比如，第一个字体 offset 为 1000。那么第二个字体，我需要加上前一个字体 dash 的长度，即，80。所以，第二个字体就变为 1080。那么第三个就是加上前两个的 dash 长度，即 1160。<br>大致过程就是这样，详情可以查看： <a href="https://codepen.io/JimmyVV/pen/oWWzdB" target="_blank" rel="noopener">IVWEB 线条动画</a>。</p><h2 id="SVG-中使用-transition"><a href="#SVG-中使用-transition" class="headerlink" title="SVG 中使用 transition"></a>SVG 中使用 transition</h2><p>在 SVG 中，本来就存在相关的动画 Tag，不过里面用起来比较复杂，最常用的还是直接利用 CSS 里面相关的属性标签来做。其中，transition 是最常用的。比如，想做一下颜色的渐变等等。这里可以直接利用 transition 修饰指定的 SVG 属性即可。<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># fill 是 SVG 中，专有属性</span><br><span class="line">path &#123; <span class="attr">transition</span>: fill <span class="number">.4</span>s ease; &#125;</span><br><span class="line">#europe       path &#123; fill: red; &#125;</span><br><span class="line">#europe:hover path &#123; fill: white; &#125;</span><br></pre></td></tr></table></figure></p><h2 id="SVG-文字"><a href="#SVG-文字" class="headerlink" title="SVG 文字"></a>SVG 文字</h2><p>在 SVG 中定义文字直接使用 text 标签即可。关于文字来说，一般而言需要注意的点就那么即可，文字的排列，间距等等。这些都可以直接使用 CSS 进行控制。不过，有几个属性比较特殊，这里需要额外提一下。</p><h3 id="text-anchor"><a href="#text-anchor" class="headerlink" title="text-anchor"></a>text-anchor</h3><p>用来定义参考点和实际字符之间的定位关系。格式为：</p><ul><li>text-anchor: start | middle | end | inherit<br>直接看代码解释吧：<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- Anchors <span class="keyword">in</span> action --&gt;</span><br><span class="line">    &lt;text text-anchor=<span class="string">"start"</span></span><br><span class="line">          x=<span class="string">"60"</span> y=<span class="string">"40"</span>&gt;A&lt;<span class="regexp">/text&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    &lt;text text-anchor="middle"</span></span><br><span class="line"><span class="regexp">          x="60" y="75"&gt;A&lt;/</span>text&gt;</span><br><span class="line"></span><br><span class="line">    &lt;text text-anchor=<span class="string">"end"</span></span><br><span class="line">          x=<span class="string">"60"</span> y=<span class="string">"110"</span>&gt;A&lt;<span class="regexp">/text&gt;</span></span><br></pre></td></tr></table></figure></li></ul><p>第一个 A，参考的是 (60,40) 的点，定义为 start ，那么参考点应该在字符的前面。<br><img src="/2019/09/30/SVG动画介绍/22.png" alt="img"><br>而剩下两个也是同样的道理：<br><img src="/2019/09/30/SVG动画介绍/23.png" alt="img"></p><h3 id="tspan"><a href="#tspan" class="headerlink" title="tspan"></a>tspan</h3><p>现在，假如我们想在 text 里面添加一些特殊的字符效果，比如斜体，加粗等。由于，text 标签不能实现嵌套，所以，为了解决这个痛点，提出了 tspan 的标签。它其实就是一个可以嵌套的 text 标签。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;text x=<span class="string">"10"</span> y=<span class="string">"30"</span> style=<span class="string">"font-size:12pt;"</span>&gt;</span><br><span class="line">  Switch among</span><br><span class="line">  &lt;tspan style=<span class="string">"font-style:italic"</span>&gt;italic&lt;<span class="regexp">/tspan&gt;, normal,</span></span><br><span class="line"><span class="regexp">  and &lt;tspan style="font-weight:bold"&gt;bold&lt;/</span>tspan&gt; text.</span><br><span class="line">&lt;<span class="regexp">/text&gt;</span></span><br></pre></td></tr></table></figure></p><p>tspan 里面同样可以自定义相关的自身属性。详细的可以参考 <a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Element/tspan" target="_blank" rel="noopener">tspan</a> 我这里就不详述了。</p><h3 id="在-Path-展示-text"><a href="#在-Path-展示-text" class="headerlink" title="在 Path 展示 text"></a>在 Path 展示 text</h3><p>Text 一般可以横放，竖放。那有没有啥办法让文字可以按照一定的路径任意排放呢？<br>有的，这里可以使用 textPath 标签，来定义具体参考路径。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;path id=<span class="string">"sharp-corner"</span></span><br><span class="line">    d=<span class="string">"M 30 110 100 110 100 160"</span></span><br><span class="line">    style=<span class="string">"stroke: gray; fill: none;"</span>/&gt;</span><br><span class="line"></span><br><span class="line">&lt;text&gt;</span><br><span class="line">    &lt;textPath xlink:href=<span class="string">"#sharp-corner"</span>&gt;</span><br><span class="line">    Making a quick turn</span><br><span class="line">    &lt;<span class="regexp">/textPath&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>text&gt;</span><br></pre></td></tr></table></figure></p><p>如图：<br><img src="/2019/09/30/SVG动画介绍/24.png" alt="img"></p><h2 id="Clip"><a href="#Clip" class="headerlink" title="Clip"></a>Clip</h2><p>在 DOM 中如果想展示一个图片的部分，或者以某种形状展示图片的部分，一般是通过一个 cover div 来实现的。不过，如果涉及到不规则图形的话，那么 DOM 就有天生缺陷了（当然使用 CSS 里的 clip-path 可以完成，不过兼容性不太好）。而在 SVG 中，提供了 clipPath 标签，能够让我们自定义裁剪图片的范围和形状。<br>clipPath 里面可以接任何图形，比如，path,rect 甚至是 text。使用的时候，直接在 style 中，指定 clip-path 即可，或者直接使用 clip-path 属性指定。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;defs&gt;</span><br><span class="line">  &lt;clipPath id=<span class="string">"textClip"</span>&gt;</span><br><span class="line">    &lt;text id=<span class="string">"text1"</span> x=<span class="string">"20"</span> y=<span class="string">"20"</span> transform=<span class="string">"rotate(60)"</span></span><br><span class="line">      style=<span class="string">"font-family: 'Liberation Sans';</span></span><br><span class="line"><span class="string">        font-size: 48pt; stroke: black; fill: none;"</span>&gt;</span><br><span class="line">CLIP</span><br><span class="line">    &lt;<span class="regexp">/text&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>clipPath&gt;</span><br><span class="line"> &lt;<span class="regexp">/defs&gt;</span></span><br><span class="line"><span class="regexp"> </span></span><br><span class="line"><span class="regexp"> &lt;use transform="translate(100, 0)"</span></span><br><span class="line"><span class="regexp">  xlink:href="#shapes" style="clip-path: url(#textClip);"/</span>&gt;</span><br><span class="line">  </span><br><span class="line">   &lt;use transform=<span class="string">"translate(100, 0)"</span></span><br><span class="line">  xlink:href=<span class="string">"#shapes"</span> clip-path=<span class="string">"url(#textClip);"</span>/&gt;</span><br></pre></td></tr></table></figure></p><p><img src="/2019/09/30/SVG动画介绍/25.png" alt="img"><br>或者说，如果我们想画一个圆的裁剪区域的话：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;defs&gt;</span><br><span class="line">     &lt;clipPath id=<span class="string">"circularPath"</span> clipPathUnits=<span class="string">"objectBoundingBox"</span>&gt;</span><br><span class="line">     &lt;circle cx=<span class="string">"0.5"</span> cy=<span class="string">"0.5"</span> r=<span class="string">"0.5"</span>/&gt;</span><br><span class="line">    &lt;<span class="regexp">/clipPath&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>defs&gt;</span><br><span class="line"></span><br><span class="line">&lt;use xlink:href=<span class="string">"#shapes"</span> style=<span class="string">"clip-path: url(#circularPath);"</span> /&gt;</span><br></pre></td></tr></table></figure></p><h2 id="Appendix-参考标签"><a href="#Appendix-参考标签" class="headerlink" title="Appendix 参考标签"></a>Appendix 参考标签</h2><h3 id="g"><a href="#g" class="headerlink" title="g"></a>g</h3><p>分组标签应该毫无意外排第一，因为其实作为绘制图形中最常和最基本的标签。前面一篇文章也主要介绍过了，这里做点补充。<br>每一个分组标签都带有 id 属性，唯一标识该分组，为什么呢？<br>因为，后面我们可以使用该 id 标签添加动画，重用该分组等。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;g id=<span class="string">"demo"</span> stroke=<span class="string">"green"</span> fill=<span class="string">"white"</span> stroke-width=<span class="string">"5"</span>&gt;</span><br><span class="line">   &lt;circle cx=<span class="string">"25"</span> cy=<span class="string">"25"</span> r=<span class="string">"15"</span>/&gt;</span><br><span class="line">   &lt;circle cx=<span class="string">"40"</span> cy=<span class="string">"25"</span> r=<span class="string">"15"</span>/&gt;</span><br><span class="line">   &lt;circle cx=<span class="string">"55"</span> cy=<span class="string">"25"</span> r=<span class="string">"15"</span>/&gt;</span><br><span class="line">   &lt;circle cx=<span class="string">"70"</span> cy=<span class="string">"25"</span> r=<span class="string">"15"</span>/&gt;</span><br><span class="line">&lt;<span class="regexp">/g&gt;</span></span><br></pre></td></tr></table></figure></p><p>每个分组里面可以含有一些描述标签，比如 desc。 这些描述内容是不会被渲染的。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;g id=<span class="string">"demo"</span> stroke=<span class="string">"green"</span> fill=<span class="string">"white"</span> stroke-width=<span class="string">"5"</span>&gt;</span><br><span class="line">  &lt;desc&gt;Just Demo&lt;<span class="regexp">/desc&gt;</span></span><br><span class="line"><span class="regexp">  &lt;circle cx="25" cy="25" r="15"/</span>&gt;</span><br><span class="line">&lt;<span class="regexp">/g&gt;</span></span><br></pre></td></tr></table></figure></p><h3 id="use"><a href="#use" class="headerlink" title="use"></a>use</h3><p>该标签就是结合 g 标签一起使用，作用是可以复用 g 分组的样式。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;g id=<span class="string">"Port"</span>&gt;</span><br><span class="line">      &lt;circle style=<span class="string">"fill: inherit;"</span> r=<span class="string">"10"</span>/&gt;</span><br><span class="line">&lt;<span class="regexp">/g&gt;</span></span><br><span class="line"><span class="regexp">&lt;use x="50" y="30" xlink:href="#Port" class="classA"/</span>&gt;</span><br></pre></td></tr></table></figure></p><p>里面使用 xlink:href 加上指定 group 的 id，然后通过 x，y 属性指定副本放置的位置。不过，有一个限制，use 标签的 style 属性，并不能覆盖点原始的 group style 样式。而且，有时候，我们只是想使用一些模板，即，图形并未被解析，只有代码存在。这时候，就需要使用 defs 来包裹了。</p><h3 id="defs"><a href="#defs" class="headerlink" title="defs"></a>defs</h3><p>用来保存一些代码，使其不会被浏览器解析。并且里面的分组可以被 use 属性的 style 样式所覆盖。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> &lt;defs&gt;</span><br><span class="line">   &lt;g id=<span class="string">"Port"</span>&gt;</span><br><span class="line">     &lt;circle style=<span class="string">"fill: inherit;"</span> r=<span class="string">"10"</span>/&gt;</span><br><span class="line">   &lt;<span class="regexp">/g&gt;</span></span><br><span class="line"><span class="regexp"> &lt;/</span>defs&gt;</span><br><span class="line"></span><br><span class="line">&lt;use x=<span class="string">"50"</span> y=<span class="string">"50"</span> xlink:href=<span class="string">"#Port"</span> style=<span class="string">"fill: blue;"</span>/&gt;</span><br></pre></td></tr></table></figure></p><h3 id="symbol"><a href="#symbol" class="headerlink" title="symbol"></a>symbol</h3><p>该标签和 g 标签类似，也是用来进行分组。不过，它有个特点，即，不会被浏览器所渲染。那它不和 defs 差不多吗？<br>恩，确实。不过，defs 是官方推荐，用来包裹一些模板 svg 代码而创造出来，用来增加可读性的标签。而 symbol 是存粹的作为一个模板。它可以独立于 svg 的 viewbox 来自定义子 viewbox 和 preserveAspectRatio。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;symbol id=<span class="string">"sym01"</span> viewBox=<span class="string">"0 0 150 110"</span>&gt;</span><br><span class="line">  &lt;circle cx=<span class="string">"50"</span> cy=<span class="string">"50"</span> r=<span class="string">"40"</span> stroke-width=<span class="string">"8"</span></span><br><span class="line">      stroke=<span class="string">"red"</span> fill=<span class="string">"red"</span>/&gt;</span><br><span class="line">  &lt;circle cx=<span class="string">"90"</span> cy=<span class="string">"60"</span> r=<span class="string">"40"</span> stroke-width=<span class="string">"8"</span></span><br><span class="line">      stroke=<span class="string">"green"</span> fill=<span class="string">"white"</span>/&gt;</span><br><span class="line">&lt;<span class="regexp">/symbol&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;use href="#sym01"</span></span><br><span class="line"><span class="regexp">     x="0" y="0" width="100" height="50"/</span>&gt;</span><br></pre></td></tr></table></figure></p><p>同样使用该模板，也是使用 use 标签来完成。</p><h3 id="image"><a href="#image" class="headerlink" title="image"></a>image</h3><p>既然 use 可以重用 SVG 代码，那么 SVG 里面能不能重用已经画好的 png/jpg 的图片呢？<br>这时候，就需要用到 image 标签。其可以用来加载外部的 PNG, JPEG 图片，注意，官方规定是前两种，其它图片支持不支持官方没做答复。即，如果你使用 GIF 图片，并不能保证所有的浏览器都能正常显示。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;image xlink:href=<span class="string">"kwanghwamun.jpg"</span></span><br><span class="line">  x=<span class="string">"72"</span> y=<span class="string">"92"</span></span><br><span class="line">  width=<span class="string">"160"</span> height=<span class="string">"120"</span>/&gt;</span><br><span class="line">&lt;<span class="regexp">/svg&gt;</span></span><br></pre></td></tr></table></figure></p><p>同样，该 image 标签也具有自定义 preserveAspectRatio 的效果。</p><ul><li>x: 定义水平位置</li><li>y: 定义垂直位置</li><li>width: 图片渲染的宽度，必须有。</li><li>height: 图片渲染的高度，必须有。</li><li>preserveAspectRatio: 控制图片的缩放</li></ul><h3 id="marker"><a href="#marker" class="headerlink" title="marker"></a>marker</h3><p>marker 一般是用来画箭头或者线段始末的标识图形。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;defs&gt;</span><br><span class="line">    &lt;marker id=<span class="string">"Triangle"</span> viewBox=<span class="string">"0 0 10 10"</span> refX=<span class="string">"1"</span> refY=<span class="string">"5"</span></span><br><span class="line">        markerWidth=<span class="string">"6"</span> markerHeight=<span class="string">"6"</span> orient=<span class="string">"auto"</span>&gt;</span><br><span class="line">      &lt;path d=<span class="string">"M 0 0 L 10 5 L 0 10 z"</span> /&gt;</span><br><span class="line">    &lt;<span class="regexp">/marker&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>defs&gt;</span><br><span class="line"></span><br><span class="line">  &lt;polyline points=<span class="string">"10,90 50,80 90,20"</span> fill=<span class="string">"none"</span> stroke=<span class="string">"black"</span> </span><br><span class="line">      stroke-width=<span class="string">"2"</span> marker-end=<span class="string">"url(#Triangle)"</span> /&gt;</span><br></pre></td></tr></table></figure></p><p>如图:<br><img src="/2019/09/30/SVG动画介绍/26.png" alt="img"><br>这里我们只需要里了解即可，因为在实际画的时候，直接使用相关工具生成更加方便。</p><h3 id="a"><a href="#a" class="headerlink" title="a"></a>a</h3><p>这里的 a 标签和我们直接在 HTML 使用的超链接 a 标签类似。也是用来定义一个外链的。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;a xlink:href=<span class="string">"https://developer.mozilla.org/en-US/docs/SVG"</span></span><br><span class="line">    target=<span class="string">"_blank"</span>&gt;</span><br><span class="line">  &lt;rect height=<span class="string">"30"</span> width=<span class="string">"120"</span> y=<span class="string">"0"</span> x=<span class="string">"0"</span> rx=<span class="string">"15"</span>/&gt;</span><br><span class="line">  &lt;text fill=<span class="string">"white"</span> text-anchor=<span class="string">"middle"</span> </span><br><span class="line">        y=<span class="string">"21"</span> x=<span class="string">"60"</span>&gt;SVG on MDN&lt;<span class="regexp">/text&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>a&gt;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;SVG动画效果简单入门介绍&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="javascript" scheme="/categories/javascript/"/>
    
    
      <category term="web图形" scheme="/tags/web%E5%9B%BE%E5%BD%A2/"/>
    
  </entry>
  
  <entry>
    <title>SVG入门教程</title>
    <link href="/2019/09/29/SVG%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/"/>
    <id>/2019/09/29/SVG入门教程/</id>
    <published>2019-09-29T02:04:14.000Z</published>
    <updated>2019-09-29T06:08:38.862Z</updated>
    
    <content type="html"><![CDATA[<p>SVG基础入门教程<br><a id="more"></a></p><h1 id="SVG入门教程"><a href="#SVG入门教程" class="headerlink" title="SVG入门教程"></a>SVG入门教程</h1><p>svg和canvas是web页面画图的两个方式，我们在开发中常用的图形是折线图，柱形图，扇形图等，大多都用现有的库来做，如echarts，highcherts,d3等。但是有些特殊的图形用库是实现不了的，这时候就需要我们自己去完成，canvas性能好，但是难度大，所以，这次我来介绍下svg的基础写法，方便使用。<br>SVG 全称是 Scalable Vector Graphics，即，矢量图。在 Web 中使用 SVG 可以解决位图放大失真的问题。首先，不要把 SVG 和 CSS，Canvas，HTML 搞混。他们之间并没有你中有我，我中有你的关系。SVG 是通过 XML 的形式写在 HTML 文档中的。</p><h2 id="如何书写"><a href="#如何书写" class="headerlink" title="如何书写"></a>如何书写</h2><p>开篇说过，SVG 就是一个 XML。看一下代码吧：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg x=<span class="string">"0px"</span> y=<span class="string">"0px"</span> width=<span class="string">"450px"</span> height=<span class="string">"100px"</span> viewBox=<span class="string">"0 0 450 100"</span>&gt;</span><br><span class="line">  &lt;rect x=<span class="string">"10"</span> y=<span class="string">"5"</span> fill=<span class="string">"white"</span> stroke=<span class="string">"black"</span> width=<span class="string">"90"</span> height=<span class="string">"90"</span>/&gt;</span><br><span class="line">  &lt;circle fill=<span class="string">"white"</span> stroke=<span class="string">"black"</span> cx=<span class="string">"170"</span> cy=<span class="string">"50"</span> r=<span class="string">"45"</span>/&gt;</span><br><span class="line">  &lt;polygon fill=<span class="string">"white"</span> stroke=<span class="string">"black"</span> points=<span class="string">"279,5 294,35 328,40 303,62</span></span><br><span class="line"><span class="string">  309,94 279,79 258,94 254,62 230,39 263,35"</span>/&gt;</span><br><span class="line">  &lt;line fill=<span class="string">"none"</span> stroke=<span class="string">"black"</span> x1=<span class="string">"410"</span> y1=<span class="string">"95"</span> x2=<span class="string">"440"</span> y2=<span class="string">"6"</span>/&gt;</span><br><span class="line">  &lt;line fill=<span class="string">"none"</span> stroke=<span class="string">"black"</span> x1=<span class="string">"360"</span> y1=<span class="string">"6"</span> x2=<span class="string">"360"</span> y2=<span class="string">"95"</span>/&gt;</span><br><span class="line">&lt;<span class="regexp">/svg&gt;</span></span><br></pre></td></tr></table></figure></p><p>大家看 svg 标签中带有一个 viewBox 的属性。这其实是 SVG 中一个很重要的概念，后面的缩放都会与它有关。<br>说到这里，我们就需要了解一下关于 SVG 的几个基本概念。</p><h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><p>简单来说有 3 个基本概念：</p><ul><li>viewport: 物理窗口</li><li>viewbox: 实物窗口（算了，下面解释）</li><li>preserveAspectRatio: 保留横纵比</li></ul><p>我们接下来，一个一个的进行讲解吧。</p><h3 id="viewport"><a href="#viewport" class="headerlink" title="viewport"></a>viewport</h3><p>参照上面的 demo，这实际上就是你用 x,y,width,height。这 4 个属性，在页面上固定的矩形区域。</p><h3 id="viewbox"><a href="#viewbox" class="headerlink" title="viewbox"></a>viewbox</h3><p>定义 SVG 元素在 viewport 中的具体尺寸比例。假设有如下内容：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg width=<span class="string">"500"</span> height=<span class="string">"200"</span> viewBox=<span class="string">"0 0 50 20"</span> &gt;</span><br><span class="line"> &lt;rect x=<span class="string">"20"</span> y=<span class="string">"10"</span> width=<span class="string">"10"</span> height=<span class="string">"5"</span> style=<span class="string">"stroke: #000000; fill:none;"</span>/&gt;</span><br><span class="line">&lt;<span class="regexp">/svg&gt;</span></span><br></pre></td></tr></table></figure></p><ul><li>viewport 为 [0,0] 到 [500,200]</li><li>viewbox 为 [0,0] 到 [50,20]</li></ul><p>默认情况下 SVG 是自动填充满 viewport 的。注意，在 SVG 中，子标签的所有尺寸都是不能带单位的，因为初始单位就是根据上面两个概念确定。<br>当为以上情况，SVG 中基本的尺寸则不是 1px，而是 500/50 = 10px。所以，如下的图形大小为：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;rect x=<span class="string">"20"</span> y=<span class="string">"10"</span> width=<span class="string">"10"</span> height=<span class="string">"5"</span> style=<span class="string">"stroke: #000000; fill:none;"</span>/&gt;</span><br></pre></td></tr></table></figure></p><p>也就是在 SVG 里面定义的 rect 图形，它的实际尺寸为 [200,100] 到 [100,50]。</p><h3 id="preserveAspectRatio"><a href="#preserveAspectRatio" class="headerlink" title="preserveAspectRatio"></a>preserveAspectRatio</h3><p>该属性就是用来定义上面 viewport 和 viewbox 相互对齐的方式。换句话就是说，它的属性可以改变 viewbox 的具体位置。基本格式为：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;align&gt; [&lt;meetOrSlice&gt;]</span><br></pre></td></tr></table></figure></p><ul><li>align: 定义 viewport 和 viewbox 的对齐方式，分为 x,y 轴两个方向。X 轴方向有三种方式：左边重合（xMin），x 轴中点重合（xMid），右边重合（xMax）。同理，Y 轴也有 顶边重合（YMin），y 轴中点重合（YMid），底边边重合（YMax）</li><li>meetOrSlice: 主要就是定义该 SVG 是内嵌，还是裁剪或是 none（听天有命）。</li></ul><p>其中，align 需要着重理解一下。首先，它的默认值为 xMidYMid，即为中点重合。<br><img src="/2019/09/29/SVG入门教程/1.png" alt="img"><br>可以从图中看出，viewbox 是通过中心进行延展的。注意，它的原点坐标还是在 viewbox 的左上角。如果你是动态增加尺寸的话，此时并不是从左到右增加，而是从中心向两端扩张。同理，如果你使用的是 xMinYMin 的话，那么如果存在尺寸变化，那么相对点则是从左上角开始的。简单来说，align 相对点其实一共有 9 个。<br><img src="/2019/09/29/SVG入门教程/2.png" alt="img"><br>然后就是 meet || slice || none 这三个属性具体干的事情。<br>在这之前，我们需要了解一个公式–缩放比计算公式：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vb_h * rat_y = vp_h; 或者 vb_w * rat_x = vp_w;</span><br></pre></td></tr></table></figure></p><p>其中，vb_ 为 viewbox 简写，vp_ 为 viewport 的简写。vb_h 代表就是 viewbox height。vb_w 代表就是 viewbox width。rat_x/y 代表的是 x,y 轴的缩放比例。<br>假设有下列情况：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg width=<span class="string">"400"</span> height=<span class="string">"200"</span> viewBox=<span class="string">"0 0 200 200"</span> preserveAspectRatio=<span class="string">"xMinYMin slice"</span> style=<span class="string">"border:1px solid #cd0000;"</span>&gt;</span><br><span class="line">    &lt;rect x=<span class="string">"10"</span> y=<span class="string">"10"</span> width=<span class="string">"150"</span> height=<span class="string">"150"</span> fill=<span class="string">"#cd0000"</span>/&gt;</span><br><span class="line">&lt;<span class="regexp">/svg&gt;</span></span><br></pre></td></tr></table></figure></p><p>那么，rat_x 和 rat_y 分别为：</p><ul><li>rat_x = 400/200 = 2</li><li>rat_y = 200/200 = 1</li></ul><p>现在，针对上面 meet/slice 不同的取值，实际应用到 svg 里面的缩放比例是不同的。</p><ul><li>meet(默认值): 本意是让 svg 尽可能的显示在 viewport 里，即，会在 rat_x 和 rat_y 中选择最小的值作为缩放标准。</li><li>slice: 本意是让 svg 完全铺满 viewport，即，会在 rat_x 和 rat_y 中选择最大的值作为缩放标准。</li></ul><p>所以针对不同的取值，基准比例也不同。<br>当为 meet 的情况，那么实际缩放比例为 1。则里面实际矩形的大小就为 (10,10) 到 (150,150)。<br><img src="/2019/09/29/SVG入门教程/3.png" alt="img"><br>当为 slice 的情况，那么实际缩放比例为 2。则里面实际矩形的大小就为 (20,20) 到 (300,300)。<br><img src="/2019/09/29/SVG入门教程/4.png" alt="img"><br>如果你的值为 none 的话，他会直接铺满整个 viewport，即，实际矩形大小为：(20,10) 到 (300,150)。<br><img src="/2019/09/29/SVG入门教程/5.png" alt="img"></p><h3 id="响应式-SVG"><a href="#响应式-SVG" class="headerlink" title="响应式 SVG"></a>响应式 SVG</h3><p>虽然讲起响应式，一些童鞋会想这 TM 又是啥奇技淫巧？<br>对不起，并不是。。。就是一个 viewbox 并且不带 width/height 而已。<br>看个实际的例子吧：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg viewBox=<span class="string">"0 0 218.8 87.1"</span>&gt;</span><br><span class="line">  &lt;g fill=<span class="string">"none"</span> stroke=<span class="string">"#000"</span>&gt;</span><br><span class="line">    &lt;path d=<span class="string">"M7.3 75L25.9 6.8s58.4-6.4 33.5 13-41.1 32.8-11.2 30.8h15.9v5.5s42.6</span></span><br><span class="line"><span class="string">      18.8 0 20.6"</span> /&gt;</span><br><span class="line">    &lt;path d=<span class="string">"M133.1 58.2s12.7-69.2 24.4-47.5c0 0 4.1 8.6 9.5.9 0 0 5-10 10.4.9 0</span></span><br><span class="line"><span class="string">      0 12.2 32.6 13.6 43 0 0 39.8 5.4 15.8 15.4-13.2 5.5-53.8</span></span><br><span class="line"><span class="string">      13.1-77.4 5.9.1 0-51.9-15.4 3.7-18.6z"</span> /&gt;</span><br><span class="line">  &lt;<span class="regexp">/g&gt; </span></span><br><span class="line"><span class="regexp">&lt;/</span>svg&gt;</span><br></pre></td></tr></table></figure></p><p>可以看到，上面的 svg 标签并没有带上啥 width/height 属性，只是简单描述了 viewBox 的范围而已。当然，里面的尺寸标准都是在这 viewBox 的范围内进行设置的。<br>另外，在这里声明一下，本文章并不是新手教程，也就是说，不会教你一步一步的画直线啊，圆啊，矩形啊等等这些基本图形。这些直接 google 一下，一搜一大把。所以，这里假设大家的水平是处于，能对 SVG 基本的图形属性熟悉即可，对一些高级属性还不是很清楚和熟练。OK，继续~<br>在 SVG 中，能够直接使用的图形有:</p><ul><li>rect</li><li>circle</li><li>ellipse</li><li>line</li><li>polyline</li><li>polygon</li></ul><p>上面没有啥说的，后面我详细说一下两个比较重要的概念，分组和 Path。</p><h2 id="分组和-Path"><a href="#分组和-Path" class="headerlink" title="分组和 Path"></a>分组和 Path</h2><p>通常 Path 和 分组通常是一起使用的，如上：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;g fill=<span class="string">"none"</span> stroke=<span class="string">"#000"</span>&gt;</span><br><span class="line">    &lt;path d=<span class="string">"M7.3 75L25.9 6.8s58.4-6.4 33.5 13-41.1 32.8-11.2 30.8h15.9v5.5s42.6</span></span><br><span class="line"><span class="string">      18.8 0 20.6"</span> /&gt;</span><br><span class="line">    &lt;path d=<span class="string">"M133.1 58.2s12.7-69.2 24.4-47.5c0 0 4.1 8.6 9.5.9 0 0 5-10 10.4.9 0</span></span><br><span class="line"><span class="string">      0 12.2 32.6 13.6 43 0 0 39.8 5.4 15.8 15.4-13.2 5.5-53.8</span></span><br><span class="line"><span class="string">      13.1-77.4 5.9.1 0-51.9-15.4 3.7-18.6z"</span> /&gt;</span><br><span class="line">&lt;<span class="regexp">/g&gt;</span></span><br></pre></td></tr></table></figure></p><p>分组我们放到后面进行讲解，这里先看一下 Path。</p><h3 id="Path"><a href="#Path" class="headerlink" title="Path"></a>Path</h3><p>Path 在 SVG 中的地位应该是比较高的，实际上，利用 Path 这个一个标签可以画出任意的图形。path 中 d(data) 属性是用来定义相关线条数据，通常是以 M/m 为起始，代表的就是 move to 的意思。在 path 中，一共可以定义 10 种不同的图形。例如 M/m，L/l。 大家可以注意，每种标识符有两种书写方式，即，大小写。</p><ul><li>大写: 参照的是绝对坐标，即，SVG 的右上角</li><li>小写: 参照的相对坐标，即，前一个点的坐标。</li></ul><p>而在 10 中不同表示符中，又可以分为直线和曲线两种不同的标识符。这里，我们分类来讲解一下。</p><h3 id="线型"><a href="#线型" class="headerlink" title="线型"></a>线型</h3><h4 id="M-m"><a href="#M-m" class="headerlink" title="M/m"></a>M/m</h4><p>该使用定义起始点的，没啥特殊的作用。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;path d=<span class="string">"M10 10"</span>/&gt;</span><br></pre></td></tr></table></figure></p><p>表示，以 (10,10) 为起始点。</p><h4 id="L-l"><a href="#L-l" class="headerlink" title="L/l"></a>L/l</h4><p>原意是 Line to，用来画线段的。格式和 M/m 差不多：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">L x y (or l dx dy)</span><br></pre></td></tr></table></figure></p><h4 id="H-h"><a href="#H-h" class="headerlink" title="H/h"></a>H/h</h4><p>用来画水平线，即，Horizontal。既然方向已经定了，剩下的就是距离，格式很简单：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">H x (or h dx)</span><br></pre></td></tr></table></figure></p><h4 id="V-v"><a href="#V-v" class="headerlink" title="V/v"></a>V/v</h4><p>用来画竖直线，即，vertical。同上，方向也定了，格式为：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">V y (or v dy)</span><br></pre></td></tr></table></figure></p><p>看个例子吧：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;path d=&quot;M10 10 H 90 V 90 H 10 L 10 10&quot;/&gt;</span><br></pre></td></tr></table></figure></p><p>该 path 实际上就是画了一个正方形，宽 = 高 = 90。<br><img src="/2019/09/29/SVG入门教程/6.png" alt="img"></p><h4 id="Z-z"><a href="#Z-z" class="headerlink" title="Z/z"></a>Z/z</h4><p>该标识符用来表示 path 的结束，并且将最后一点和 M/m 标识开头的一点连接起来。所以，它不存在什么表示点之类的，格式为：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Z (or z)</span><br></pre></td></tr></table></figure></p><p>而上面也可以进行相关的优化，最终的结果为：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;path d=<span class="string">"M10 10 H 90 V 90 H 10 L 10 10"</span>/&gt;</span><br><span class="line"><span class="comment">// 使用 Z</span></span><br><span class="line">&lt;path d=<span class="string">"M10 10 H 90 V 90 H 10 Z"</span> fill=<span class="string">"transparent"</span> stroke=<span class="string">"black"</span>/&gt;</span><br></pre></td></tr></table></figure></p><h3 id="曲线"><a href="#曲线" class="headerlink" title="曲线"></a>曲线</h3><p>曲线就是 Web 画图中常见的 Bezier Curves（贝塞尔），Arcs，several Bezier curves（很多贝塞尔 - .-）等。<br>我们简单看一下：</p><h4 id="C-c"><a href="#C-c" class="headerlink" title="C/c"></a>C/c</h4><p>这是正统的贝塞尔曲线，需要 4 个参考点，下图应该说比较确切表示了二次贝塞尔所需要的点。所以，C/c 需要定义三个点。<br><img src="/2019/09/29/SVG入门教程/7.png" alt="img"><br>基本格式为：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C x1 y1, x2 y2, x y (or c dx1 dy1, dx2 dy2, dx dy)</span><br></pre></td></tr></table></figure></p><p>例如：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;path d=<span class="string">"M10 10 C 20 20, 40 20, 50 10"</span> stroke=<span class="string">"black"</span> fill=<span class="string">"transparent"</span>/&gt;</span><br></pre></td></tr></table></figure></p><h4 id="S-s"><a href="#S-s" class="headerlink" title="S/s"></a>S/s</h4><p>该标识符实际上使用来表示一个反射贝塞尔，即，在原有贝塞尔上再加一段贝塞尔曲线，所以，S/s 一般和 C/c 一起使用。<br>基本格式为：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">S x2 y2, x y (or s dx2 dy2, dx dy)</span><br></pre></td></tr></table></figure></p><p>实际样式图为：<br><img src="/2019/09/29/SVG入门教程/8.png" alt="img"><br>相当于原有的贝塞尔曲线的最后一段进行反向延长并对称。然后加上新定义的一段限制曲线。<br>具体实例为：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;path d=<span class="string">"M10 80 C 40 10, 65 10, 95 80 S 150 150, 180 80"</span> stroke=<span class="string">"black"</span> fill=<span class="string">"transparent"</span>/&gt;</span><br></pre></td></tr></table></figure></p><h4 id="Q-q"><a href="#Q-q" class="headerlink" title="Q/q"></a>Q/q</h4><p>该标识符是用来定义二次(quadratic)贝塞尔曲线，该曲线相当于上面传统的贝塞尔来说，更加简单，它只需要定义三个点，即可完整一个贝塞尔曲线，具体作图过程如下：<br><img src="/2019/09/29/SVG入门教程/9.gif" alt="img"><br>基本格式为：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Q x1 y1, x y (or q dx1 dy1, dx dy)</span><br></pre></td></tr></table></figure></p><p>即为图上点， P1(x1,y1)，P2(x,y)<br>起始点为 M 定义的点，例如：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;path d=<span class="string">"M10 80 Q 95 10 180 80"</span> stroke=<span class="string">"black"</span> fill=<span class="string">"transparent"</span>/&gt;</span><br></pre></td></tr></table></figure></p><h4 id="T-t"><a href="#T-t" class="headerlink" title="T/t"></a>T/t</h4><p>该标识符和 S 差不多，也是一个贝塞尔曲线的延长。相当于原曲线的控制点 P1 相当于 end point P2 做对称，然后，只需要定义一个终点即可，即，T/t 只需要定义贝塞尔曲线里面的终点即可：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">T x y (or t dx dy)</span><br></pre></td></tr></table></figure></p><p>如图：<br><img src="/2019/09/29/SVG入门教程/10.png" alt="img"><br>所以，简单来说，C/S，Q/T 是两两搭配一起使用的。在使用的时候，千万不要搞混即可。</p><h3 id="弧线"><a href="#弧线" class="headerlink" title="弧线"></a>弧线</h3><h4 id="A-a"><a href="#A-a" class="headerlink" title="A/a"></a>A/a</h4><p>该曲线是用来画弧线(Arcs)，而，弧线通常是圆/椭圆的一部分。当，椭圆的两个轴径长相等则为圆，所以，A/a 是按照椭圆作为基准格式：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">A rx ry x-axis-rotation large-arc-flag sweep-flag x y</span><br><span class="line">a rx ry x-axis-rotation large-arc-flag sweep-flag dx dy</span><br></pre></td></tr></table></figure></p><p>说实在的，这个比较复杂。因为，他画椭圆的方式和我们平常不一样，一般情况下，椭圆只要确定一个中心，然后是长短轴，然后是弧度范围即可。<br>但是，它这里是通过椭圆上的两点来确定的，在加上旋转角度，俩轴径等因素来确定的。另外，需要注意，它的起始点是从上一个命令的结束点位置开始计算的。OK，我们首先简单了解一下格式里面的参数：</p><ul><li>rx,ry: 代表的就是长轴短轴，没得说。</li><li>x,y: 代表的是弧长的结束点。开始点就是上一个命令的终点。</li><li>x-axis-rotation: x 轴的旋转角度。顺时针为正</li><li>large-arc-flag[0,1]: 表示取大弧还是小弧。因为两点之间的弧长有两部分。</li><li>sweep-flag[0,1]: 取顺时针的弧，还是逆时针的弧长。参考点是以起始点开始的。</li></ul><p>上面几个属性中，比较难理解的就是 large-arc-flag 和 sweep-flag。这么说吧，前面几个属性充其量只能确定椭圆的位置，和经过椭圆的两个点，不过，一般能通过指定两点的椭圆有两个，而通过这两点划分又会出现 4 段弧长。为了确定 4 个弧长中，是哪一个，需要两个值来确定。即，4 抽 2，2 抽 1。<br><img src="/2019/09/29/SVG入门教程/11.png" alt="img"><br>简单说一种，例如当，laf 和 sf 都为 0的情况。首先，laf 为 0 选择的是小弧长。所以，里面两段比较小的弧长被抽出来。然后，sf 为 0 选择的是逆时针。即，以起始点为参考，选择通过逆时针方向到达终点的那段弧。即，2 抽 1。最终得出我们需要的弧。<br>说实在的，这个是真 TM 复杂。。。<br>给一个参考<a href="https://codepen.io/netsi1964/pen/pJzWoz" target="_blank" rel="noopener">codepen</a>。<br>一般情况下，我们并不需要手动来确定 path，有工具为啥不用工具呢！<br>比如，Illustrator, Sketch 等，都可以自动生成 SVG。不过，生成之后，需要对代码做相关的压缩优化，这些都可以直接在编译器里面找到。<br>你也可以用一下可视化工具<a href="https://jakearchibald.github.io/svgomg/" target="_blank" rel="noopener">SVGOMG</a>来简单看一下。</p><h3 id="分组"><a href="#分组" class="headerlink" title="分组"></a>分组</h3><p>SVG 中的分组你可以理解为 PS 中的图层，一块图层里面通常只会放一下高内聚的图形，这样既方便移动又方便做动画。SVG 中的分组标签就是 g，使用 g 标签包裹的所有子元素都认同为一组。<br>例如：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> &lt;g&gt;</span><br><span class="line">  &lt;circle cx=<span class="string">"20"</span> cy=<span class="string">"20"</span> r=<span class="string">"20"</span> fill=<span class="string">"green"</span> /&gt;</span><br><span class="line">  &lt;circle cx=<span class="string">"70"</span> cy=<span class="string">"70"</span> r=<span class="string">"20"</span> fill=<span class="string">"purple"</span> /&gt;</span><br><span class="line">&lt;<span class="regexp">/g&gt;</span></span><br><span class="line"><span class="regexp">&lt;g&gt;</span></span><br><span class="line"><span class="regexp">  &lt;rect x="110" y="110" height="30" width="30" fill="blue" /</span>&gt;</span><br><span class="line">  &lt;rect x=<span class="string">"160"</span> y=<span class="string">"160"</span> height=<span class="string">"30"</span> width=<span class="string">"30"</span> fill=<span class="string">"red"</span> /&gt;</span><br><span class="line">&lt;<span class="regexp">/g&gt;</span></span><br></pre></td></tr></table></figure></p><p>需要注意的是，使用 g 进行分组，并不会改变原有元素的在屏幕上展示的效果。<br>不过，g 标签除了分组，还有另外一个很重要的功能–动画</p><h4 id="分组动画"><a href="#分组动画" class="headerlink" title="分组动画"></a>分组动画</h4><p>在分组重定义动画是直接写在 transform 属性当中的。实际上，每个子标签都可以使用 transform 的相关属性。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;g transform=<span class="string">"translate(...) scale(...) rotate(...) translate(...) rotate(...)"</span>&gt;</span><br><span class="line">  ...</span><br><span class="line">&lt;<span class="regexp">/g&gt;</span></span><br></pre></td></tr></table></figure></p><p>每种变换动画之间是通过 空格或逗号 连接的。它的执行顺序是从右到左。为啥呢？实际上可以理解为，这就是几个嵌套的 g 叠在一起。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> &lt;g transform=<span class="string">"translate(...) scale(...) rotate(...) translate(...) rotate(...)"</span>&gt;</span><br><span class="line">   ...</span><br><span class="line"> &lt;<span class="regexp">/g&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"> /</span><span class="regexp">/ Being Equivalent to this:</span></span><br><span class="line"><span class="regexp"> &lt;g transform="translate(...)"&gt;</span></span><br><span class="line"><span class="regexp">  &lt;g transform="scale(...)"&gt;</span></span><br><span class="line"><span class="regexp">    &lt;g transform="rotate(...)"&gt;</span></span><br><span class="line"><span class="regexp">      &lt;g transform="translate(...)"&gt;</span></span><br><span class="line"><span class="regexp">        &lt;g transform="rotate(...)"&gt;</span></span><br><span class="line"><span class="regexp">          ...</span></span><br><span class="line"><span class="regexp">        &lt;/g</span>&gt;</span><br><span class="line">      &lt;<span class="regexp">/g&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/g</span>&gt;</span><br><span class="line">  &lt;<span class="regexp">/g&gt;</span></span><br><span class="line"><span class="regexp">&lt;/g</span>&gt;</span><br></pre></td></tr></table></figure></p><p>具体可以使用的动画形式和 CSS 动画一模一样，详情可以参考: <a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/transform" target="_blank" rel="noopener">SVG动画</a></p><p>以上就是SVG的简单入门介绍，<a href="https://www.villainhr.com/page/2017/04/17/SVG%20快速入门" target="_blank" rel="noopener">原文请点这里</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;SVG基础入门教程&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="javascript" scheme="/categories/javascript/"/>
    
    
      <category term="web图形" scheme="/tags/web%E5%9B%BE%E5%BD%A2/"/>
    
  </entry>
  
  <entry>
    <title>puppeteer爬取简书文章</title>
    <link href="/2019/09/26/puppeteer%E7%88%AC%E5%8F%96%E7%AE%80%E4%B9%A6%E6%96%87%E7%AB%A0/"/>
    <id>/2019/09/26/puppeteer爬取简书文章/</id>
    <published>2019-09-26T03:05:46.000Z</published>
    <updated>2019-09-26T05:09:03.862Z</updated>
    
    <content type="html"><![CDATA[<p>puppeteer爬取简书文章的小例子<br><a id="more"></a></p><h1 id="puppeteer爬取简书文章"><a href="#puppeteer爬取简书文章" class="headerlink" title="puppeteer爬取简书文章"></a>puppeteer爬取简书文章</h1><p>puppeteer这个工具库我已经了解有些时候了，自己在之前的文章中也有简单的介绍，也列出了几个学习站点，不过，第一个爬虫的例子，还是缓缓的到来了。<br>这个小例子很简单，只有几十行代码，大概的流程是，首先打开简书的首页，之后下拉到底部，加载数据，下拉几次之后就没有了下拉加载的功能，取而代之的是“阅读更多”按钮，点击后会加载新内容。就这样往复的加载文章的列表，当符合自己设定的上限值后，停止加载，拿到了文章列表后循环的打开相对应的页面，读取文章详细内容，并写到本地磁盘里。<br>代码如下：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> puppeteer = <span class="built_in">require</span>(<span class="string">'puppeteer'</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="comment">// 简书网址</span></span><br><span class="line"><span class="keyword">const</span> baseUrl = <span class="string">'https://www.jianshu.com'</span>;  </span><br><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> browser = <span class="keyword">await</span> puppeteer.launch(&#123;</span><br><span class="line">    headless:<span class="literal">false</span>,</span><br><span class="line">    slowMo:<span class="number">250</span>,</span><br><span class="line">    defaultViewport: &#123;</span><br><span class="line">      width: <span class="number">1200</span>,</span><br><span class="line">      height: <span class="number">600</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">const</span> page = <span class="keyword">await</span> browser.newPage();</span><br><span class="line">  <span class="comment">// page.setDefaultNavigationTimeout(timeout);</span></span><br><span class="line">  <span class="keyword">await</span> page.goto(baseUrl);</span><br><span class="line">  <span class="comment">// await page.waitFor(1000);</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 获取简书首页中的列表数据</span></span><br><span class="line">  <span class="keyword">const</span> hrefList = <span class="keyword">await</span> page.evaluate(<span class="function">(<span class="params">baseUrl</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> arr = [], list;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>)=&gt;</span> &#123;</span><br><span class="line">      <span class="function"><span class="keyword">function</span> <span class="title">loadPage</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> btn = <span class="built_in">document</span>.querySelector(<span class="string">'.load-more'</span>); </span><br><span class="line">        <span class="keyword">if</span>(btn) &#123;</span><br><span class="line">          btn.click();</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">var</span> pageHeight = <span class="built_in">document</span>.querySelector(<span class="string">'#list-container'</span>).offsetHeight;</span><br><span class="line">          <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>; i&lt;pageHeight; i++) &#123;</span><br><span class="line">            <span class="built_in">document</span>.documentElement.scrollTo(<span class="number">0</span>, i);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">          list = <span class="built_in">document</span>.querySelectorAll(<span class="string">'#list-container .note-list li'</span>);</span><br><span class="line">          <span class="keyword">if</span>(list.length &lt; <span class="number">50</span>) &#123;</span><br><span class="line">            loadPage();</span><br><span class="line">          &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">let</span> item <span class="keyword">of</span> list) &#123;</span><br><span class="line">              <span class="keyword">let</span> href = item.querySelector(<span class="string">'a'</span>).getAttribute(<span class="string">'href'</span>);</span><br><span class="line">              arr.push(baseUrl + href);</span><br><span class="line">            &#125;</span><br><span class="line">            resolve(arr);</span><br><span class="line">          &#125;    </span><br><span class="line">        &#125;, <span class="number">2000</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      loadPage();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;, baseUrl);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 通过hrefList来获取单个的文章内容，并写入文章文件</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> item <span class="keyword">of</span> hrefList) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">await</span> page.goto(item);</span><br><span class="line">    &#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">await</span> page.waitFor(<span class="number">5000</span>);</span><br><span class="line">    <span class="keyword">var</span> article = <span class="keyword">await</span> page.evaluate(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">var</span> mainText;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        mainText = <span class="built_in">document</span>.querySelector(<span class="string">'._gp-ck'</span>).innerHTML;</span><br><span class="line">      &#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">        mainText = <span class="string">'此页面有问题。'</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> mainText;</span><br><span class="line">    &#125;);</span><br><span class="line">    fs.writeFileSync(<span class="string">'./download-articles/'</span>+item.replace(<span class="regexp">/\/|\:|\./g</span>, <span class="string">''</span>)+<span class="string">'.txt'</span>, article, &#123;</span><br><span class="line">      flag: <span class="string">'a'</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 关闭浏览器</span></span><br><span class="line">  <span class="keyword">await</span> browser.close();</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure></p><p>以后还会更新些更复杂的爬虫案例哦。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;puppeteer爬取简书文章的小例子&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="javascript" scheme="/categories/javascript/"/>
    
    
      <category term="爬虫" scheme="/tags/%E7%88%AC%E8%99%AB/"/>
    
  </entry>
  
  <entry>
    <title>文本文件和二进制文件的差异和区别</title>
    <link href="/2019/09/24/%E6%96%87%E6%9C%AC%E6%96%87%E4%BB%B6%E5%92%8C%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6%E7%9A%84%E5%B7%AE%E5%BC%82%E5%92%8C%E5%8C%BA%E5%88%AB/"/>
    <id>/2019/09/24/文本文件和二进制文件的差异和区别/</id>
    <published>2019-09-24T01:46:35.000Z</published>
    <updated>2019-09-24T02:00:23.383Z</updated>
    
    <content type="html"><![CDATA[<p>文本文件和二进制文件的差异和区别<br><a id="more"></a></p><h1 id="文本文件和二进制文件的差异和区别"><a href="#文本文件和二进制文件的差异和区别" class="headerlink" title="文本文件和二进制文件的差异和区别"></a>文本文件和二进制文件的差异和区别</h1><h2 id="一："><a href="#一：" class="headerlink" title="一："></a>一：</h2><p>广义上的二进制文件包括文本文件，这里讨论的是狭义上的二进制文件与文本文件的比较：</p><ul><li>1.能存储的数据类型不同<br>文本文件只能存储char型字符变量。二进制文件可以存储char/int/short/long/float/……各种变量值。</li><li>2.每条数据的长度<br>文本文件每条数据通常是固定长度的。以ASCII为例，每条数据(每个字符)都是1个字节。进制文件每条数据不固定。如short占两个字节，int占四个字节，float占8个字节……</li><li>3.读取的软件不同<br>文本文件编辑器就可以读写。比如记事本、NotePad++、Vim等。二进制文件需要特别的解码器。比如bmp文件需要图像查看器，rmvb需要播放器……</li><li>4.操作系统对换行符(‘\n’)的处理不同（不重要）<br>文本文件，操作系统会对’\n’进行一些隐式变换，因此文本文件直接跨平台使用会出问题。<br>在Windows下，写入’\n’时，操作系统会隐式的将’\n’转换为”\r\n”，再写入到文件中；读的时候，会把“\r\n”隐式转化为’\n’，再读到变量中。<br>在Linux下，写入’\n’时，操作系统不做隐式变换。<br>二进制文件，操作系统不会对’\n’进行隐式变换，很多二进制文件（如电影、图片等）可以跨平台使用。</li></ul><p>从存储方式来说，文件在磁盘上的存储方式都是二进制形式，所以，文本文件其实也应该算二进制文件。先从他们的区别来说，虽然都是二进制文件，但是二进制代表的意思不一样。打个比方，一个人，我们可以叫他的大名，可以叫他的小名，但其实都是代表这个人。二进制读写是将内存里面的数据直接读写入文本中，而文本呢，则是将数据先转换成了字符串，再写入到文本中。<br>要弄明白二者的区别，需要知道文件的读写过程。以读文件为例，</p><p>实际上是磁盘 》》 文件缓冲区》》应用程序内存空间这两个转化过程。我们说“文本文件和二进制文件没有区别”，实际上针对的是第一个过程；既然没有区别，那么打开方式不同，为何显示内容就不同呢？这个区别实际上是第二个过程造成的。</p><p>文件实际上包括两部分，控制信息和内容信息。纯文本文件仅仅是没有控制格式信息罢了；</p><p>实际上也是一种特殊的二进制文件。所以，我们很难区分二者的不同，因为他们的概念上不是完全互斥的。我们说文本文件是特殊的二进制文件，是因为文本文件实际上的解释格式已经确定了：ASCII或者unicode编码。文本文件的一个缺点是，它的熵往往较低，也就是说，其实本可以用更小的存储空间记录这些信息。比如，文本文件中的一个数字65536，需要用5个字节来存储；但是用二进制格式，采用int存储，仅仅需要2个字节。而二进制文件elf和bmp等，都往往有一个head，告诉你文件信息和解释方式。</p><p>记事本支持文本文件而不支持二进制文件，所以如果你用记事本打开文本文件那么一切正常，如果打开的是二进制文件就会出现乱码。但也有不乱码的地方，你会注意到那些地方都是字符编码的，而对于int、double等类型所对应的值都是乱码的，这是由于记事本只能够识别字符类型，而无法识别其他类型。</p><ul><li>1.二进制文件是把内存中的数据按其在内存中的存储形式原样输出到磁盘上存放，也就是说存放的是数据的原形式。</li><li>2.文本文件是把数据的终端形式的二进制数据输出到磁盘上存放，也就是说存放的是数据的终端形式。</li></ul><p>字符数据本身在内存中就经过了编码，所以无论是二进制还是文本形式都是一样的，而对于非字符数据来说，例如inti=10；如果用二进制来进行存储的话为1010，但是如果需要用文本形式来进行存储的话就必须进行格式化编码（对1和0分别编码，即形式为‘1’和‘0’分别对应的码值）。</p><h2 id="二："><a href="#二：" class="headerlink" title="二："></a>二：</h2><p>1.文本文件与二进制文件的定义<br>大家都知道计算机的存储在物理上是二进制的，所以文本文件与二进制文件的区别并不是物理上的，而是逻辑上的。这两者只是在编码层次上有差异。简单来说，文本文件是基于字符编码的文件，常见的编码有ASCII编码，UNICODE编码等等。二进制文件是基于值编码的文件，你可以根据具体应用，指定某个值是什么意思（这样一个过程，可以看作是自定义编码。</p><p>从上面可以看出文本文件基本上是定长编码的(也有非定长的编码如UTF-8)。而二进制文件可看成是变长编码的，因为是值编码嘛，多少个比特代表一个值，完全由你决定。大家可能对BMP文件比较熟悉，就拿它举例子吧，其头部是较为固定长度的文件头信息，前2字节用来记录文件为BMP格式，接下来的8个字节用来记录文件长度，再接下来的4字节用来记录bmp文件头的长度。</p><p>2.文本文件与二进制文件的存取<br>文本工具打开一个文件的过程是怎样的呢？拿记事本来说，它首先读取文件物理上所对应的二进制比特流，然后按照你所选择的解码方式来解释这个流，然后将解释结果显示出来。一般来说，你选取的解码方式会是ASCII码形式（ASCII码的一个字符是8个比特），接下来，它8个比特8个比特地来解释这个文件流。例如对于这么一个文件流”01000000_01000001_01000010_01000011”(下划线”_”，为了增强可读性手动添加的)，第一个8比特”01000000”按ASCII码来解码的话，所对应的字符是字符”A”，同理其它3个8比特可分别解码为”BCD”，即这个文件流可解释成“ABCD”，然后记事本就将这个“ABCD”显示在屏幕上。</p><p>事实上，世界上任何东西要与其他东西通信会话，都存在一个既定的协议，既定的编码。人与人之间通过文字联络，汉字“妈”代表生你的那个人，这就是一种既定的编码。但注意到这样一种情况，汉字“妈”在日本文字里有可能是你生下的那个人，所以当一个中国人A与日本B之间用“妈”这个字进行交流，出现误解就很正常的。用记事本打开二进制文件与上面的情况类似。记事本无论打开什么文件都按既定的字符编码工作（如ASCII码），所以当他打开二进制文件时，出现乱码也是很必然的一件事情了，解码和译码不对应嘛。例如文件流”00000000_00000000_00000000_00000001”可能在二进制文件中对应的是一个四字节的整数int 1，在记事本里解释就变成了”NULL_NULL_NULL_SOH”这四个控制符。</p><p>文本文件的存储与其读取基本上是个逆过程。而二进制文件的存取显然与文本文件的存取差不多，只是编／解码方式不同而已。</p><p>3.文本文件与二进制文件的优缺点<br>因为文本文件与二进制文件的区别仅仅是编码上不同，所以他们的优缺点就是编码的优缺点，这个找本编码的书来看看就比较清楚了。一般认为，文本文件编码基于字符定长，译码容易些；二进制文件编码是变长的，所以它灵活，存储利用率要高些，译码难一些（不同的二进制文件格式，有不同的译码方式）。关于空间利用率，想想看，二进制文件甚至可以用一个比特来代表一个意思(位操作)，而文本文件任何一个意思至少是一个字符。</p><p>在windows下,文本文件不一定是一ASCII来存贮的,因为ASCII码只能表示128的标识,你打开一个txt文档,然后另存为,有个选项是编码,可以选择存贮格式,一般来说UTF-8编码格式兼容性要好一些.而二进制用的计算机原始语言,不存贮兼容性. 很多书上还认为，文本文件的可读性要好些，存储要花费转换时间(读写要编译码)，而二进制文件可读性差，存储不存在转换时间（读写不要编解码，直接写值）．这里的可读性是从软件使用者角度来说的，因为我们用通用的记事本工具就几乎可以浏览所有文本文件，所以说文本文件可读性好；而读写一个具体的二进制文件需要一个具体的文件解码器，所以说二进制文件可读性差，比如读BMP文件，必须用读图软件。</p><p>而这里的存储转换时间应该是从编程的角度来说的，因为有些操作系统如windows需要对回车换行符进行转换(将”\n”，换成”\r\n”，所以文件读写时，操作系统需要一个一个字符的检查当前字符是不是”\n”或”\r\n”).这个在存储转换在Linux操作系统中并不需要，当然，当在两个不同的操作系统上共享文件时，这种存储转换又可能出来。</p><h2 id="三："><a href="#三：" class="headerlink" title="三："></a>三：</h2><p>文本文件是一种计算机文件，它是一种典型的顺序文件，其文件的逻辑结构又属于流式文件。</p><p>特别的是，文本文件是指以ASCII码方式(也称文本方式)存储的文件，更确切地说，英文、数字等字符存储的是ASCII码，而汉字存储的是机内码。文本文件中除了存储文件有效字符信息（包括能用ASCII码字符表示的回车、换行等信息）外，不能存储其他任何信息。</p><p>文本文件是一种由若干行字符构成的计算机文件。文本文件存在于计算机文件系统中。通常，通过在文本文件最后一行后放置文件结束标志来指明文件的结束。文本文件是指一种容器，而纯文本是指一种内容。文本文件可以包含纯文本。一般来说，计算机文件可以分为两类：文本文件和二进制文件。</p><p>只含有ASCII字符的文本文件可以在Unix、Macintosh、Microsoft Windows、DOS和其它操作系统之间自由交互，而其它格式的文件是很难做到这一点的。但是，在这些操作系统中，换行符并不相同，处理非ASCII字符的方式也不一致。</p><p>.txt是包含极少格式信息的文字文件的扩展名。.txt格式并没有明确的定义，它通常是指那些能够被系统终端或者简单的文本编辑器接受的格式。任何能读取文字的程序都能读取带有.txt扩展名的文件，因此，通常认为这种文件是通用的、跨平台的。</p><p>在英文文本文件中，ASCII字符集是最为常见的格式，而且在许多场合，它也是默认的格式。对于带重音符号的和其它的非ASCII字符，必须选择一种字符编码。在很多系统中，字符编码是由计算机的区域设置决定的。常见的字符编码包括支持许多欧洲语言的ISO 8859-1。</p><p>由于许多编码只能表达有限的字符，通常它们只能用于表达几种语言。Unicode制定了一种试图能够表达所有已知语言的标准，Unicode字符集非常大，它囊括了大多数已知的字符集。Unicode有多种字符编码，其中最常见的是UTF-8，这种编码能够向后兼容ASCII，相同内容的的ASCII文本文件和UTF-8文本文件完全一致。</p><p>微软的MS-DOS和Windows采用了相同的文本文件格式，它们都使用CR和LF两个字符作为换行符，这两个字符对应的ASCII码分别为13和10。通常，最后一行文本并不以换行符(CR-LF标志)结尾，包括记事本在内的很多文本编辑器也不在文件的最后添加换行符。</p><p>大多数Windows文本文件使用ANSI、OEM或者Unicode编码。Windows所指的ANSI编码通常是1字节的ISO-8859编码，不过对于像中文、日文、朝鲜文这样的环境，需要使用2字节字符集。在过渡至Unicode前，Windows一直用ANSI作为系统默认的编码。而OEM编码，也是通常所说的MS-DOS代码页，是IBM为早期IBM个人电脑的文本模式显示系统定义的。在全屏的MS-DOS程序中同时使用了图形的和按行绘制的字符。新版本的Windows可以使用UTF-16LE和UTF-8之类的Unicode编码。</p><p>由于结构简单，文本文件被广泛用于记录信息。它能够避免其它文件格式遇到的一些问题。此外，当文本文件中的部分信息出现错误时，往往能够比较容易的从错误中恢复出来，并继续处理其余的内容。文本文件的一个缺点是，它的熵往往较低，也就是说，可以用较小的存储空间记录这些信息。</p><p>文本文件基本上是定长编码的(也有非定长的编码如UTF-8)，基于字符，每个字符在具体编码中是固定的，ASCII码是8个比特的编码，UNICODE一般占16个比特。而二进制文件可看成是变长编码的，因为是值编码，多少个比特代表一个值，完全由自己决定。</p><p>广义的二进制文件即指文件，由文件在外部设备的存放形式为二进制而得名。狭义的二进制文件即除文本文件以外的文件。</p><p>每个字符由一个或多个字节组成，每个字节都是用的-128—127之间的部分数值来表示的，也就是说，-128——127之间还有一些数据没有对应任何字符的任何字节。如果一个文件中的每个字节的内容都是可以表示成字符的数据，我们就可以称这个文件为文本文件。文本文件只是二进制文件中的一种特例，为了与文本文件相区别，人们又把除了文本文件以外的文件称为二进制文件，由于很难严格区分文本文件和二进制文件的概念，所以我们可以简单地认为，如果一个文件专门用于存储文本字符的数据，没有包含字符以外的其他数据，我们就称之为文本文件，除此之外的文件就是二进制文件。</p><p>为什么要使用二进制文件。原因大概有三个：</p><p>第一是二进制文件比较节约空间，这两者储存字符型数据时并没有差别。但是在储存数字，特别是实型数字时，二进制更节省空间；第二个原因是，内存中参加计算的数据都是用二进制无格式储存起来的，因此，使用二进制储存到文件就更快捷。如果储存为文本文件，则需要一个转换的过程。在数据量很大的时候，两者就会有明显的速度差别了。第三，就是一些比较精确的数据，使用二进制储存不会造成有效位的丢失。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;文本文件和二进制文件的差异和区别&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="javascript" scheme="/categories/javascript/"/>
    
    
      <category term="基础知识" scheme="/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
  </entry>
  
  <entry>
    <title>WebGL是啥？</title>
    <link href="/2019/09/23/WebGL%E6%98%AF%E5%95%A5%EF%BC%9F/"/>
    <id>/2019/09/23/WebGL是啥？/</id>
    <published>2019-09-23T01:48:45.000Z</published>
    <updated>2019-09-23T02:01:36.431Z</updated>
    
    <content type="html"><![CDATA[<p>简单的介绍一下WebGL是什么<br><a id="more"></a></p><h1 id="WebGL是啥？"><a href="#WebGL是啥？" class="headerlink" title="WebGL是啥？"></a>WebGL是啥？</h1><p>为了让大家快速认识WebGL，先不讲解具体的知识点，我相信很多程序员希望通过一个麻雀虽小，但是五脏俱全的demo来认识一个新的技术领域。所以这里通过一个简单的案例来给大家展示WebGL技术，下面的代码完成的效果就是在canvas画布上绘制一个点。</p><h2 id="使用WebGL绘制一个点"><a href="#使用WebGL绘制一个点" class="headerlink" title="使用WebGL绘制一个点"></a>使用WebGL绘制一个点</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">    &lt;title&gt;使用WebGL绘制一个点&lt;<span class="regexp">/title&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;!--canvas标签创建一个宽高均为<span class="number">500</span>像素，背景为蓝色的矩形画布--&gt;</span><br><span class="line">&lt;canvas id=<span class="string">"webgl"</span> width=<span class="string">"500"</span> height=<span class="string">"500"</span> style=<span class="string">"background-color: blue"</span>&gt;&lt;/canvas&gt;</span><br><span class="line"></span><br><span class="line">&lt;<span class="regexp">/body&gt;</span></span><br><span class="line"><span class="regexp">&lt;!-- 顶点着色器源码 --&gt;</span></span><br><span class="line"><span class="regexp">&lt;script id="vertexShader" type="x-shader/</span>x-vertex<span class="string">"&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  void main() &#123;</span></span><br><span class="line"><span class="string">    //给内置变量gl_PointSize赋值像素大小</span></span><br><span class="line"><span class="string">    gl_PointSize=20.0;</span></span><br><span class="line"><span class="string">    //顶点位置，位于坐标原点</span></span><br><span class="line"><span class="string">    gl_Position =vec4(0.0,0.0,0.0,1.0);</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;!-- 片元着色器源码 --&gt;</span></span><br><span class="line"><span class="string">&lt;script id="</span>fragmentShader<span class="string">" type="</span>x-shader/x-fragment<span class="string">"&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  void main() &#123;</span></span><br><span class="line"><span class="string">    gl_FragColor = vec4(1.0,0.0,0.0,1.0);</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;script&gt;</span></span><br><span class="line"><span class="string">    //通过getElementById()方法获取canvas画布</span></span><br><span class="line"><span class="string">    var canvas=document.getElementById('webgl');</span></span><br><span class="line"><span class="string">    //通过方法getContext()获取WebGL上下文</span></span><br><span class="line"><span class="string">    var gl=canvas.getContext('webgl');</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    //顶点着色器源码</span></span><br><span class="line"><span class="string">    var vertexShaderSource = document.getElementById( 'vertexShader' ).innerText;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    //片元着色器源码</span></span><br><span class="line"><span class="string">    var fragShaderSource = document.getElementById( 'fragmentShader' ).innerText;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    //初始化着色器</span></span><br><span class="line"><span class="string">    var program = initShader(gl,vertexShaderSource,fragShaderSource);</span></span><br><span class="line"><span class="string">    //开始绘制，显示器显示结果</span></span><br><span class="line"><span class="string">    gl.drawArrays(gl.POINTS,0,1);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    //声明初始化着色器函数</span></span><br><span class="line"><span class="string">    function initShader(gl,vertexShaderSource,fragmentShaderSource)&#123;</span></span><br><span class="line"><span class="string">        //创建顶点着色器对象</span></span><br><span class="line"><span class="string">        var vertexShader = gl.createShader(gl.VERTEX_SHADER);</span></span><br><span class="line"><span class="string">        //创建片元着色器对象</span></span><br><span class="line"><span class="string">        var fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);</span></span><br><span class="line"><span class="string">        //引入顶点、片元着色器源代码</span></span><br><span class="line"><span class="string">        gl.shaderSource(vertexShader,vertexShaderSource);</span></span><br><span class="line"><span class="string">        gl.shaderSource(fragmentShader,fragmentShaderSource);</span></span><br><span class="line"><span class="string">        //编译顶点、片元着色器</span></span><br><span class="line"><span class="string">        gl.compileShader(vertexShader);</span></span><br><span class="line"><span class="string">        gl.compileShader(fragmentShader);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        //创建程序对象program</span></span><br><span class="line"><span class="string">        var program = gl.createProgram();</span></span><br><span class="line"><span class="string">        //附着顶点着色器和片元着色器到program</span></span><br><span class="line"><span class="string">        gl.attachShader(program,vertexShader);</span></span><br><span class="line"><span class="string">        gl.attachShader(program,fragmentShader);</span></span><br><span class="line"><span class="string">        //链接program</span></span><br><span class="line"><span class="string">        gl.linkProgram(program);</span></span><br><span class="line"><span class="string">        //使用program</span></span><br><span class="line"><span class="string">        gl.useProgram(program);</span></span><br><span class="line"><span class="string">        //返回程序program对象</span></span><br><span class="line"><span class="string">        return program;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br></pre></td></tr></table></figure><h2 id="代码结构"><a href="#代码结构" class="headerlink" title="代码结构"></a>代码结构</h2><p>整个代码是一个.html文件，里面包含JavaScript代码和着色器语言代码，通过JavaScript调用WebGL API来完成绘制操作。</p><h2 id="HMTL和JavaScript"><a href="#HMTL和JavaScript" class="headerlink" title="HMTL和JavaScript"></a>HMTL和JavaScript</h2><p>如果原来接触的是OpenGL，不了解WebGL，对浏览器的生态环境不了解，不了解前端知识，那么在学习WebGL之前，你应该先了解一下什么是HTML，什么是JavaScript语言。</p><h2 id="canvas"><a href="#canvas" class="headerlink" title="canvas"></a>canvas</h2><p>canvas和div一样也是HTML的一个元素，只不过通过这个元素可实现三维场景的回执和渲染。通过canvas对象的getContext方法可以返回一个2D或3D环境</p><h2 id="canvas元素"><a href="#canvas元素" class="headerlink" title="canvas元素"></a>canvas元素</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--canvas标签创建一个宽高均为<span class="number">500</span>像素，背景为蓝色的矩形画布--&gt;</span><br><span class="line">&lt;canvas id=<span class="string">"webgl"</span> width=<span class="string">"500"</span> height=<span class="string">"500"</span> style=<span class="string">"background-color: blue"</span>&gt;&lt;/canvas&gt;</span><br></pre></td></tr></table></figure><h2 id="返回3D绘图环境"><a href="#返回3D绘图环境" class="headerlink" title="返回3D绘图环境"></a>返回3D绘图环境</h2><p>通过返回的gl对象可以调用WebGL API，所有的WebGL API就是gl对象的方法。比如gl.linkProgram()<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//通过getElementById()方法获取canvas画布</span></span><br><span class="line"><span class="keyword">var</span> canvas=<span class="built_in">document</span>.getElementById(<span class="string">'webgl'</span>);</span><br><span class="line"><span class="comment">//通过方法getContext()获取WebGL上下文</span></span><br><span class="line"><span class="keyword">var</span> gl=canvas.getContext(<span class="string">'webgl'</span>);</span><br></pre></td></tr></table></figure></p><h2 id="返回2D环境"><a href="#返回2D环境" class="headerlink" title="返回2D环境"></a>返回2D环境</h2><p>返回2D环境，就是大家平常说的canvas，通过canvas对象可以返回webgl绘图环境，也可以返回2D绘环境，不过大家在表达的时候，2D绘图环境通常表达为canvas，而canvas返回的3D环境，使用WebGL去表述。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> c=canvas.getContext(<span class="string">'2d'</span>);</span><br></pre></td></tr></table></figure></p><h2 id="着色器语言-GLSL"><a href="#着色器语言-GLSL" class="headerlink" title="着色器语言 GLSL"></a>着色器语言 GLSL</h2><p>顶点、片元着色器代码要通过着色器语言来编写，着色器语言在GPU中执行，而平时大家说的JavaScript、Python等语言都是在CPU中执行。在GPU中执行的着色器代码，需要先通过WebGL进行一定的处理然后传递到GPU才能执行，所以编写的着色器语言就是一段符合一定的规则的字符串。<br>如果你现在还不能理解着色器语言的语法规则，也没有关系，作为初学者你现在只需要有一个印象，然后慢慢去学习。</p><h2 id="顶点着色器"><a href="#顶点着色器" class="headerlink" title="顶点着色器"></a>顶点着色器</h2><p>内置变量gl_PointSize设置了顶点渲染后的显示大小，内置变量gl_Position决定了渲染的位置，你可以去修改位置变量的值，比如vec4(0.0,0.0,0.0,1.0)变成vec4(0.5,0.0,0.0,1.0)，你会发现渲染的点位置发生了变化。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 顶点着色器源码 --&gt;</span><br><span class="line">&lt;script id=<span class="string">"vertexShader"</span> type=<span class="string">"x-shader/x-vertex"</span>&gt;</span><br><span class="line">  <span class="keyword">void</span> main() &#123;</span><br><span class="line">    <span class="comment">//给内置变量gl_PointSize赋值像素大小</span></span><br><span class="line">    gl_PointSize=<span class="number">20.0</span>;</span><br><span class="line">    <span class="comment">//顶点位置，位于坐标原点</span></span><br><span class="line">    gl_Position =vec4(<span class="number">0.0</span>,<span class="number">0.0</span>,<span class="number">0.0</span>,<span class="number">1.0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure></p><h2 id="片元着色器"><a href="#片元着色器" class="headerlink" title="片元着色器"></a>片元着色器</h2><p>内置变量gl_FragColor设置渲染结果的颜色值，vec4(1.0,0.0,0.0,1.0)表示红色，如果改成vec4(0.0,1.0,0.0,1.0)，你会发现渲染结果是绿色，vec4的四个分量分别表示RGBA。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 片元着色器源码 --&gt;</span><br><span class="line">&lt;script id=<span class="string">"fragmentShader"</span> type=<span class="string">"x-shader/x-fragment"</span>&gt;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span> main() &#123;</span><br><span class="line">    gl_FragColor = vec4(<span class="number">1.0</span>,<span class="number">0.0</span>,<span class="number">0.0</span>,<span class="number">1.0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  &lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;简单的介绍一下WebGL是什么&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="javascript" scheme="/categories/javascript/"/>
    
    
      <category term="基础知识" scheme="/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
  </entry>
  
  <entry>
    <title>iscroll移动端卡顿解决办法</title>
    <link href="/2019/09/19/iscroll%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%8D%A1%E9%A1%BF%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/"/>
    <id>/2019/09/19/iscroll移动端卡顿解决办法/</id>
    <published>2019-09-19T05:36:02.000Z</published>
    <updated>2019-09-19T06:21:22.514Z</updated>
    
    <content type="html"><![CDATA[<p>解决iscroll在移动端卡顿<br><a id="more"></a></p><h1 id="iscroll移动端卡顿解决办法"><a href="#iscroll移动端卡顿解决办法" class="headerlink" title="iscroll移动端卡顿解决办法"></a>iscroll移动端卡顿解决办法</h1><p>iscroll是模拟区域滚动的一个库，很有名的，类似的还有一个库叫better-scroll，作者是中国人，好像是阿里的吧，是在iscroll的基础上开发的，很灵活，支持es6等语法导入，不过本篇博文不做介绍，我们来讨论iscroll。<br>有一个需求是页面拒不缩放并且可以滚动，正好用到了iscroll-zoom.js,但是引入后发现在pc端嗷嗷流畅，但是移动端就卡顿，后来在网上查到解决办法，但是感觉并不是好的解决办法，应该还有更好的，暂时贴出现在的解决办法，以后在陆续跟进。</p><h2 id="解决方法一"><a href="#解决方法一" class="headerlink" title="解决方法一"></a>解决方法一</h2><h3 id="1"><a href="#1" class="headerlink" title="1."></a>1.</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;style type=<span class="string">"text/css"</span>&gt;</span><br><span class="line">  * &#123; touch-action: pan-y; &#125;</span><br><span class="line">&lt;<span class="regexp">/style&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">　  <span class="built_in">window</span>.PointerEvent = <span class="literal">undefined</span>;</span><br><span class="line">　  <span class="built_in">document</span>.addEventListener(<span class="string">'touchmove'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">　　  e.preventDefault();</span><br><span class="line">　　&#125;, <span class="literal">false</span>);</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><h3 id="3"><a href="#3" class="headerlink" title="3."></a>3.</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">　  tabContentScroll = </span><br><span class="line">  <span class="keyword">new</span> IScroll(<span class="string">"#tabContentWrapper"</span>, &#123;</span><br><span class="line">      tap: <span class="literal">true</span>,</span><br><span class="line">      probeType: <span class="number">2</span>,</span><br><span class="line">      deceleration: <span class="number">0.001</span>,</span><br><span class="line">      vScrollbar: <span class="literal">false</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">　　<span class="comment">// 初始化IScroll的时候，加上vScrollbar: false，最关键这句，不加这句，完成其他几点只可以改好Chorme的问题，安卓的问题解决不了！！！</span></span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><h3 id="4"><a href="#4" class="headerlink" title="4."></a>4.</h3><p>我觉得是最主要的，比如iscroll-zoom.js文件，我是用的是v5.2.0版本，大约在290行<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> disablePointer : !utils.hasPointer,</span><br><span class="line">disableTouch : utils.hasPointer || !utils.hasTouch,</span><br><span class="line"> disableMouse : utils.hasPointer || utils.hasTouch,</span><br><span class="line"> <span class="comment">// 修改成</span></span><br><span class="line"> disablePointer : <span class="literal">true</span>,</span><br><span class="line">disableTouch : <span class="literal">false</span>,</span><br><span class="line">disableMouse : <span class="literal">true</span>,</span><br></pre></td></tr></table></figure></p><p><a href="https://github.com/cubiq/iscroll/issues/1100" target="_blank" rel="noopener">官网issus的解释</a><br><a href="https://www.cnblogs.com/KAI0725/p/11019971.html" target="_blank" rel="noopener">这个是在网络上找到的参考答案连接</a></p><h2 id="解决方法二"><a href="#解决方法二" class="headerlink" title="解决方法二"></a>解决方法二</h2><p>既然v5.2.0有bug，那我们不用这个版本的，可以用以前的老版本啊。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm info iscroll</span><br></pre></td></tr></table></figure></p><p>可以查看历史版本等信息，我下载了v5.0.8这个版本，经过测试可用了。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;解决iscroll在移动端卡顿&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="javascript" scheme="/categories/javascript/"/>
    
    
      <category term="工具库" scheme="/tags/%E5%B7%A5%E5%85%B7%E5%BA%93/"/>
    
  </entry>
  
  <entry>
    <title>Puppeteer</title>
    <link href="/2019/09/10/Puppeteer/"/>
    <id>/2019/09/10/Puppeteer/</id>
    <published>2019-09-10T06:50:51.000Z</published>
    <updated>2019-09-10T07:02:46.923Z</updated>
    
    <content type="html"><![CDATA[<p>Puppeteer工具<br><a id="more"></a></p><h1 id="Puppeteer"><a href="#Puppeteer" class="headerlink" title="Puppeteer"></a>Puppeteer</h1><p>Puppeteer是谷歌官方出品的一个通过DevTools协议控制headless Chrome的Node库。可以通过Puppeteer的提供的api直接控制Chrome模拟大部分用户操作来进行UI Test或者作为爬虫访问页面来收集数据。<br>这里不做太多的介绍，贴出官方网址链接自行查看</p><ul><li><a href="https://www.npmjs.com/package/puppeteer" target="_blank" rel="noopener">npm-puppeteer</a></li><li><a href="https://www.findbestopensource.com/product/zhaoqize-puppeteer-api-zh-cn" target="_blank" rel="noopener">findbestopensource</a></li><li><a href="https://github.com/zhaoqize/puppeteer-api-zh_CN#readme" target="_blank" rel="noopener">Puppeteer 中文文档</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Puppeteer工具&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="javascript" scheme="/categories/javascript/"/>
    
    
      <category term="工具库" scheme="/tags/%E5%B7%A5%E5%85%B7%E5%BA%93/"/>
    
  </entry>
  
  <entry>
    <title>JS中的offset、scroll、client</title>
    <link href="/2019/09/09/JS%E4%B8%AD%E7%9A%84offset%E3%80%81scroll%E3%80%81client/"/>
    <id>/2019/09/09/JS中的offset、scroll、client/</id>
    <published>2019-09-09T07:44:40.000Z</published>
    <updated>2019-09-09T07:59:40.940Z</updated>
    
    <content type="html"><![CDATA[<p>JS中的offset、scroll、client简单整理<br><a id="more"></a></p><h1 id="JS中的offset、scroll、client"><a href="#JS中的offset、scroll、client" class="headerlink" title="JS中的offset、scroll、client"></a>JS中的offset、scroll、client</h1><p>在下开发中经常碰到 offset、scroll、client 这几个关键字，比如 offsetLeft、offsetHeight、scrollHeight、clientTop 什么的，每次都要各种实验，这里总结一下，一劳永逸。<br>来两张图先：<br><img src="/2019/09/09/JS中的offset、scroll、client/1.jpg" alt="img"><br><img src="/2019/09/09/JS中的offset、scroll、client/2.jpg" alt="img"></p><h2 id="1-offset"><a href="#1-offset" class="headerlink" title="1. offset"></a>1. offset</h2><p>offset 指偏移，包括这个元素在文档中占用的所有显示宽度，包括滚动条、 padding、 border，不包括 overflow隐藏的部分。</p><ul><li>offsetParent属性返回一个对象的引用，这个对象是距离调用 offsetParent的父级元素中最近的（在包含层次中最靠近的），并且是已进行过CSS定位的容器元素。如果这个容器元素未进行CSS定位, 则 offsetParent属性的取值为根元素的引用。如果当前元素的父级元素中没有进行CSS定位（position为 absolute/relative）， offsetParent 为 body如果当前元素的父级元素中有CSS定位（ position 为 absolute/relative）， offsetParent 取父级中最近的元素</li><li>obj.offsetWidth 指 obj 控件自身的绝对宽度，不包括因 overflow 而未显示的部分，也就是其实际占据的宽度，整型，单位：像素。<br>offsetWidth = border-width*2+ padding-left+ width+ padding-right</li><li>obj.offsetHeight 指 obj 控件自身的绝对高度，不包括因 overflow 而未显示的部分，也就是其实际占据的高度，整型，单位：像素。<br>offsetHeight = border-width*2+ padding-top+ height+ padding-bottom</li><li>obj.offsetTop 指 obj 相对于版面或由 offsetParent 属性指定的父坐标的计算上侧位置，整型，单位：像素。<br>offsetTop= offsetParent的padding-top + 中间元素的offsetHeight + 当前元素的margin-top</li><li>obj.offsetLeft 指 obj 相对于版面或由 offsetParent 属性指定的父坐标的计算左侧位置，整型，单位：像素。<br>offsetLeft= offsetParent的padding-left + 中间元素的offsetWidth + 当前元素的margin-left</li></ul><h2 id="2-scroll"><a href="#2-scroll" class="headerlink" title="2. scroll"></a>2. scroll</h2><p>scroll指滚动，包括这个元素没显示出来的实际宽度，包括 padding，不包括滚动条、 border</p><ul><li>scrollHeight 获取对象的滚动高度，对象的实际高度；</li><li>scrollLeft 设置或获取位于对象左边界和窗口中目前可见内容的最左端之间的距离</li><li>scrollTop 设置或获取位于对象最顶端和窗口中可见内容的最顶端之间的距离</li><li>scrollWidth 获取对象的滚动宽度</li></ul><h2 id="3-client"><a href="#3-client" class="headerlink" title="3. client"></a>3. client</h2><p>client指元素本身的可视内容，不包括 overflow被折叠起来的部分，不包括滚动条、 border，包括 padding</p><ul><li>clientWidth 对象可见的宽度，不包括滚动条等边线，会随窗口的显示大小改变</li><li>clientHeight 对象可见的高度</li><li>clientTop、clientLeft 这两个返回的是元素周围边框的厚度，一般它的值就是0。因为滚动条不会出现在顶部或者左侧</li></ul><h2 id="最后，奉上一个demo"><a href="#最后，奉上一个demo" class="headerlink" title="最后，奉上一个demo"></a>最后，奉上一个demo</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">  &lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span><br><span class="line">  &lt;meta http-equiv=<span class="string">"X-UA-Compatible"</span> content=<span class="string">"ie=edge"</span>&gt;</span><br><span class="line">  &lt;title&gt;Document&lt;<span class="regexp">/title&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>head&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">  #parent &#123;</span><br><span class="line">    position: relative;</span><br><span class="line">    margin: <span class="number">20</span>px auto;</span><br><span class="line">    width: <span class="number">300</span>px;</span><br><span class="line">    height: <span class="number">400</span>px;</span><br><span class="line">    border: <span class="number">1</span>px solid blue;</span><br><span class="line">    overflow: auto;</span><br><span class="line">  &#125;</span><br><span class="line">  #child &#123;</span><br><span class="line">    width: <span class="number">500</span>px;</span><br><span class="line">    height: <span class="number">600</span>px;</span><br><span class="line">    margin: <span class="number">10</span>px;</span><br><span class="line">    padding: <span class="number">5</span>px;</span><br><span class="line">    background-color: blanchedalmond;</span><br><span class="line">    box-sizing: border-box;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;<span class="regexp">/style&gt;</span></span><br><span class="line"><span class="regexp">&lt;body&gt;</span></span><br><span class="line"><span class="regexp">  &lt;div id="parent"&gt;</span></span><br><span class="line"><span class="regexp">    &lt;div id="child"&gt;&lt;/</span>div&gt;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>body&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="keyword">var</span> nParent = <span class="built_in">document</span>.querySelector(<span class="string">'#parent'</span>),</span><br><span class="line">      nChild = <span class="built_in">document</span>.querySelector(<span class="string">'#child'</span>);</span><br><span class="line">  <span class="built_in">document</span>.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// offset偏移</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'父元素-&gt;'</span>, nChild.offsetParent);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'offsetWidth-&gt;'</span>, nChild.offsetWidth);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'offsetHeight-&gt;'</span>, nChild.offsetHeight);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'offsetTop-&gt;'</span>, nChild.offsetTop);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'offsetLeft-&gt;'</span>, nChild.offsetLeft);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'&lt;-------------------------&gt;'</span>);</span><br><span class="line">    <span class="comment">// scroll滚动</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'scrollHeight-&gt;'</span>, nParent.scrollHeight);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'scrollLeft-&gt;'</span>, nParent.scrollLeft);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'scrollTop-&gt;'</span>, nParent.scrollTop);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'scrollWidth-&gt;'</span>, nParent.scrollWidth);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'&lt;-------------------------&gt;'</span>);</span><br><span class="line">    <span class="comment">// client</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'clientWidth-&gt;'</span>, nChild.clientWidth);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'clientHeight-&gt;'</span>, nChild.clientHeight);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'clientTop-&gt;'</span>, nChild.clientTop);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'clientLeft-&gt;'</span>, nChild.clientLeft);</span><br><span class="line">  &#125;, <span class="literal">false</span>);</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>html&gt;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;JS中的offset、scroll、client简单整理&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="javascript" scheme="/categories/javascript/"/>
    
    
      <category term="基础知识" scheme="/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
  </entry>
  
  <entry>
    <title>一个页面loading小插件2</title>
    <link href="/2019/09/04/%E4%B8%80%E4%B8%AA%E9%A1%B5%E9%9D%A2loading%E5%B0%8F%E6%8F%92%E4%BB%B62/"/>
    <id>/2019/09/04/一个页面loading小插件2/</id>
    <published>2019-09-04T06:53:02.000Z</published>
    <updated>2019-09-04T07:36:20.238Z</updated>
    
    <content type="html"><![CDATA[<p>有多种选择的loading插件<br><a id="more"></a></p><h1 id="一个页面loading小插件2"><a href="#一个页面loading小插件2" class="headerlink" title="一个页面loading小插件2"></a>一个页面loading小插件2</h1><p>前些天写了一个loading的插件，<a href="https://jinux7.github.io/2019/08/18/一个页面loading小插件/" target="_blank" rel="noopener">点击查看</a>,今天又写了一个，优点是可以进行loading样式的选择，有12种样式。<br>先贴出loading插件代码:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @description 移动端的loading效果小插件，内置了12种loading效果</span></span><br><span class="line"><span class="comment"> * @description 使用demo：var mask = new JLoading();</span></span><br><span class="line"><span class="comment"> *                        mask.init('loader-03');</span></span><br><span class="line"><span class="comment"> *                        mask.show(); 显示</span></span><br><span class="line"><span class="comment"> *                        mask.hide(); 隐藏</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">JLoading</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.loaderStr = <span class="string">'loader-01,loader-02,loader-03,loader-04,loader-05,loader-06,loader-07,loader-08,loader-09,loader-10,loader-11,loader-12'</span></span><br><span class="line">  <span class="keyword">this</span>.type = <span class="string">''</span>;</span><br><span class="line">&#125;</span><br><span class="line">JLoading.prototype.init = <span class="function"><span class="keyword">function</span>(<span class="params">type</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">this</span>.loaderStr.split(<span class="string">','</span>).indexOf(type) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">this</span>.type = <span class="string">'loader-01'</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.type = type;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">this</span>.loadIndex = <span class="keyword">this</span>.type.slice(<span class="number">-2</span>);</span><br><span class="line">  <span class="keyword">var</span> nBody = <span class="built_in">document</span>.body,</span><br><span class="line">      nHead = <span class="built_in">document</span>.head;</span><br><span class="line">  <span class="keyword">var</span> nStyle = <span class="built_in">document</span>.createElement(<span class="string">'style'</span>), </span><br><span class="line">      nMask = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>),</span><br><span class="line">      nLoader = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line">  nMask.setAttribute(<span class="string">'id'</span>, <span class="string">'JLoading-mask-'</span>+<span class="keyword">this</span>.loadIndex);</span><br><span class="line">  nLoader.setAttribute(<span class="string">'class'</span>, <span class="keyword">this</span>.type);</span><br><span class="line">  nMask.appendChild(nLoader);</span><br><span class="line">  nBody.appendChild(nMask);</span><br><span class="line">  nStyle.innerHTML = <span class="string">`[id*="JLoading-mask"]&#123;display:none;width:100%;height:100%;height:100vh;background-color:rgba(0,0,0,.8)&#125;[class*="loader-"]&#123;position:absolute;display:inline-block;width:10%;padding-top:10%;color:#fff;vertical-align:middle;pointer-events:none;left:45%;top:45%&#125;.loader-01&#123;border:5px dotted currentcolor;border-radius:50%;-webkit-animation:1s loader-01 linear infinite;animation:1s loader-01 linear infinite&#125;@-webkit-keyframes loader-01&#123;0%&#123;-webkit-transform:rotate(0deg);transform:rotate(0deg)&#125;100%&#123;-webkit-transform:rotate(360deg);transform:rotate(360deg)&#125;&#125;@keyframes loader-01&#123;0%&#123;-webkit-transform:rotate(0deg);transform:rotate(0deg)&#125;100%&#123;-webkit-transform:rotate(360deg);transform:rotate(360deg)&#125;&#125;.loader-02&#123;border:5px solid transparent;border-left-color:currentcolor;border-right-color:currentcolor;border-radius:50%;-webkit-animation:1s loader-02 linear infinite;animation:1s loader-02 linear infinite&#125;@-webkit-keyframes loader-02&#123;0%&#123;-webkit-transform:rotate(0deg);transform:rotate(0deg)&#125;100%&#123;-webkit-transform:rotate(360deg);transform:rotate(360deg)&#125;&#125;@keyframes loader-02&#123;0%&#123;-webkit-transform:rotate(0deg);transform:rotate(0deg)&#125;100%&#123;-webkit-transform:rotate(360deg);transform:rotate(360deg)&#125;&#125;.loader-03&#123;border:2px solid currentcolor;border-bottom-color:transparent;border-radius:50%;-webkit-animation:1s loader-03 linear infinite;animation:1s loader-03 linear infinite;position:relative&#125;@-webkit-keyframes loader-03&#123;0%&#123;-webkit-transform:rotate(0deg);transform:rotate(0deg)&#125;100%&#123;-webkit-transform:rotate(360deg);transform:rotate(360deg)&#125;&#125;@keyframes loader-03&#123;0%&#123;-webkit-transform:rotate(0deg);transform:rotate(0deg)&#125;100%&#123;-webkit-transform:rotate(360deg);transform:rotate(360deg)&#125;&#125;.loader-04&#123;border:1px solid currentcolor;border-radius:50%;-webkit-animation:1s loader-04 linear infinite;animation:1s loader-04 linear infinite;position:relative&#125;.loader-04:before&#123;content:'';display:block;width:0;height:0;position:absolute;top:-3px;left:50%;border:3px solid currentcolor;border-radius:50%&#125;@-webkit-keyframes loader-04&#123;0%&#123;-webkit-transform:rotate(0deg);transform:rotate(0deg)&#125;100%&#123;-webkit-transform:rotate(360deg);transform:rotate(360deg)&#125;&#125;@keyframes loader-04&#123;0%&#123;-webkit-transform:rotate(0deg);transform:rotate(0deg)&#125;100%&#123;-webkit-transform:rotate(360deg);transform:rotate(360deg)&#125;&#125;.loader-05&#123;border:5px solid transparent;border-top-color:currentcolor;border-radius:50%;-webkit-animation:1s loader-05 linear infinite;animation:1s loader-05 linear infinite;position:relative&#125;.loader-05:before&#123;content:'';display:block;width:inherit;height:inherit;position:absolute;top:-5px;left:-5px;border:5px solid currentcolor;border-radius:50%;opacity:.5;width:100%;padding-top:100%&#125;@-webkit-keyframes loader-05&#123;0%&#123;-webkit-transform:rotate(0deg);transform:rotate(0deg)&#125;100%&#123;-webkit-transform:rotate(360deg);transform:rotate(360deg)&#125;&#125;@keyframes loader-05&#123;0%&#123;-webkit-transform:rotate(0deg);transform:rotate(0deg)&#125;100%&#123;-webkit-transform:rotate(360deg);transform:rotate(360deg)&#125;&#125;.loader-06&#123;border:5px solid currentcolor;border-radius:50%;-webkit-animation:loader-06 1s ease-out infinite;animation:loader-06 1s ease-out infinite&#125;@-webkit-keyframes loader-06&#123;0%&#123;-webkit-transform:scale(0);transform:scale(0);opacity:0&#125;50%&#123;opacity:1&#125;100%&#123;-webkit-transform:scale(1);transform:scale(1);opacity:0&#125;&#125;@keyframes loader-06&#123;0%&#123;-webkit-transform:scale(0);transform:scale(0);opacity:0&#125;50%&#123;opacity:1&#125;100%&#123;-webkit-transform:scale(1);transform:scale(1);opacity:0&#125;&#125;.loader-07&#123;border:0 solid transparent;border-radius:50%;position:relative&#125;.loader-07:before,.loader-07:after&#123;content:'';border:5px solid currentcolor;border-radius:50%;width:inherit;height:inherit;position:absolute;top:0;left:0;-webkit-animation:loader-07 1s linear infinite;animation:loader-07 1s linear infinite;opacity:0;width:100%;height:100%&#125;.loader-07:before&#123;-webkit-animation-delay:1s;animation-delay:1s&#125;.loader-07:after&#123;-webkit-animation-delay:.5s;animation-delay:.5s&#125;@-webkit-keyframes loader-07&#123;0%&#123;-webkit-transform:scale(0);transform:scale(0);opacity:0&#125;50%&#123;opacity:1&#125;100%&#123;-webkit-transform:scale(1);transform:scale(1);opacity:0&#125;&#125;@keyframes loader-07&#123;0%&#123;-webkit-transform:scale(0);transform:scale(0);opacity:0&#125;50%&#123;opacity:1&#125;100%&#123;-webkit-transform:scale(1);transform:scale(1);opacity:0&#125;&#125;.loader-08&#123;position:relative&#125;.loader-08:before,.loader-08:after&#123;content:'';width:inherit;height:inherit;border-radius:50%;background-color:currentcolor;opacity:.6;position:absolute;top:0;left:0;-webkit-animation:loader-08 2.0s infinite ease-in-out;animation:loader-08 2.0s infinite ease-in-out;width:100%;height:100%&#125;.loader-08:after&#123;-webkit-animation-delay:-1.0s;animation-delay:-1.0s&#125;@-webkit-keyframes loader-08&#123;0%,100%&#123;-webkit-transform:scale(0);transform:scale(0)&#125;50%&#123;-webkit-transform:scale(1);transform:scale(1)&#125;&#125;@keyframes loader-08&#123;0%,100%&#123;-webkit-transform:scale(0);transform:scale(0)&#125;50%&#123;-webkit-transform:scale(1);transform:scale(1)&#125;</span></span><br><span class="line"><span class="string">    &#125;.loader-09&#123;background-color:currentcolor;border-radius:50%;-webkit-animation:loader-09 1.0s infinite ease-in-out;animation:loader-09 1.0s infinite ease-in-out&#125;@-webkit-keyframes loader-09&#123;0%&#123;-webkit-transform:scale(0);transform:scale(0)&#125;100%&#123;-webkit-transform:scale(1);transform:scale(1);opacity:0&#125;&#125;@keyframes loader-09&#123;0%&#123;-webkit-transform:scale(0);transform:scale(0)&#125;100%&#123;-webkit-transform:scale(1);transform:scale(1);opacity:0&#125;&#125;.loader-10&#123;position:relative;-webkit-animation:loader-10-1 2.0s infinite linear;animation:loader-10-1 2.0s infinite linear&#125;.loader-10:before,.loader-10:after&#123;content:'';width:0!important;height:0!important;border:15px solid currentcolor;display:block;position:absolute;border-radius:100%;-webkit-animation:loader-10-2 2s infinite ease-in-out;animation:loader-10-2 2s infinite ease-in-out&#125;.loader-10:before&#123;top:0;left:50%&#125;.loader-10:after&#123;bottom:0;right:50%;-webkit-animation-delay:-1s;animation-delay:-1s&#125;@-webkit-keyframes loader-10-1&#123;100%&#123;-webkit-transform:rotate(360deg);transform:rotate(360deg)&#125;&#125;@keyframes loader-10-1&#123;100%&#123;-webkit-transform:rotate(360deg);transform:rotate(360deg)&#125;&#125;@-webkit-keyframes loader-10-2&#123;0%,100%&#123;-webkit-transform:scale(0);transform:scale(0)&#125;50%&#123;-webkit-transform:scale(1);transform:scale(1)&#125;&#125;@keyframes loader-10-2&#123;0%,100%&#123;-webkit-transform:scale(0);transform:scale(0)&#125;50%&#123;-webkit-transform:scale(1);transform:scale(1)&#125;&#125;.loader-11&#123;background-color:currentcolor;-webkit-animation:loader-11 1.2s infinite ease-in-out;animation:loader-11 1.2s infinite ease-in-out&#125;@-webkit-keyframes loader-11&#123;0%&#123;-webkit-transform:perspective(120px) rotateX(0deg) rotateY(0deg);transform:perspective(120px) rotateX(0deg) rotateY(0deg)&#125;50%&#123;-webkit-transform:perspective(120px) rotateX(-180.1deg) rotateY(0deg);transform:perspective(120px) rotateX(-180.1deg) rotateY(0deg)&#125;100%&#123;-webkit-transform:perspective(120px) rotateX(-180deg) rotateY(-179.9deg);transform:perspective(120px) rotateX(-180deg) rotateY(-179.9deg)&#125;&#125;@keyframes loader-11&#123;0%&#123;-webkit-transform:perspective(120px) rotateX(0deg) rotateY(0deg);transform:perspective(120px) rotateX(0deg) rotateY(0deg)&#125;50%&#123;-webkit-transform:perspective(120px) rotateX(-180.1deg) rotateY(0deg);transform:perspective(120px) rotateX(-180.1deg) rotateY(0deg)&#125;100%&#123;-webkit-transform:perspective(120px) rotateX(-180deg) rotateY(-179.9deg);transform:perspective(120px) rotateX(-180deg) rotateY(-179.9deg)&#125;&#125;.loader-12&#123;position:relative&#125;.loader-12:before,.loader-12:after&#123;content:'';display:block;position:absolute;background-color:currentcolor;left:50%;right:0;top:0;bottom:50%;box-shadow:-.5em 0 0 currentcolor;-webkit-animation:loader-12 1s linear infinite;animation:loader-12 1s linear infinite&#125;.loader-12:after&#123;top:50%;bottom:0;-webkit-animation-delay:.25s;animation-delay:.25s&#125;@-webkit-keyframes loader-12&#123;0%,100%&#123;box-shadow:-20px 0 0 transparent;background-color:currentcolor&#125;50%&#123;box-shadow:-20px 0 0 currentcolor;background-color:transparent&#125;&#125;@keyframes loader-12&#123;0%,100%&#123;box-shadow:-20px 0 0 transparent;background-color:currentcolor&#125;50%&#123;box-shadow:-20px 0 0 currentcolor;background-color:transparent&#125;&#125;`</span>;</span><br><span class="line">  nHead.appendChild(nStyle);   </span><br><span class="line">&#125;</span><br><span class="line">JLoading.prototype.show = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> nMask = <span class="built_in">document</span>.getElementById(<span class="string">'JLoading-mask-'</span>+<span class="keyword">this</span>.loadIndex);</span><br><span class="line">  nMask.style.display = <span class="string">'block'</span>;</span><br><span class="line">&#125;</span><br><span class="line">JLoading.prototype.hide = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> nMask = <span class="built_in">document</span>.getElementById(<span class="string">'JLoading-mask-'</span>+<span class="keyword">this</span>.loadIndex);</span><br><span class="line">  nMask.style.display = <span class="string">'none'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>使用见下面代码:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">  &lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span><br><span class="line">  &lt;meta http-equiv=<span class="string">"X-UA-Compatible"</span> content=<span class="string">"ie=edge"</span>&gt;</span><br><span class="line">  &lt;title&gt;<span class="xml"><span class="tag">&lt;<span class="name">loading-test</span>&gt;</span><span class="tag">&lt;/<span class="name">loading-test</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line">  &lt;script src=<span class="string">"./loading-plug.js"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">&lt;<span class="regexp">/head&gt;</span></span><br><span class="line"><span class="regexp">&lt;body&gt;</span></span><br><span class="line"><span class="regexp">  &lt;script&gt;</span></span><br><span class="line"><span class="regexp">    var mask1 = new JLoading();</span></span><br><span class="line"><span class="regexp">    mask1.init('loader-12');</span></span><br><span class="line"><span class="regexp">    setTimeout(() =&gt; &#123;</span></span><br><span class="line"><span class="regexp">        mask1.show();</span></span><br><span class="line"><span class="regexp">    &#125;, 1000);</span></span><br><span class="line"><span class="regexp">    setTimeout(() =&gt; &#123;</span></span><br><span class="line"><span class="regexp">        mask1.hide();</span></span><br><span class="line"><span class="regexp">    &#125;, 3000);</span></span><br><span class="line"><span class="regexp">  &lt;/</span>script&gt;</span><br><span class="line">&lt;<span class="regexp">/body&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>html&gt;</span><br></pre></td></tr></table></figure></p><p>使用不同的样式，需要在mask1.init(‘loader-12’)方法中传入名字，比如’loader-02’,具体的样式名字见下图:<br><img src="/2019/09/04/一个页面loading小插件2/1.png" alt="img"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;有多种选择的loading插件&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="javascript" scheme="/categories/javascript/"/>
    
    
      <category term="移动端" scheme="/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>window下flutter环境搭建</title>
    <link href="/2019/08/26/window%E4%B8%8Bflutter%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
    <id>/2019/08/26/window下flutter环境搭建/</id>
    <published>2019-08-26T01:26:38.000Z</published>
    <updated>2019-08-26T02:11:45.203Z</updated>
    
    <content type="html"><![CDATA[<p>flutter在window 10下的环境搭建<br><a id="more"></a></p><h1 id="window下flutter环境搭建"><a href="#window下flutter环境搭建" class="headerlink" title="window下flutter环境搭建"></a>window下flutter环境搭建</h1><p>flutter是google出的一个跨平台移动端app开发框架，据说性能已经超过了原生开发，作为一名前端，即使不深入研究，也得浅浅的看一下这是个什么东西吧，所以今天记录一下flutter在win10下的安装步骤。</p><h2 id="1-安装flutter"><a href="#1-安装flutter" class="headerlink" title="1.安装flutter"></a>1.安装flutter</h2><p>去flutter官网下载flutter的压缩包，<a href="https://flutterchina.club/setup-windows/" target="_blank" rel="noopener">flutter官网地址</a>,将压缩包解压到一个目录下，之后配置一下环境变量（这里不细说了，就是把bin目录配到系统的环境变量下），之后开启终端，运行flutter，第一次运行flutter需要去网络拉取资源，所以电脑必须得安装好了git，再有一点，由于防火墙的原因，拉取国外资源有时候不成功，所以在运行flutter之前最好配一下资源镜像路径：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export PUB_HOSTED_URL=https://pub.flutter-io.cn</span><br><span class="line">export FLUTTER_STORAGE_BASE_URL=https://storage.flutter-io.cn</span><br></pre></td></tr></table></figure></p><p>这两句话最好在git bash下执行哦，之后就可以运行flutter初始化了。</p><ul><li>这里注意一下，最好选择flutter的最新版本安装，因为下一步会安装android sdk，android会自动下载最新版本的，所以为了兼容，我在有的电脑中安装的flutter不是最新版本，andriod是最新的，出现了无法run的问题。</li></ul><h2 id="2-安装JDK"><a href="#2-安装JDK" class="headerlink" title="2.安装JDK"></a>2.安装JDK</h2><p>由于是android开发，所以java的sdk是必不可少的，去<a href="https://www.oracle.com/technetwork/java/javase/downloads/index.html" target="_blank" rel="noopener">java sdk</a>下载，注意，一定要下载java SE 8u***版本的，其他版本不兼容，下载之后安装即可。</p><h2 id="3-安装vs-code以及flutter插件。"><a href="#3-安装vs-code以及flutter插件。" class="headerlink" title="3.安装vs code以及flutter插件。"></a>3.安装vs code以及flutter插件。</h2><h2 id="4-安装android-studio"><a href="#4-安装android-studio" class="headerlink" title="4.安装android studio"></a>4.安装android studio</h2><p><a href="https://developer.android.google.cn/studio" target="_blank" rel="noopener">下载链接</a>,下载好之后，一路下一步就可以，第一次安装需要下载android sdk，会下载很长时间，不过虽然有墙的存在，但是依然可以安装成功,如果不成功就多试几次。安装好了sdk后，软件就会自动打开，来到首页，也就是新建项目的地方，这时候可以安装android studio的flutter插件，第一次打开安装插件面板的时候会一直loading，最开始我还以为是墙的原因呢，不要着急，慢慢的等待即可。安装好了flutter插件后重启ide，重启后新建一个flutter项目，建好之后我们创建android虚拟机，点击tools-&gt;avd manager,创建一个虚拟机。创建虚拟机需要安装android的系统，非常的慢，慢慢等待吧。</p><ul><li>有的电脑安装模拟器的时候会报HAXM的安装不上错误，这是因为win10默认开启了Hyer-V微软的虚拟机，只需到服务里把它关掉即可。</li></ul><h2 id="5-以上完成之后，打开命令行，运行flutter-doctor-会有一段"><a href="#5-以上完成之后，打开命令行，运行flutter-doctor-会有一段" class="headerlink" title="5.以上完成之后，打开命令行，运行flutter doctor,会有一段"></a>5.以上完成之后，打开命令行，运行flutter doctor,会有一段</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Android toolchain - develop for Android devices (Android SDK version 29.0.2)</span><br><span class="line">   X Android licenses not accepted.  To resolve this, run: flutter doctor --android-licenses</span><br></pre></td></tr></table></figure><p>的提示，直接运行flutter doctor –android-licenses，一路y就可以。</p><p>如果顺利的话，现在就可以运行你的flutter项目了，我在自己的电脑上安装的很顺利，但是在公司的电脑上安装的很是肯可啊。</p><ul><li>还需要注意下，有的电脑会让你升级android sdk，命令行会提示你具体的路径，里边是一个.bat的文件，不用担心，.bat和.exe一样的，在cmd下一样可以在后边传参数。如果你运行的是powerShell，注意一下，执行命令需要这样<code>./manager.bat</code>。再有，升级可能会删除tools文件夹再下载，不过win10不允许程序随意删除文件，这时候需要手动删除一下（改个名字更好）。</li></ul><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>以上就是我在搭建flutter环境的时候遇到的一些状况。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;flutter在window 10下的环境搭建&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="javascript" scheme="/categories/javascript/"/>
    
    
      <category term="移动端" scheme="/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>nw.js入门小结</title>
    <link href="/2019/08/22/nw-js%E5%85%A5%E9%97%A8%E5%B0%8F%E7%BB%93/"/>
    <id>/2019/08/22/nw-js入门小结/</id>
    <published>2019-08-22T08:17:18.000Z</published>
    <updated>2019-08-23T01:21:03.007Z</updated>
    
    <content type="html"><![CDATA[<p>nw.js方便简单的pc端app开发工具<br><a id="more"></a></p><h1 id="nw-js入门小结"><a href="#nw-js入门小结" class="headerlink" title="nw.js入门小结"></a>nw.js入门小结</h1><p>nw.js和electron都是利用html来开发pc端应用的工具，今天我写一写nw.js的入门知识。</p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>首先，去官网下载nw，<a href="https://nwjs.io" target="_blank" rel="noopener">官网地址</a>,首页就可以看到下载地址，有两个下载，一个是normal,一个是sdk，见下图：<br><img src="/2019/08/22/nw-js入门小结/1.png" alt="img"><br>sdk是有调试功能的，生成的应用，在上面点击右键可以看到类似浏览器F12的调试面板。<br>normal就是没有调试功能的包，用于生产发布的时候用。<br>下载后不需要安装，直接解压后就可以使用。</p><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>在nw的sdk包解压后的文件中，新建一个app文件夹，在app文件夹中放一个index.html的页面，再建一个package.json的文件，内容是：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="string">"fullscreen"</span>: <span class="literal">true</span>,</span><br><span class="line"><span class="string">"main"</span>: <span class="string">"index.html"</span>,</span><br><span class="line"><span class="string">"name"</span>: <span class="string">"layout"</span>,</span><br><span class="line"><span class="string">"description"</span>: <span class="string">"nw学习"</span>,</span><br><span class="line"><span class="string">"version"</span>: <span class="string">"0.1.0"</span>,</span><br><span class="line"><span class="string">"keywords"</span>: [  <span class="string">"指令学习"</span>, <span class="string">"在线"</span>],</span><br><span class="line"><span class="string">"window"</span>: &#123;</span><br><span class="line"><span class="string">"title"</span>: <span class="string">"指令学习"</span>,</span><br><span class="line"><span class="string">"icon"</span>: <span class="string">"icon.png"</span>,</span><br><span class="line"><span class="string">"toolbar"</span>: <span class="literal">true</span>,</span><br><span class="line"><span class="string">"frame"</span>: <span class="literal">false</span>,</span><br><span class="line"><span class="string">"width"</span>: <span class="number">375</span>,</span><br><span class="line"><span class="string">"height"</span>: <span class="number">750</span>,</span><br><span class="line"><span class="string">"position"</span>: <span class="string">"center"</span>,</span><br><span class="line"><span class="string">"min_width"</span>: <span class="number">375</span>,</span><br><span class="line"><span class="string">"min_height"</span>: <span class="number">750</span>,</span><br><span class="line"><span class="string">"max_width"</span>: <span class="number">1920</span>,</span><br><span class="line"><span class="string">"max_height"</span>: <span class="number">1080</span>,</span><br><span class="line"><span class="string">"resizable"</span>: <span class="literal">true</span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="string">"webkit"</span>: &#123;</span><br><span class="line"><span class="string">"plugin"</span>: <span class="literal">false</span>,</span><br><span class="line"><span class="string">"java"</span>: <span class="literal">false</span>,</span><br><span class="line"><span class="string">"page-cache"</span>: <span class="literal">false</span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="string">"user-agent"</span>: <span class="string">"%name %ver %nwver %webkit_ver %osinfo"</span>,</span><br><span class="line"><span class="string">"chromium-args"</span>: <span class="string">"--allow-file-access-from-files"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// main属性是关键，指的是入口文件的位置</span></span><br></pre></td></tr></table></figure></p><p>准备工作完毕，目录结构见下图：<br><img src="/2019/08/22/nw-js入门小结/2.png" alt="img"><br>将app文件夹拖拽到nw.exe上即可打开应用进行开发调试。</p><h2 id="打包发布"><a href="#打包发布" class="headerlink" title="打包发布"></a>打包发布</h2><p>如果开发完了之后，给别人用，就需要进行打包了。<br>首先将app文件夹压缩，比如压缩成app.zip文件，之后改名为app.nw文件。<br>打包需要在命令行下进行，打开cmd命令行（注意，这里只能用cmd，gitBash和powerShell都不好使哦），切换到当前目录，执行下面的命令:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">copy /b nw.exe+app.nw app.exe</span><br></pre></td></tr></table></figure></p><p><img src="/2019/08/22/nw-js入门小结/3.png" alt="img"><br>可以看到，app.exe就是打包出来的可执行文件，这时候直接点击它就可以运行程序了。</p><ul><li>把这个app.exe文件复制到normal的运行文件夹下，也可以点击运行，这时其实就是一个绿色版的应用程序了，完全可以交付给客户使用了。</li><li>如果感觉一堆文件看起来不舒服，还可以使用enigmavirtualbox工具进行打包成一个.exe的文件，不过这个文件一般都比较大哦。</li><li>最后一种方法，innosetup工具，可以制作成安装版本，这样体积就小了。</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;nw.js方便简单的pc端app开发工具&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="javascript" scheme="/categories/javascript/"/>
    
    
      <category term="工具库" scheme="/tags/%E5%B7%A5%E5%85%B7%E5%BA%93/"/>
    
  </entry>
  
  <entry>
    <title>前端静态资源服务器都用到了啥？</title>
    <link href="/2019/08/22/%E5%89%8D%E7%AB%AF%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%BD%E7%94%A8%E5%88%B0%E4%BA%86%E5%95%A5%EF%BC%9F/"/>
    <id>/2019/08/22/前端静态资源服务器都用到了啥？/</id>
    <published>2019-08-22T06:45:46.000Z</published>
    <updated>2019-08-22T07:03:14.115Z</updated>
    
    <content type="html"><![CDATA[<p>前端都用到了哪些技术实现静态资源服务器<br><a id="more"></a></p><h1 id="前端静态资源服务器都用到了啥？"><a href="#前端静态资源服务器都用到了啥？" class="headerlink" title="前端静态资源服务器都用到了啥？"></a>前端静态资源服务器都用到了啥？</h1><p>平时我们在开发的时候，肯定会自己架一个服务，把网页放进去，再跑，那么，我们平时都用到了哪些手段来实现呢？</p><h2 id="http-server"><a href="#http-server" class="headerlink" title="http-server"></a>http-server</h2><p><a href="https://www.npmjs.com/package/http-server" target="_blank" rel="noopener">官网</a>,使用起来很方便。</p><h2 id="browser-sync"><a href="#browser-sync" class="headerlink" title="browser-sync"></a>browser-sync</h2><p><a href="http://www.browsersync.cn" target="_blank" rel="noopener">官网</a>,功能非常之强大。</p><h2 id="nginx"><a href="#nginx" class="headerlink" title="nginx"></a>nginx</h2><p><a href="http://nginx.org/en/download.html" target="_blank" rel="noopener">官网下载</a>,nginx可是现在静态资源服务器中响应速度最快的了，如果在生产环境下，还是使用nginx吧。</p><h2 id="apache"><a href="#apache" class="headerlink" title="apache"></a>apache</h2><p>nginx出来之前大家都用，现在基本上没人用了，淘汰掉。</p><h2 id="webpack-dev"><a href="#webpack-dev" class="headerlink" title="webpack-dev"></a>webpack-dev</h2><p>这个其实是webpack的一个插件，我们在开发react，vue，angular的时候会用到它。</p><h2 id="express-amp-koa"><a href="#express-amp-koa" class="headerlink" title="express&amp;koa"></a>express&amp;koa</h2><p>express和koa中都有静态资源的中间件，用起来就是麻烦些。</p><h2 id="nodejs"><a href="#nodejs" class="headerlink" title="nodejs"></a>nodejs</h2><p>最后就是可以利用nodejs的http模块手写一个静态资源服务器。 </p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;前端都用到了哪些技术实现静态资源服务器&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="javascript" scheme="/categories/javascript/"/>
    
    
      <category term="网络基础" scheme="/tags/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/"/>
    
  </entry>
  
  <entry>
    <title>移动端设置root font-size代码</title>
    <link href="/2019/08/18/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E8%AE%BE%E7%BD%AEroot-font-size%E4%BB%A3%E7%A0%81/"/>
    <id>/2019/08/18/移动端设置root-font-size代码/</id>
    <published>2019-08-18T05:16:50.000Z</published>
    <updated>2019-08-18T05:19:07.887Z</updated>
    
    <content type="html"><![CDATA[<p>移动端设置html元素的font-size代码，方便使用rem<br><a id="more"></a></p><h1 id="移动端设置root-font-size代码"><a href="#移动端设置root-font-size代码" class="headerlink" title="移动端设置root font-size代码"></a>移动端设置root font-size代码</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">doc, win</span>) </span>&#123;</span><br><span class="line"><span class="keyword">var</span> docEl = doc.documentElement,</span><br><span class="line">resizeEvt = <span class="string">'orientationchange'</span> <span class="keyword">in</span> <span class="built_in">window</span> ? <span class="string">'orientationchange'</span> : <span class="string">'resize'</span>,</span><br><span class="line">recalc = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> clientWidth = docEl.clientWidth;</span><br><span class="line">  <span class="keyword">if</span> (!clientWidth) <span class="keyword">return</span>;</span><br><span class="line">  docEl.style.fontSize = clientWidth/<span class="number">20</span> + <span class="string">'px'</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">if</span> (!doc.addEventListener) <span class="keyword">return</span>;</span><br><span class="line">win.addEventListener(resizeEvt, recalc, <span class="literal">false</span>);</span><br><span class="line">doc.addEventListener(<span class="string">'DOMContentLoaded'</span>, recalc, <span class="literal">false</span>);</span><br><span class="line">&#125;)(<span class="built_in">document</span>, <span class="built_in">window</span>);</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;移动端设置html元素的font-size代码，方便使用rem&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="javascript" scheme="/categories/javascript/"/>
    
    
      <category term="移动端" scheme="/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>一个页面loading小插件</title>
    <link href="/2019/08/18/%E4%B8%80%E4%B8%AA%E9%A1%B5%E9%9D%A2loading%E5%B0%8F%E6%8F%92%E4%BB%B6/"/>
    <id>/2019/08/18/一个页面loading小插件/</id>
    <published>2019-08-18T04:44:28.000Z</published>
    <updated>2019-08-18T05:10:53.959Z</updated>
    
    <content type="html"><![CDATA[<p>移动端的loading小插件<br><a id="more"></a></p><h1 id="一个页面loading小插件"><a href="#一个页面loading小插件" class="headerlink" title="一个页面loading小插件"></a>一个页面loading小插件</h1><p>这是一个移动端的loading蒙版，细节不说了，为了以后备用，直接上代码了。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @description 一个页面加载的loading小插件</span></span><br><span class="line"><span class="comment"> * @description 注意，引用的时候一定要放到html文档的最后，因为需要向body插入内容，这里没有使用document的DOMContentLoaded，和window的loaded也是为了loading效果能够最快速的显示。</span></span><br><span class="line"><span class="comment"> * @description 这里css用到了rem，需要注意。</span></span><br><span class="line"><span class="comment"> * @method window.showLoadingEarth() 显示</span></span><br><span class="line"><span class="comment"> * @method window.hideLoadingEarth() 隐藏</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">win</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">window</span>.showLoadingEarth = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    nDiv.style.display = <span class="string">'block'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">window</span>.hideLoadingEarth = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    nDiv.style.display = <span class="string">'none'</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> templateStr = <span class="string">`&lt;div class="loading-inner"&gt;</span></span><br><span class="line"><span class="string">                        &lt;span class="dong"&gt;&lt;/span&gt;</span></span><br><span class="line"><span class="string">                        &lt;strong class="dong"&gt;&lt;/strong&gt;</span></span><br><span class="line"><span class="string">                        &lt;em&gt;&lt;/em&gt;</span></span><br><span class="line"><span class="string">                      &lt;/div&gt;`</span>;</span><br><span class="line">  <span class="keyword">var</span> cssStr = <span class="string">`#loading-earth &#123;</span></span><br><span class="line"><span class="string">                  display: none;</span></span><br><span class="line"><span class="string">                  position: absolute;</span></span><br><span class="line"><span class="string">                  width: 100%;</span></span><br><span class="line"><span class="string">                  height: 100%;</span></span><br><span class="line"><span class="string">                  top: 0;</span></span><br><span class="line"><span class="string">                  left: 0;</span></span><br><span class="line"><span class="string">                  background-color: rgba(0,0,0,.8);</span></span><br><span class="line"><span class="string">                  z-index: 999;</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">                #loading-earth .loading-inner &#123;</span></span><br><span class="line"><span class="string">                  width: 4rem;</span></span><br><span class="line"><span class="string">                  height: 4rem;</span></span><br><span class="line"><span class="string">                  /* background-color: #ffffff; */</span></span><br><span class="line"><span class="string">                  position: absolute;</span></span><br><span class="line"><span class="string">                  top: 50%;</span></span><br><span class="line"><span class="string">                  left: 50%;</span></span><br><span class="line"><span class="string">                  transform: translate(-50%,-50%);</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">                #loading-earth .loading-inner span &#123;</span></span><br><span class="line"><span class="string">                  display: inline-block;</span></span><br><span class="line"><span class="string">                  width: 3.6rem;</span></span><br><span class="line"><span class="string">                  height: 3.6rem;</span></span><br><span class="line"><span class="string">                  background-image: url('data:image/png;base64,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');</span></span><br><span class="line"><span class="string">                  background-size: 100% 100%;</span></span><br><span class="line"><span class="string">                  position: absolute;</span></span><br><span class="line"><span class="string">                  top: 0.2rem;</span></span><br><span class="line"><span class="string">                  left: 0.2rem;</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">                #loading-earth .loading-inner strong &#123;</span></span><br><span class="line"><span class="string">                  display: inline-block;</span></span><br><span class="line"><span class="string">                  width: 4.4rem;</span></span><br><span class="line"><span class="string">                  height: 4.4rem;</span></span><br><span class="line"><span class="string">                  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOwAAADsCAYAAAB300oUAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MUIwQTYzQUE3QzY1MTFFOUI2MTBCNUY1MUM1NkE0N0IiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MUIwQTYzQTk3QzY1MTFFOUI2MTBCNUY1MUM1NkE0N0IiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OTNDMUY2RDY2OTc3MTFFOUExOEY4RENGRjlFNzIwMzEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OTNDMUY2RDc2OTc3MTFFOUExOEY4RENGRjlFNzIwMzEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz51xfIrAAAF60lEQVR42uzd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');</span></span><br><span class="line"><span class="string">                  background-size: 100% 100%;</span></span><br><span class="line"><span class="string">                  position: absolute;</span></span><br><span class="line"><span class="string">                  top: -0.2rem;</span></span><br><span class="line"><span class="string">                  left: -0.2rem;</span></span><br><span class="line"><span class="string">                  /* transform: rotateZ(10deg); */</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">                #loading-earth .loading-inner em &#123;</span></span><br><span class="line"><span class="string">                  display: inline-block;</span></span><br><span class="line"><span class="string">                  width: 2.4rem;</span></span><br><span class="line"><span class="string">                  height: 2.4rem;</span></span><br><span class="line"><span class="string">                  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHEAAABxCAYAAADifkzQAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDEzMkZFRjg3QzY1MTFFOUExOTVEOEFCMTlCNUY3NjUiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDEzMkZFRjc3QzY1MTFFOUExOTVEOEFCMTlCNUY3NjUiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QkNCNTcyQTZGRjc1MTFFODhDMkFBOUYyRUM3RDc4QTYiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QkNCNTcyQTdGRjc1MTFFODhDMkFBOUYyRUM3RDc4QTYiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6mADWiAAAVBklEQVR42uxd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');</span></span><br><span class="line"><span class="string">                  background-size: 100% 100%;</span></span><br><span class="line"><span class="string">                  position: absolute;</span></span><br><span class="line"><span class="string">                  top: 0.8rem;</span></span><br><span class="line"><span class="string">                  left: 0.8rem;</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">                #loading-earth .dong&#123;</span></span><br><span class="line"><span class="string">                  -webkit-animation:animations 2s linear infinite ;</span></span><br><span class="line"><span class="string">                  -moz-animation:animations 2s linear infinite ;</span></span><br><span class="line"><span class="string">                  -o-animation:animations 2s linear infinite ;</span></span><br><span class="line"><span class="string">                  -ms-animation:animations 2s linear infinite ;</span></span><br><span class="line"><span class="string">                  animation:animations 2s linear infinite ;</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">                @-webkit-keyframes animations&#123;</span></span><br><span class="line"><span class="string">                  0%&#123;-webkit-transform:rotateZ(0deg)&#125;</span></span><br><span class="line"><span class="string">                  10%&#123;-webkit-transform:rotateZ(36deg)&#125;</span></span><br><span class="line"><span class="string">                  20%&#123;-webkit-transform:rotateZ(72deg)&#125;</span></span><br><span class="line"><span class="string">                  30%&#123;-webkit-transform:rotateZ(108deg)&#125;</span></span><br><span class="line"><span class="string">                  40%&#123;-webkit-transform:rotateZ(144eg)&#125;</span></span><br><span class="line"><span class="string">                  50%&#123;-webkit-transform:rotateZ(180deg)&#125;</span></span><br><span class="line"><span class="string">                  60%&#123;-webkit-transform:rotateZ(216deg)&#125;</span></span><br><span class="line"><span class="string">                  70%&#123;-webkit-transform:rotateZ(252deg)&#125;</span></span><br><span class="line"><span class="string">                  80%&#123;-webkit-transform:rotateZ(288deg)&#125;</span></span><br><span class="line"><span class="string">                  90%&#123;-webkit-transform:rotateZ(324deg)&#125;</span></span><br><span class="line"><span class="string">                  100%&#123;-webkit-transform:rotateZ(360deg)&#125;</span></span><br><span class="line"><span class="string">                &#125;`</span></span><br><span class="line">  <span class="comment">// 创建div和style节点</span></span><br><span class="line">  <span class="keyword">var</span> nDiv = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>),</span><br><span class="line">      nStyle = <span class="built_in">document</span>.createElement(<span class="string">'style'</span>);</span><br><span class="line">  <span class="comment">// 给div和style添加模板内容</span></span><br><span class="line">  nDiv.setAttribute(<span class="string">'id'</span>, <span class="string">'loading-earth'</span>);</span><br><span class="line">  nDiv.innerHTML = templateStr;</span><br><span class="line">  nStyle.setAttribute(<span class="string">'type'</span>, <span class="string">'text/css'</span>);</span><br><span class="line">  nStyle.innerHTML = cssStr;</span><br><span class="line">  <span class="comment">// 获取head， body节点元素</span></span><br><span class="line">  <span class="keyword">var</span> nBody = <span class="built_in">document</span>.body,</span><br><span class="line">      nHead = <span class="built_in">document</span>.head;</span><br><span class="line">  <span class="comment">// 添加这两个节点元素</span></span><br><span class="line">  nHead.appendChild(nStyle);</span><br><span class="line">  nBody.appendChild(nDiv);</span><br><span class="line">&#125;)(<span class="built_in">window</span>)</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;移动端的loading小插件&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="javascript" scheme="/categories/javascript/"/>
    
    
      <category term="移动端" scheme="/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>js中的valueOf和toString</title>
    <link href="/2019/08/02/js%E4%B8%AD%E7%9A%84valueOf%E5%92%8CtoString/"/>
    <id>/2019/08/02/js中的valueOf和toString/</id>
    <published>2019-08-02T01:52:26.000Z</published>
    <updated>2019-08-02T02:09:39.167Z</updated>
    
    <content type="html"><![CDATA[<p>js中的valueOf和toString<br><a id="more"></a></p><h1 id="js中的valueOf和toString"><a href="#js中的valueOf和toString" class="headerlink" title="js中的valueOf和toString"></a>js中的valueOf和toString</h1><p>valueOf和toSring两个函数是除null和undefined两种数据类型以外其他五种数据类型（number/string/bool/object/symbol）原型链上共有的函数，那么这两个函数主要是用来干什么的呢？司徒正美大神给出的答案是：值运算和显示问题，一般在隐式类型转换时会自动调用(经典面试题见备注3)。</p><h2 id="例1："><a href="#例1：" class="headerlink" title="例1："></a>例1：</h2><p>如果同时重写了valueOf和toString方法：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> aaa = &#123;</span><br><span class="line">  i: <span class="number">10</span>,</span><br><span class="line">  valueOf: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'valueOf'</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.i+<span class="number">30</span>; </span><br><span class="line">  &#125;,</span><br><span class="line">  toString: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'toString'</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.i+<span class="number">10</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"> <span class="built_in">console</span>.log(aaa &gt; <span class="number">20</span>); <span class="comment">// valueOf  true</span></span><br><span class="line"> <span class="built_in">console</span>.log(<span class="string">''</span> + aaa);  <span class="comment">//  valueOf  40</span></span><br><span class="line"> <span class="built_in">console</span>.log(++aaa); <span class="comment">// valueOf  41</span></span><br><span class="line"> <span class="built_in">console</span>.log(+aaa); <span class="comment">//  valueOf  40</span></span><br><span class="line"> alert(aaa); <span class="comment">// toString 20</span></span><br><span class="line"> <span class="built_in">console</span>.log(aaa == <span class="number">40</span>) <span class="comment">//valueOf true</span></span><br><span class="line"> <span class="built_in">console</span>.log(<span class="built_in">String</span>(aaa)) <span class="comment">// toString 20</span></span><br></pre></td></tr></table></figure></p><p>总结：涉及到操作符的问题，valueOf的优先级比toString的优先级高，涉及到显示问题，toString方法优先级比valueOf方法高。</p><h2 id="例2："><a href="#例2：" class="headerlink" title="例2："></a>例2：</h2><p>如果只是重写了toString方法：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> aaa = &#123;</span><br><span class="line">  i: <span class="number">10</span>,</span><br><span class="line">  toString: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'toString'</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.i+<span class="number">10</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"> <span class="built_in">console</span>.log(aaa &gt; <span class="number">20</span>); <span class="comment">// toString false</span></span><br><span class="line"> <span class="built_in">console</span>.log(<span class="string">''</span> + aaa);  <span class="comment">//  toString 20</span></span><br><span class="line"> <span class="built_in">console</span>.log(++aaa); <span class="comment">// toString 21</span></span><br><span class="line"> <span class="built_in">console</span>.log(+aaa); <span class="comment">//  toSring 20</span></span><br><span class="line"> alert(aaa); <span class="comment">// toString 20</span></span><br><span class="line"> <span class="built_in">console</span>.log(aaa == <span class="number">20</span>) <span class="comment">//toString true</span></span><br><span class="line"> <span class="built_in">console</span>.log(<span class="built_in">String</span>(aaa)) <span class="comment">// toString 20</span></span><br></pre></td></tr></table></figure></p><p>总结：只重写了toString方法的话，toString方法比原型链上的valueOf方法优先级高。</p><h2 id="例3"><a href="#例3" class="headerlink" title="例3"></a>例3</h2><p>如果只重写了valueOf方法：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> aaa = &#123;</span><br><span class="line">  i: <span class="number">10</span>,</span><br><span class="line">  valueOf: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'valueOf'</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.i+<span class="number">30</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"> <span class="built_in">console</span>.log(aaa &gt; <span class="number">20</span>); <span class="comment">// valueOf true</span></span><br><span class="line"> <span class="built_in">console</span>.log(<span class="string">''</span> + aaa);  <span class="comment">//  valueOf 40</span></span><br><span class="line"> <span class="built_in">console</span>.log(++aaa); <span class="comment">// valueOf 41</span></span><br><span class="line"> <span class="built_in">console</span>.log(+aaa); <span class="comment">//  valueOf 40</span></span><br><span class="line"> alert(aaa); <span class="comment">// [object Object]</span></span><br><span class="line"> <span class="built_in">console</span>.log(aaa == <span class="number">20</span>) <span class="comment">//valueOf false</span></span><br><span class="line"> <span class="built_in">console</span>.log(<span class="built_in">String</span>(aaa)) <span class="comment">// [object Object]</span></span><br></pre></td></tr></table></figure></p><p>总结：只重写了valueOf方法的话，涉及到值运算优先调用valueOf方法，涉及到显示问题还是优先调用原型链上的toString方法。</p><h2 id="备注"><a href="#备注" class="headerlink" title="备注"></a>备注</h2><p>针对一般没有对valueOf和toString方法进行重写的情况：<br>1.对除null和undefined(这两种类型的原型上没有valueOf方法)以外的数据类型调用valueOf方法，得到的都是数据本身。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">1</span></span><br><span class="line"><span class="keyword">var</span> aa = a.valueOf()</span><br><span class="line">aa === a <span class="comment">//true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> b = <span class="string">'a'</span></span><br><span class="line"><span class="keyword">var</span> bb = b.valueOf()</span><br><span class="line">bb ===b <span class="comment">//true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> c = <span class="literal">true</span></span><br><span class="line"><span class="keyword">var</span> cc = c.valueOf()</span><br><span class="line">cc === c <span class="comment">//true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123;<span class="attr">name</span>: <span class="string">'age'</span>&#125;</span><br><span class="line"><span class="keyword">var</span> objobj = obj.valueOf()</span><br><span class="line">obj === objobj <span class="comment">//true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> s = <span class="built_in">Symbol</span>()</span><br><span class="line"><span class="keyword">var</span> ss = s.valueOf()</span><br><span class="line">ss === s <span class="comment">//true</span></span><br></pre></td></tr></table></figure></p><p>2.对number/string/bool/symbol类型数据调用toString方法得到的是对应的字符串，对object类型数据调用toString的方法得到的是”[object Object]”，null和undefined两种数据类型的原型链上没有toString方法。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> aaa = a.toString() <span class="comment">// "1"</span></span><br><span class="line"><span class="keyword">var</span> bbb = b.toString() <span class="comment">// "a"</span></span><br><span class="line"><span class="keyword">var</span> ccc = c.toString() <span class="comment">// "true"</span></span><br><span class="line"><span class="keyword">var</span> objobjobj = obj.toString() <span class="comment">//"[object Object]"</span></span><br><span class="line"><span class="keyword">var</span> sss = s.toString() <span class="comment">//"Symbol()"</span></span><br></pre></td></tr></table></figure></p><p>3.也可以得到一个经典前端面试题的一种解法,如何能够使得下列的表达式返回true<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a==<span class="number">1</span> &amp;&amp; a==<span class="number">2</span> &amp;&amp; a==<span class="number">3</span></span><br></pre></td></tr></table></figure></p><p>解法如下：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;</span><br><span class="line">i: <span class="number">1</span>,</span><br><span class="line">valueOf: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> a.i++</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">a==<span class="number">1</span> &amp;&amp; a==<span class="number">2</span> &amp;&amp; a==<span class="number">3</span> <span class="comment">//返回true</span></span><br></pre></td></tr></table></figure></p><p>以上重写了valueOf函数，比较运算时会优先调用该函数。当然，如果重写toString方法的话，比较运算也会优先调用该toString函数，因此可以到达同样的效果。<br>还有其他一种常见的解法：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> val = <span class="number">1</span></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(<span class="built_in">window</span>, <span class="string">'a'</span>, &#123;</span><br><span class="line">get() &#123;</span><br><span class="line"><span class="keyword">return</span> val++</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line">a==<span class="number">1</span> &amp;&amp; a==<span class="number">2</span> &amp;&amp; a==<span class="number">3</span> <span class="comment">//同样返回true</span></span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;js中的valueOf和toString&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="javascript" scheme="/categories/javascript/"/>
    
    
      <category term="基础知识" scheme="/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
  </entry>
  
  <entry>
    <title>js读取和导出excel文件</title>
    <link href="/2019/07/31/js%E8%AF%BB%E5%8F%96%E5%92%8C%E5%AF%BC%E5%87%BAexcel%E6%96%87%E4%BB%B6/"/>
    <id>/2019/07/31/js读取和导出excel文件/</id>
    <published>2019-07-31T08:29:45.000Z</published>
    <updated>2019-08-01T07:22:35.159Z</updated>
    
    <content type="html"><![CDATA[<p>javascript对excel文件进行导入导出的处理<br><a id="more"></a></p><h1 id="js读取和导出excel文件"><a href="#js读取和导出excel文件" class="headerlink" title="js读取和导出excel文件"></a>js读取和导出excel文件</h1><h2 id="js-xlsx-介绍"><a href="#js-xlsx-介绍" class="headerlink" title="js-xlsx 介绍"></a>js-xlsx 介绍</h2><p>由SheetJS出品的js-xlsx是一款非常方便的只需要纯JS即可读取和导出excel的工具库，功能强大，支持格式众多，支持xls、xlsx、ods(一种OpenOffice专有表格文件格式)等十几种格式。本文全部都是以xlsx格式为例。</p><ul><li>官方github：<a href="https://github.com/SheetJS/js-xlsx" target="_blank" rel="noopener">https://github.com/SheetJS/js-xlsx</a></li><li>本文配套demo：<a href="https://github.com/jinux7/study-collections/tree/master/js处理excel之js-xlsx" target="_blank" rel="noopener">点这里</a><h3 id="兼容性"><a href="#兼容性" class="headerlink" title="兼容性"></a>兼容性</h3>见下图：<br><img src="/2019/07/31/js读取和导出excel文件/1.png" alt="img"><h3 id="如何使用"><a href="#如何使用" class="headerlink" title="如何使用"></a>如何使用</h3>dist目录下有很多个JS文件，一般情况下用xlsx.core.min.js就够了，xlsx.full.min.js则是包含了所有功能模块。<br><img src="/2019/07/31/js读取和导出excel文件/2.png" alt="img"><br>直接script标签引入即可：<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">"text/javascript"</span> src=<span class="string">"./js/xlsx.core.min.js"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure></li></ul><h2 id="读取excel"><a href="#读取excel" class="headerlink" title="读取excel"></a>读取excel</h2><p>读取excel主要是通过XLSX.read(data, {type: type});方法来实现，返回一个叫WorkBook的对象，type主要取值如下：</p><ul><li>base64: 以base64方式读取；</li><li>binary: BinaryString格式(byte n is data.charCodeAt(n))</li><li>string: UTF8编码的字符串；</li><li>buffer: nodejs Buffer；</li><li>array: Uint8Array，8位无符号数组；</li><li>file: 文件的路径（仅nodejs下支持）；</li></ul><h3 id="获取workbook对象"><a href="#获取workbook对象" class="headerlink" title="获取workbook对象"></a>获取workbook对象</h3><h4 id="读取本地文件"><a href="#读取本地文件" class="headerlink" title="读取本地文件"></a>读取本地文件</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 读取本地excel文件</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">readWorkbookFromLocalFile</span>(<span class="params">file, callback</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> reader = <span class="keyword">new</span> FileReader();</span><br><span class="line">    reader.onload = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> data = e.target.result;</span><br><span class="line">        <span class="keyword">var</span> workbook = XLSX.read(data, &#123;<span class="attr">type</span>: <span class="string">'binary'</span>&#125;);</span><br><span class="line">        <span class="keyword">if</span>(callback) callback(workbook);</span><br><span class="line">    &#125;;</span><br><span class="line">    reader.readAsBinaryString(file);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="读取网络文件"><a href="#读取网络文件" class="headerlink" title="读取网络文件"></a>读取网络文件</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 从网络上读取某个excel文件，url必须同域，否则报错</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">readWorkbookFromRemoteFile</span>(<span class="params">url, callback</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    xhr.open(<span class="string">'get'</span>, url, <span class="literal">true</span>);</span><br><span class="line">    xhr.responseType = <span class="string">'arraybuffer'</span>;</span><br><span class="line">    xhr.onload = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(xhr.status == <span class="number">200</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> data = <span class="keyword">new</span> <span class="built_in">Uint8Array</span>(xhr.response)</span><br><span class="line">            <span class="keyword">var</span> workbook = XLSX.read(data, &#123;<span class="attr">type</span>: <span class="string">'array'</span>&#125;);</span><br><span class="line">            <span class="keyword">if</span>(callback) callback(workbook);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    xhr.send();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="详解-workbook"><a href="#详解-workbook" class="headerlink" title="详解 workbook"></a>详解 workbook</h3><h4 id="Workbook-Object"><a href="#Workbook-Object" class="headerlink" title="Workbook Object"></a>Workbook Object</h4><p>workbook里面有什么东西呢，我们打印出来看一下：<br><img src="/2019/07/31/js读取和导出excel文件/3.png" alt="img"><br>可以看到，SheetNames里面保存了所有的sheet名字，然后Sheets则保存了每个sheet的具体内容（我们称之为Sheet Object）。每一个sheet是通过类似A1这样的键值保存每个单元格的内容，我们称之为单元格对象（Cell Object）：<br><img src="/2019/07/31/js读取和导出excel文件/4.png" alt="img"></p><h4 id="Sheet-Object"><a href="#Sheet-Object" class="headerlink" title="Sheet Object"></a>Sheet Object</h4><p>每一个Sheet Object表示一张表格，只要不是!开头的都表示普通cell，否则，表示一些特殊含义，具体如下：</p><ul><li>sheet[‘!ref’]：表示所有单元格的范围，例如从A1到F8则记录为A1:F8；</li><li>sheet[!merges]：存放一些单元格合并信息，是一个数组，每个数组由包含s和e构成的对象组成，s表示开始，e表示结束，r表示行，c表示列；</li><li>等等；</li></ul><p>关于单元格合并，看懂下面这张图基本上就没问题了：<br><img src="/2019/07/31/js读取和导出excel文件/5.png" alt="img"><br>结果如下：<br><img src="/2019/07/31/js读取和导出excel文件/6.png" alt="img"></p><h4 id="单元格对象"><a href="#单元格对象" class="headerlink" title="单元格对象"></a>单元格对象</h4><p>每一个单元格是一个对象（Cell Object），主要有t、v、r、h、w等字段（详见这里）：</p><ul><li>t：表示内容类型，s表示string类型，n表示number类型，b表示boolean类型，d表示date类型，等等</li><li>v：表示原始值；</li><li>f：表示公式，如B2+B3；</li><li>h：HTML内容</li><li>w：格式化后的内容</li><li>r：富文本内容rich text</li><li>等等</li></ul><h4 id="读取workbook"><a href="#读取workbook" class="headerlink" title="读取workbook"></a>读取workbook</h4><p>普通方法：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 读取 excel文件</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">outputWorkbook</span>(<span class="params">workbook</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> sheetNames = workbook.SheetNames; <span class="comment">// 工作表名称集合</span></span><br><span class="line">    sheetNames.forEach(<span class="function"><span class="params">name</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> worksheet = workbook.Sheets[name]; <span class="comment">// 只能通过工作表名称来获取指定工作表</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> worksheet) &#123;</span><br><span class="line">            <span class="comment">// v是读取单元格的原始值</span></span><br><span class="line">            <span class="built_in">console</span>.log(key, key[<span class="number">0</span>] === <span class="string">'!'</span> ? worksheet[key] : worksheet[key].v);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>根据!ref确定excel的范围，再根据!merges确定单元格合并（如果有），最后输出整个table，比较麻烦，幸运的是，插件自身已经写好工具类XLSX.utils给我们直接使用，无需我们自己遍历，工具类输出主要包括如下：<br><img src="/2019/07/31/js读取和导出excel文件/7.png" alt="img"><br>有些不常用，常用的主要是：</p><ul><li>XLSX.utils.sheet_to_csv：生成CSV格式</li><li>XLSX.utils.sheet_to_txt：生成纯文本格式</li><li>XLSX.utils.sheet_to_html：生成HTML格式</li><li>XLSX.utils.sheet_to_json：输出JSON格式</li></ul><p>常用的主要是sheet_to_csv或者sheet_to_html，转csv的话会忽略格式、单元格合并等信息，所以复杂表格可能不适用。转html的话会保留单元格合并，但是生成的是<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">``` javascript</span><br><span class="line">function readWorkbook(workbook)</span><br><span class="line">&#123;</span><br><span class="line">    var sheetNames = workbook.SheetNames; // 工作表名称集合</span><br><span class="line">    var worksheet = workbook.Sheets[sheetNames[0]]; // 这里我们只读取第一张sheet</span><br><span class="line">    var csv = XLSX.utils.sheet_to_csv(worksheet);</span><br><span class="line">    document.getElementById(&apos;result&apos;).innerHTML = csv2table(csv);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 将csv转换成简单的表格，会忽略单元格合并，在第一行和第一列追加类似excel的索引</span><br><span class="line">function csv2table(csv)</span><br><span class="line">&#123;</span><br><span class="line">    var html = &apos;&lt;table&gt;&apos;;</span><br><span class="line">    var rows = csv.split(&apos;\n&apos;);</span><br><span class="line">    rows.pop(); // 最后一行没用的</span><br><span class="line">    rows.forEach(function(row, idx) &#123;</span><br><span class="line">        var columns = row.split(&apos;,&apos;);</span><br><span class="line">        columns.unshift(idx+1); // 添加行索引</span><br><span class="line">        if(idx == 0) &#123; // 添加列索引</span><br><span class="line">            html += &apos;&lt;tr&gt;&apos;;</span><br><span class="line">            for(var i=0; i&lt;columns.length; i++) &#123;</span><br><span class="line">                html += &apos;&lt;th&gt;&apos; + (i==0?&apos;&apos;:String.fromCharCode(65+i-1)) + &apos;&lt;/th&gt;&apos;;</span><br><span class="line">            &#125;</span><br><span class="line">            html += &apos;&lt;/tr&gt;&apos;;</span><br><span class="line">        &#125;</span><br><span class="line">        html += &apos;&lt;tr&gt;&apos;;</span><br><span class="line">        columns.forEach(function(column) &#123;</span><br><span class="line">            html += &apos;&lt;td&gt;&apos;+column+&apos;&lt;/td&gt;&apos;;</span><br><span class="line">        &#125;);</span><br><span class="line">        html += &apos;&lt;/tr&gt;&apos;;</span><br><span class="line">    &#125;);</span><br><span class="line">    html += &apos;&lt;/table&gt;&apos;;</span><br><span class="line">    return html;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="导出excel"><a href="#导出excel" class="headerlink" title="导出excel"></a>导出excel</h2><p>导出分为2种，一种是基于现有excel修改，一种是全新生成，前者比较简单，我们这里着重讲后者。</p><h3 id="自己手写代码生成"><a href="#自己手写代码生成" class="headerlink" title="自己手写代码生成"></a>自己手写代码生成</h3><p>导出excel文件，主要是如何生成一个sheet，我们这里写一个最简单的csv转excel示例：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// csv转sheet对象</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">csv2sheet</span>(<span class="params">csv</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> sheet = &#123;&#125;; <span class="comment">// 将要生成的sheet</span></span><br><span class="line">    csv = csv.split(<span class="string">'\n'</span>);</span><br><span class="line">    csv.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">row, i</span>) </span>&#123;</span><br><span class="line">        row = row.split(<span class="string">','</span>);</span><br><span class="line">        <span class="keyword">if</span>(i == <span class="number">0</span>) sheet[<span class="string">'!ref'</span>] = <span class="string">'A1:'</span>+<span class="built_in">String</span>.fromCharCode(<span class="number">65</span>+row.length<span class="number">-1</span>)+(csv.length<span class="number">-1</span>);</span><br><span class="line">        row.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">col, j</span>) </span>&#123;</span><br><span class="line">            sheet[<span class="built_in">String</span>.fromCharCode(<span class="number">65</span>+j)+(i+<span class="number">1</span>)] = &#123;<span class="attr">v</span>: col&#125;;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> sheet;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将一个sheet转成最终的excel文件的blob对象，然后利用URL.createObjectURL下载</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sheet2blob</span>(<span class="params">sheet, sheetName</span>) </span>&#123;</span><br><span class="line">    sheetName = sheetName || <span class="string">'sheet1'</span>;</span><br><span class="line">    <span class="keyword">var</span> workbook = &#123;</span><br><span class="line">        SheetNames: [sheetName],</span><br><span class="line">        Sheets: &#123;&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    workbook.Sheets[sheetName] = sheet;</span><br><span class="line">    <span class="comment">// 生成excel的配置项</span></span><br><span class="line">    <span class="keyword">var</span> wopts = &#123;</span><br><span class="line">        bookType: <span class="string">'xlsx'</span>, <span class="comment">// 要生成的文件类型</span></span><br><span class="line">        bookSST: <span class="literal">false</span>, <span class="comment">// 是否生成Shared String Table，官方解释是，如果开启生成速度会下降，但在低版本IOS设备上有更好的兼容性</span></span><br><span class="line">        type: <span class="string">'binary'</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> wbout = XLSX.write(workbook, wopts);</span><br><span class="line">    <span class="keyword">var</span> blob = <span class="keyword">new</span> Blob([s2ab(wbout)], &#123;<span class="attr">type</span>:<span class="string">"application/octet-stream"</span>&#125;);</span><br><span class="line">    <span class="comment">// 字符串转ArrayBuffer</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">s2ab</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> buf = <span class="keyword">new</span> <span class="built_in">ArrayBuffer</span>(s.length);</span><br><span class="line">        <span class="keyword">var</span> view = <span class="keyword">new</span> <span class="built_in">Uint8Array</span>(buf);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i!=s.length; ++i) view[i] = s.charCodeAt(i) &amp; <span class="number">0xFF</span>;</span><br><span class="line">        <span class="keyword">return</span> buf;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> blob;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>拿到上面的blob对象就可以直接下载了，参考我之前在JS弹出下载对话框里面封装好的openDownloadDialog方法：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通用的打开下载对话框方法，没有测试过具体兼容性</span></span><br><span class="line"><span class="comment"> * @param url 下载地址，也可以是一个blob对象，必选</span></span><br><span class="line"><span class="comment"> * @param saveName 保存文件名，可选</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">openDownloadDialog</span>(<span class="params">url, saveName</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">typeof</span> url == <span class="string">'object'</span> &amp;&amp; url <span class="keyword">instanceof</span> Blob)</span><br><span class="line">    &#123;</span><br><span class="line">        url = URL.createObjectURL(url); <span class="comment">// 创建blob地址</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> aLink = <span class="built_in">document</span>.createElement(<span class="string">'a'</span>);</span><br><span class="line">    aLink.href = url;</span><br><span class="line">    aLink.download = saveName || <span class="string">''</span>; <span class="comment">// HTML5新增的属性，指定保存文件名，可以不要后缀，注意，file:///模式下不会生效</span></span><br><span class="line">    <span class="keyword">var</span> event;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">window</span>.MouseEvent) event = <span class="keyword">new</span> MouseEvent(<span class="string">'click'</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        event = <span class="built_in">document</span>.createEvent(<span class="string">'MouseEvents'</span>);</span><br><span class="line">        event.initMouseEvent(<span class="string">'click'</span>, <span class="literal">true</span>, <span class="literal">false</span>, <span class="built_in">window</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="number">0</span>, <span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    aLink.dispatchEvent(event);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>所以，最终下载实现如下：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 传入csv，执行后就会弹出下载框</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">exportExcel</span>(<span class="params">csv</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> sheet = csv2sheet(csv);</span><br><span class="line">    <span class="keyword">var</span> blob = sheet2blob(sheet);</span><br><span class="line">    openDownloadDialog(blob, <span class="string">'导出.xlsx'</span>)；</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="利用官方工具类生成"><a href="#利用官方工具类生成" class="headerlink" title="利用官方工具类生成"></a>利用官方工具类生成</h3><p>其实上面这些代码都不需要我们手写，官方已经提供好了现成的工具类给我们使用，主要包括：</p><ul><li>aoa_to_sheet: 这个工具类最强大也最实用了，将一个二维数组转成sheet，会自动处理number、string、boolean、date等类型数据；</li><li>table_to_sheet: 将一个table dom直接转成sheet，会自动识别colspan和rowspan并将其转成对应的单元格合并；</li><li>json_to_sheet: 将一个由对象组成的数组转成sheet；</li></ul><p>aoa_to_sheet示例：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> aoa = [</span><br><span class="line">    [<span class="string">'姓名'</span>, <span class="string">'性别'</span>, <span class="string">'年龄'</span>, <span class="string">'注册时间'</span>],</span><br><span class="line">    [<span class="string">'张三'</span>, <span class="string">'男'</span>, <span class="number">18</span>, <span class="keyword">new</span> <span class="built_in">Date</span>()],</span><br><span class="line">    [<span class="string">'李四'</span>, <span class="string">'女'</span>, <span class="number">22</span>, <span class="keyword">new</span> <span class="built_in">Date</span>()]</span><br><span class="line">];</span><br><span class="line"><span class="keyword">var</span> sheet = XLSX.utils.aoa_to_sheet(aoa);</span><br><span class="line">openDownloadDialog(sheet2blob(sheet), <span class="string">'导出.xlsx'</span>);</span><br></pre></td></tr></table></figure></p><p>table_to_sheet就更简单了，直接XLSX.utils.table_to_sheet($(‘table’)[0])即可；</p><h3 id="处理单元格合并"><a href="#处理单元格合并" class="headerlink" title="处理单元格合并"></a>处理单元格合并</h3><p>一般来说，前端生成excel而不是csv最主要目的都是为了解决csv不能实现单元格合并的问题，要不然直接导出csv文件就好了，何必引入几百kb的插件。<br>假设我们要生成如下格式的excel文件，其中A1-C1进行单元格合并：<br><img src="/2019/07/31/js读取和导出excel文件/8.png" alt="img"><br>代码如下：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> aoa = [</span><br><span class="line">    [<span class="string">'主要信息'</span>, <span class="literal">null</span>, <span class="literal">null</span>, <span class="string">'其它信息'</span>], <span class="comment">// 特别注意合并的地方后面预留2个null</span></span><br><span class="line">    [<span class="string">'姓名'</span>, <span class="string">'性别'</span>, <span class="string">'年龄'</span>, <span class="string">'注册时间'</span>],</span><br><span class="line">    [<span class="string">'张三'</span>, <span class="string">'男'</span>, <span class="number">18</span>, <span class="keyword">new</span> <span class="built_in">Date</span>()],</span><br><span class="line">    [<span class="string">'李四'</span>, <span class="string">'女'</span>, <span class="number">22</span>, <span class="keyword">new</span> <span class="built_in">Date</span>()]</span><br><span class="line">];</span><br><span class="line"><span class="keyword">var</span> sheet = XLSX.utils.aoa_to_sheet(aoa);</span><br><span class="line">sheet[<span class="string">'!merges'</span>] = [</span><br><span class="line">    <span class="comment">// 设置A1-C1的单元格合并</span></span><br><span class="line">    &#123;<span class="attr">s</span>: &#123;<span class="attr">r</span>: <span class="number">0</span>, <span class="attr">c</span>: <span class="number">0</span>&#125;, <span class="attr">e</span>: &#123;<span class="attr">r</span>: <span class="number">0</span>, <span class="attr">c</span>: <span class="number">2</span>&#125;&#125;</span><br><span class="line">];</span><br><span class="line">openDownloadDialog(sheet2blob(sheet), <span class="string">'单元格合并示例.xlsx'</span>);</span><br></pre></td></tr></table></figure></p><p>需要注意的地方就是被合并的单元格要用null预留出位置，否则后面的内容（本例中是第四列其它信息）会被覆盖。</p><h3 id="自定义样式"><a href="#自定义样式" class="headerlink" title="自定义样式"></a>自定义样式</h3><p>普通版本不支持定义字体、颜色、背景色等，有这个功能需要的可以使用<a href="http://sheetjs.com/pro" target="_blank" rel="noopener">pro</a>版，好像是要收费的，因为官网没看到下载地址。</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>上面的代码在上传本地excel文件转换时候没什么问题，但是在用ajax请求的excel文件在转换时，chrome浏览器报错，firefox和opera正常。<br>我觉得问题出在我是用的excel的版本上，我在网上下载的excel文件就可以正常解析，这里要注意哦。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;javascript对excel文件进行导入导出的处理&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="javascript" scheme="/categories/javascript/"/>
    
    
      <category term="工具库" scheme="/tags/%E5%B7%A5%E5%85%B7%E5%BA%93/"/>
    
  </entry>
  
  <entry>
    <title>ES6-Symbol.iterator 迭代器</title>
    <link href="/2019/07/30/ES6-Symbol-iterator-%E8%BF%AD%E4%BB%A3%E5%99%A8/"/>
    <id>/2019/07/30/ES6-Symbol-iterator-迭代器/</id>
    <published>2019-07-30T08:51:28.000Z</published>
    <updated>2019-07-30T09:06:25.685Z</updated>
    
    <content type="html"><![CDATA[<p>ES6-Symbol.iterator 迭代器原理剖析<br><a id="more"></a></p><h1 id="ES6-Symbol-iterator-迭代器"><a href="#ES6-Symbol-iterator-迭代器" class="headerlink" title="ES6-Symbol.iterator 迭代器"></a>ES6-Symbol.iterator 迭代器</h1><p>一个数据结构只要部署了Symbol.iterator属性就能使用 for…of遍历 与 …运算符 操作<br>Object身上没有Symbol.iterator，当直接使用时会报错<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    <span class="number">0</span>: <span class="string">'a'</span>,</span><br><span class="line">    <span class="number">1</span>: <span class="string">'b'</span>,</span><br><span class="line">    <span class="number">2</span>: <span class="string">'c'</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log([...obj])<span class="comment">//报错obj is not iterable &lt;br&gt;　　　　　在没有Symbol.iterator方法下运行</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> p <span class="keyword">of</span> obj)&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(p);<span class="comment">//TypeError: obj is not iterable</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>Array身上天生具备Symbol.iterator<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>];</span><br><span class="line"><span class="comment">// 数组，天生具备Symbol.iterator方法所以可以使用</span></span><br><span class="line"><span class="built_in">console</span>.log([...arr]);<span class="comment">//(4) [1, 2, 3, 4]</span></span><br></pre></td></tr></table></figure></p><p>而我们Object需要用到…运算符 与 for of遍历怎么办呢<br>如果我们要使用它的话，Object身上需要有一个Symbol.iterator属性代码如下：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    <span class="number">0</span>: <span class="string">'a'</span>,</span><br><span class="line">    <span class="number">1</span>: <span class="string">'b'</span>,</span><br><span class="line">    <span class="number">2</span>: <span class="string">'c'</span>,</span><br><span class="line">    length: <span class="number">3</span>,</span><br><span class="line">    [<span class="built_in">Symbol</span>.iterator]: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// index用来记遍历圈数</span></span><br><span class="line">        <span class="keyword">let</span> index = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">let</span> next = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                value: <span class="keyword">this</span>[index],</span><br><span class="line">                done: <span class="keyword">this</span>.length == ++index</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            next</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// console.log(obj.length)</span></span><br><span class="line"><span class="built_in">console</span>.log([...obj]);<span class="comment">//(2) ["a", "b"]</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> p <span class="keyword">of</span> obj)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(p) <span class="comment">//"a"  "b"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ES6-Symbol.iterator 迭代器原理剖析&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="javascript" scheme="/categories/javascript/"/>
    
    
      <category term="基础知识" scheme="/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
  </entry>
  
  <entry>
    <title>移动端touch事件简介</title>
    <link href="/2019/07/30/%E7%A7%BB%E5%8A%A8%E7%AB%AFtouch%E4%BA%8B%E4%BB%B6%E7%AE%80%E4%BB%8B/"/>
    <id>/2019/07/30/移动端touch事件简介/</id>
    <published>2019-07-30T06:11:43.000Z</published>
    <updated>2019-07-30T06:30:12.252Z</updated>
    
    <content type="html"><![CDATA[<p>移动端的touch事件的简单入门介绍<br><a id="more"></a></p><h1 id="移动端touch事件简介"><a href="#移动端touch事件简介" class="headerlink" title="移动端touch事件简介"></a>移动端touch事件简介</h1><h2 id="touch事件"><a href="#touch事件" class="headerlink" title="touch事件"></a>touch事件</h2><p>首先 touch 包含三类事件，它们分别是：touchstart、touchmove、touchend 。</p><ul><li>touchstart：手指触摸到一个 DOM 元素时触发。</li><li>touchmove：手指在一个 DOM 元素上滑动时触发。</li><li>touchend：手指从一个 DOM 元素上移开时触发。</li></ul><p>这三个事件又分别对应三个相同的触摸列表：</p><ul><li>touches：正在触摸屏幕的所有手指的一个列表。</li><li>targetTouches：正在触摸当前 DOM 元素上的手指的一个列表。</li><li>changedTouches：涉及当前事件的手指的一个列表。</li></ul><h2 id="touch事件属性"><a href="#touch事件属性" class="headerlink" title="touch事件属性"></a>touch事件属性</h2><p>事件对应的三个列表虽然名字不一样，但是它们里面装的东西都是差不多的，包含了当前事件的一些相关信息，比如：一些坐标信息。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">clientX:<span class="number">65</span> <span class="comment">// 触摸点在浏览器窗口中的横坐标</span></span><br><span class="line">clientY:<span class="number">18</span> <span class="comment">// 触摸点在浏览器窗口中的纵坐标</span></span><br><span class="line">force:<span class="number">1</span> <span class="comment">// 触摸点压力大小</span></span><br><span class="line">identifier:<span class="number">0</span> <span class="comment">// 触摸点唯一标识（ID）</span></span><br><span class="line">pageX:<span class="number">65</span> <span class="comment">// 触摸点在页面中的横坐标</span></span><br><span class="line">pageY:<span class="number">18</span> <span class="comment">// 触摸点在页面中的纵坐标</span></span><br><span class="line">radiusX:<span class="number">11.5</span> <span class="comment">// 触摸点椭圆的水平半径</span></span><br><span class="line">radiusY:<span class="number">11.5</span> <span class="comment">// 触摸点椭圆的垂直半径</span></span><br><span class="line">rotationAngle:<span class="number">0</span> <span class="comment">// 旋转角度</span></span><br><span class="line">screenX:<span class="number">560</span> <span class="comment">// 触摸点在屏幕中的横坐标</span></span><br><span class="line">screenY:<span class="number">175</span> <span class="comment">// 触摸点在屏幕中的纵坐标</span></span><br></pre></td></tr></table></figure></p><p>上面就是一个 TouchList 列表。它对应的就是前面提到的三种事件（touchstart、touchmove、touchend）中的一种，在触发时生成的一个对象列表。列表里最有用的就是 Touch 对象了，Touch 对象里存放着对应事件的一些相关的信息，我们就是通过这种个事件里这些属性的有机结合来实现各种效果。<br>通过上面的 radiusX，radiusY，rotationAngle 这三个属性就可以计算出你的手指触摸手机屏幕时的一个接触面，只不过这个接触面是用一个近似的椭圆来表示，也就是说它不是一个真正意义上的接触面，而是一个大概的接触面。相信心细的朋友应该会看到 TouchList 对象里有一个 length 属性，并且它的值为 1  ，这说明当前只有一个手指触发了事件（比如：touchstart 事件），换句话说，此时你只有一个手指放到了手机屏幕上，这个手指对应的一些信息存放在 Touch 对象里。因为只有一个手指放在了屏幕上，所以这个 TouchList 里只有一个 Touch 对象，并且是第一个下标为 0 。TouchList 列表里还有一个 target 属性，这个应该很好理解，就是触摸的目标。<br>为了让你能更加立体地理解上面的这些属性，我专门从网上找了一段话来作为补充：</p><p>来自 mozilla</p><ul><li>1.Touch.identifier：此 Touch 对象的唯一标识符。 一次触摸动作(我们指的是手指的触摸)在平面上移动的整个过程中，该标识符不变。 可以根据它来判断跟踪的是否是同一次触摸过程，此值为只读属性。</li><li>2.Touch.screenX：触点相对于屏幕左边沿的X坐标。只读属性。</li><li>3.Touch.screenY：触点相对于屏幕上边沿的Y坐标。只读属性。</li><li>4.Touch.clientX：触点相对于可见视区(visual viewport)左边沿的X坐标。不包括任何滚动偏移。只读属性。</li><li>5.Touch.clientY：触点相对于可见视区(visual viewport)上边沿的Y坐标。不包括任何滚动偏移。只读属性。</li><li>6.Touch.pageX：触点相对于HTML文档左边沿的X坐标。当存在水平滚动的偏移时，这个值包含了水平滚动的偏移。只读属性。</li><li>7.Touch.pageY：触点相对于HTML文档上边沿的Y坐标。当存在水平滚动的偏移时，这个值包含了垂直滚动的偏移。只读属性。</li><li>8.Touch.radiusX：能够包围用户和触摸平面的接触面的最小椭圆的水平轴(X轴)半径。这个值的单位和 screenX 相同。只读属性。</li><li>9.Touch.radiusY：能够包围用户和触摸平面的接触面的最小椭圆的垂直轴(Y轴)半径。这个值的单位和 screenY 相同。只读属性。</li><li>10.Touch.rotationAngle：它是这样一个角度值：由radiusX 和 radiusY描述的正方向的椭圆，需要通过顺时针旋转这个角度值，才能最精确地覆盖住用户和触摸平面的接触面。只读属性。</li><li>11.Touch.force：手指挤压触摸平面的压力大小，从0.0(没有压力)到1.0(最大压力)的浮点数。只读属性。</li><li>12.Touch.target：当这个触点最开始被跟踪时(在 touchstart 事件中)，触点位于的HTML元素。哪怕在触点移动过程中，触点的位置已经离开了这个元素的有效交互区域，或者这个元素已经被从文档中移除。需要注意的是，如果这个元素在触摸过程中被移除，这个事件仍然会指向它，但是不会再冒泡这个事件到 window 或 document 对象。因此，如果有元素在触摸过程中可能被移除，最佳实践是将触摸事件的监听器绑定到这个元素本身，防止元素被移除后，无法再从它的上一级元素上侦测到从该元素冒泡的事件。只读属性。</li></ul><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>这里只是简单地介绍了一下移动端的touch事件，主要还是记住touchstart，touchmove，touchend这三个事件，还有事件里的touches，targetTouches，changedTouches这三个属性，我们尝试用的还是targetTouches,touches的兼容性不好，一般我们不使用。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;移动端的touch事件的简单入门介绍&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="javascript" scheme="/categories/javascript/"/>
    
    
      <category term="移动端" scheme="/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>你真的了解回流和重绘吗?</title>
    <link href="/2019/07/29/%E4%BD%A0%E7%9C%9F%E7%9A%84%E4%BA%86%E8%A7%A3%E5%9B%9E%E6%B5%81%E5%92%8C%E9%87%8D%E7%BB%98%E5%90%97/"/>
    <id>/2019/07/29/你真的了解回流和重绘吗/</id>
    <published>2019-07-29T08:03:47.000Z</published>
    <updated>2019-07-29T08:39:36.837Z</updated>
    
    <content type="html"><![CDATA[<p>你真的了解回流和重绘吗<br><a id="more"></a></p><h1 id="你真的了解回流和重绘吗"><a href="#你真的了解回流和重绘吗" class="headerlink" title="你真的了解回流和重绘吗"></a>你真的了解回流和重绘吗</h1><p>回流和重绘可以说是每一个web开发者都经常听到的两个词语，我也不例外，可是我之前一直不是很清楚这两步具体做了什么事情。最近由于部门内部要做分享，所以对其进行了一些研究，看了一些博客和书籍，整理了一些内容并且结合一些例子，写了这篇文章，希望可以帮助到大家。</p><h2 id="浏览器的渲染过程"><a href="#浏览器的渲染过程" class="headerlink" title="浏览器的渲染过程"></a>浏览器的渲染过程</h2><p>本文先从浏览器的渲染过程来从头到尾的讲解一下回流重绘，如果大家想直接看如何减少回流和重绘，可以跳到后面。（这个渲染过程来自<a href="https://developers.google.com/web/fundamentals/performance/critical-rendering-path/render-tree-construction?hl=zh-cn" target="_blank" rel="noopener">MDN</a>）</p><p><img src="/2019/07/29/你真的了解回流和重绘吗/1.png" alt="webkit渲染过程"></p><p>从上面这个图上，我们可以看到，浏览器渲染过程如下：</p><ol><li>解析HTML，生成DOM树，解析CSS，生成CSSOM树</li><li>将DOM树和CSSOM树结合，生成渲染树(Render Tree)</li><li>Layout(回流):根据生成的渲染树，进行回流(Layout)，得到节点的几何信息（位置，大小）</li><li>Painting(重绘):根据渲染树以及回流得到的几何信息，得到节点的绝对像素</li><li>Display:将像素发送给GPU，展示在页面上。（这一步其实还有很多内容，比如会在GPU将多个合成层合并为同一个层，并展示在页面中。而css3硬件加速的原理则是新建合成层，这里我们不展开，之后有机会会写一篇博客）</li></ol><p>渲染过程看起来很简单，让我们来具体了解下每一步具体做了什么。</p><h3 id="生成渲染树"><a href="#生成渲染树" class="headerlink" title="生成渲染树"></a>生成渲染树</h3><p><img src="/2019/07/29/你真的了解回流和重绘吗/2.png" alt="生成渲染树"></p><p>为了构建渲染树，浏览器主要完成了以下工作：</p><ol><li>从DOM树的根节点开始遍历每个可见节点。</li><li>对于每个可见的节点，找到CSSOM树中对应的规则，并应用它们。</li><li>根据每个可见节点以及其对应的样式，组合生成渲染树。</li></ol><p>第一步中，既然说到了要遍历可见的节点，那么我们得先知道，什么节点是不可见的。不可见的节点包括：</p><ul><li>一些不会渲染输出的节点，比如script、meta、link等。</li><li>一些通过css进行隐藏的节点。比如display:none。注意，利用visibility和opacity隐藏的节点，还是会显示在渲染树上的。只有display:none的节点才不会显示在渲染树上。</li></ul><p><strong>注意：渲染树只包含可见的节点</strong></p><h3 id="回流"><a href="#回流" class="headerlink" title="回流"></a>回流</h3><p>前面我们通过构造渲染树，我们将可见DOM节点以及它对应的样式结合起来，可是我们还需要计算它们在设备视口(viewport)内的确切位置和大小，这个计算的阶段就是回流。</p><p>为了弄清每个对象在网站上的确切大小和位置，浏览器从渲染树的根节点开始遍历，我们可以以下面这个实例来表示：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width,initial-scale=1"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Critial Path: Hello world!<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"width: 50%"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"width: 50%"</span>&gt;</span>Hello world!<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>我们可以看到，第一个div将节点的显示尺寸设置为视口宽度的50%，第二个div将其尺寸设置为父节点的50%。而在回流这个阶段，我们就需要根据视口具体的宽度，将其转为实际的像素值。（如下图）</p><p><img src="/2019/07/29/你真的了解回流和重绘吗/3.png" alt=""></p><h3 id="重绘"><a href="#重绘" class="headerlink" title="重绘"></a>重绘</h3><p>最终，我们通过构造渲染树和回流阶段，我们知道了哪些节点是可见的，以及可见节点的样式和具体的几何信息(位置、大小)，那么我们就可以将渲染树的每个节点都转换为屏幕上的实际像素，这个阶段就叫做重绘节点。</p><p>既然知道了浏览器的渲染过程后，我们就来探讨下，何时会发生回流重绘。</p><h2 id="何时发生回流重绘"><a href="#何时发生回流重绘" class="headerlink" title="何时发生回流重绘"></a>何时发生回流重绘</h2><p>我们前面知道了，回流这一阶段主要是计算节点的位置和几何信息，那么当页面布局和几何信息发生变化的时候，就需要回流。比如以下情况：</p><ul><li>添加或删除可见的DOM元素</li><li>元素的位置发生变化</li><li>元素的尺寸发生变化（包括外边距、内边框、边框大小、高度和宽度等）</li><li>内容发生变化，比如文本变化或图片被另一个不同尺寸的图片所替代。</li><li>页面一开始渲染的时候（这肯定避免不了）</li><li>浏览器的窗口尺寸变化（因为回流是根据视口的大小来计算元素的位置和大小的）</li></ul><p><strong>注意：回流一定会触发重绘，而重绘不一定会回流</strong></p><p>根据改变的范围和程度，渲染树中或大或小的部分需要重新计算，有些改变会触发整个页面的重排，比如，滚动条出现的时候或者修改了根节点。</p><h2 id="浏览器的优化机制"><a href="#浏览器的优化机制" class="headerlink" title="浏览器的优化机制"></a>浏览器的优化机制</h2><p>现代的浏览器都是很聪明的，由于每次重排都会造成额外的计算消耗，因此大多数浏览器都会通过队列化修改并批量执行来优化重排过程。浏览器会将修改操作放入到队列里，直到过了一段时间或者操作达到了一个阈值，才清空队列。但是！<strong>当你获取布局信息的操作的时候，会强制队列刷新</strong>，比如当你访问以下属性或者使用以下方法：</p><ul><li>offsetTop、offsetLeft、offsetWidth、offsetHeight</li><li>scrollTop、scrollLeft、scrollWidth、scrollHeight</li><li>clientTop、clientLeft、clientWidth、clientHeight</li><li>getComputedStyle()</li><li>getBoundingClientRect</li><li>具体可以访问这个网站：<a href="https://gist.github.com/paulirish/5d52fb081b3570c81e3a" target="_blank" rel="noopener">https://gist.github.com/paulirish/5d52fb081b3570c81e3a</a></li></ul><p>以上属性和方法都需要返回最新的布局信息，因此浏览器不得不清空队列，触发回流重绘来返回正确的值。因此，我们在修改样式的时候，<strong>最好避免使用上面列出的属性，他们都会刷新渲染队列。</strong>如果要使用它们，最好将值缓存起来。</p><h2 id="减少回流和重绘"><a href="#减少回流和重绘" class="headerlink" title="减少回流和重绘"></a>减少回流和重绘</h2><p>好了，到了我们今天的重头戏，前面说了这么多背景和理论知识，接下来让我们谈谈如何减少回流和重绘。</p><h3 id="最小化重绘和重排"><a href="#最小化重绘和重排" class="headerlink" title="最小化重绘和重排"></a>最小化重绘和重排</h3><p>由于重绘和重排可能代价比较昂贵，因此最好就是可以减少它的发生次数。为了减少发生次数，我们可以合并多次对DOM和样式的修改，然后一次处理掉。考虑这个例子</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> el = <span class="built_in">document</span>.getElementById(<span class="string">'test'</span>);</span><br><span class="line">el.style.padding = <span class="string">'5px'</span>;</span><br><span class="line">el.style.borderLeft = <span class="string">'1px'</span>;</span><br><span class="line">el.style.borderRight = <span class="string">'2px'</span>;</span><br></pre></td></tr></table></figure><p>例子中，有三个样式属性被修改了，每一个都会影响元素的几何结构，引起回流。当然，大部分现代浏览器都对其做了优化，因此，只会触发一次重排。但是如果在旧版的浏览器或者在上面代码执行的时候，有其他代码访问了布局信息(上文中的会触发回流的布局信息)，那么就会导致三次重排。</p><p>因此，我们可以合并所有的改变然后依次处理，比如我们可以采取以下的方式：</p><ul><li><p>使用cssText</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> el = <span class="built_in">document</span>.getElementById(<span class="string">'test'</span>);</span><br><span class="line">el.style.cssText += <span class="string">'border-left: 1px; border-right: 2px; padding: 5px;'</span>;</span><br></pre></td></tr></table></figure></li><li><p>修改CSS的class</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> el = <span class="built_in">document</span>.getElementById(<span class="string">'test'</span>);</span><br><span class="line">el.className += <span class="string">' active'</span>;</span><br></pre></td></tr></table></figure></li></ul><h3 id="批量修改DOM"><a href="#批量修改DOM" class="headerlink" title="批量修改DOM"></a>批量修改DOM</h3><p>当我们需要对DOM对一系列修改的时候，可以通过以下步骤减少回流重绘次数：</p><ol><li>使元素脱离文档流</li><li>对其进行多次修改</li><li>将元素带回到文档中。</li></ol><p>该过程的第一步和第三步可能会引起回流，但是经过第一步之后，对DOM的所有修改都不会引起回流，因为它已经不在渲染树了。</p><p>有三种方式可以让DOM脱离文档流：</p><ul><li>隐藏元素，应用修改，重新显示</li><li>使用文档片段(document fragment)在当前DOM之外构建一个子树，再把它拷贝回文档。</li><li>将原始元素拷贝到一个脱离文档的节点中，修改节点后，再替换原始的元素。</li></ul><p>考虑我们要执行一段批量插入节点的代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">appendDataToElement</span>(<span class="params">appendToElement, data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> li;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; data.length; i++) &#123;</span><br><span class="line">    li = <span class="built_in">document</span>.createElement(<span class="string">'li'</span>);</span><br><span class="line">        li.textContent = <span class="string">'text'</span>;</span><br><span class="line">        appendToElement.appendChild(li);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ul = <span class="built_in">document</span>.getElementById(<span class="string">'list'</span>);</span><br><span class="line">appendDataToElement(ul, data);</span><br></pre></td></tr></table></figure><p>如果我们直接这样执行的话，由于每次循环都会插入一个新的节点，会导致浏览器回流一次。</p><p>我们可以使用这三种方式进行优化:</p><p><strong>隐藏元素，应用修改，重新显示</strong></p><p>这个会在展示和隐藏节点的时候，产生两次重绘</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">appendDataToElement</span>(<span class="params">appendToElement, data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> li;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; data.length; i++) &#123;</span><br><span class="line">    li = <span class="built_in">document</span>.createElement(<span class="string">'li'</span>);</span><br><span class="line">        li.textContent = <span class="string">'text'</span>;</span><br><span class="line">        appendToElement.appendChild(li);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> ul = <span class="built_in">document</span>.getElementById(<span class="string">'list'</span>);</span><br><span class="line">ul.style.display = <span class="string">'none'</span>;</span><br><span class="line">appendDataToElement(ul, data);</span><br><span class="line">ul.style.display = <span class="string">'block'</span>;</span><br></pre></td></tr></table></figure><p><strong>使用文档片段(document fragment)在当前DOM之外构建一个子树，再把它拷贝回文档</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> ul = <span class="built_in">document</span>.getElementById(<span class="string">'list'</span>);</span><br><span class="line"><span class="keyword">const</span> fragment = <span class="built_in">document</span>.createDocumentFragment();</span><br><span class="line">appendDataToElement(fragment, data);</span><br><span class="line">ul.appendChild(fragment);</span><br></pre></td></tr></table></figure><p><strong>将原始元素拷贝到一个脱离文档的节点中，修改节点后，再替换原始的元素。</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> ul = <span class="built_in">document</span>.getElementById(<span class="string">'list'</span>);</span><br><span class="line"><span class="keyword">const</span> clone = ul.cloneNode(<span class="literal">true</span>);</span><br><span class="line">appendDataToElement(clone, data);</span><br><span class="line">ul.parentNode.replaceChild(clone, ul);</span><br></pre></td></tr></table></figure><p>对于上述那种情况，我写了一个<a href="https://chenjigeng.github.io/example/share/%E9%81%BF%E5%85%8D%E5%9B%9E%E6%B5%81%E9%87%8D%E7%BB%98/%E6%89%B9%E9%87%8F%E4%BF%AE%E6%94%B9DOM.html" target="_blank" rel="noopener">demo</a>来测试修改前和修改后的性能。然而实验结果不是很理想。</p><p><strong>原因：原因其实上面也说过了，浏览器会使用队列来储存多次修改，进行优化，所以对这个优化方案，我们其实不用优先考虑。</strong></p><h3 id="避免触发同步布局事件"><a href="#避免触发同步布局事件" class="headerlink" title="避免触发同步布局事件"></a>避免触发同步布局事件</h3><p>上文我们说过，当我们访问元素的一些属性的时候，会导致浏览器强制清空队列，进行强制同步布局。举个例子，比如说我们想将一个p标签数组的宽度赋值为一个元素的宽度，我们可能写出这样的代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">initP</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; paragraphs.length; i++) &#123;</span><br><span class="line">        paragraphs[i].style.width = box.offsetWidth + <span class="string">'px'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这段代码看上去是没有什么问题，可是其实会造成很大的性能问题。在每次循环的时候，都读取了box的一个offsetWidth属性值，然后利用它来更新p标签的width属性。这就导致了每一次循环的时候，浏览器都必须先使上一次循环中的样式更新操作生效，才能响应本次循环的样式读取操作。每一次循环都会强制浏览器刷新队列。我们可以优化为:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> width = box.offsetWidth;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">initP</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; paragraphs.length; i++) &#123;</span><br><span class="line">        paragraphs[i].style.width = width + <span class="string">'px'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>同样，我也写了个<a href="https://chenjigeng.github.io/example/share/%E9%81%BF%E5%85%8D%E5%9B%9E%E6%B5%81%E9%87%8D%E7%BB%98/%E9%81%BF%E5%85%8D%E5%BF%AB%E9%80%9F%E8%BF%9E%E7%BB%AD%E7%9A%84%E5%B8%83%E5%B1%80.html" target="_blank" rel="noopener">demo</a>来比较两者的性能差异。你可以自己点开这个demo体验下。这个对比差距就比较明显。</p><h3 id="对于复杂动画效果-使用绝对定位让其脱离文档流"><a href="#对于复杂动画效果-使用绝对定位让其脱离文档流" class="headerlink" title="对于复杂动画效果,使用绝对定位让其脱离文档流"></a>对于复杂动画效果,使用绝对定位让其脱离文档流</h3><p>对于复杂动画效果，由于会经常的引起回流重绘，因此，我们可以使用绝对定位，让它脱离文档流。否则会引起父元素以及后续元素频繁的回流。这个我们就直接上个<a href="https://chenjigeng.github.io/example/share/%E9%81%BF%E5%85%8D%E5%9B%9E%E6%B5%81%E9%87%8D%E7%BB%98/%E5%B0%86%E5%A4%8D%E6%9D%82%E5%8A%A8%E7%94%BB%E6%B5%AE%E5%8A%A8%E5%8C%96.html" target="_blank" rel="noopener">例子</a>。</p><p>打开这个例子后，我们可以打开控制台，控制台上会输出当前的帧数(虽然不准)。</p><p><img src="/2019/07/29/你真的了解回流和重绘吗/4.png" alt="image-20181210223750055"></p><p>从上图中，我们可以看到，帧数一直都没到60。这个时候，只要我们点击一下那个按钮，把这个元素设置为绝对定位，帧数就可以稳定60。</p><h3 id="css3硬件加速（GPU加速）"><a href="#css3硬件加速（GPU加速）" class="headerlink" title="css3硬件加速（GPU加速）"></a>css3硬件加速（GPU加速）</h3><p>比起考虑如何减少回流重绘，我们更期望的是，根本不要回流重绘。这个时候，css3硬件加速就闪亮登场啦！！</p><p><strong>划重点：使用css3硬件加速，可以让transform、opacity、filters这些动画不会引起回流重绘 。但是对于动画的其它属性，比如background-color这些，还是会引起回流重绘的，不过它还是可以提升这些动画的性能。</strong></p><p>本篇文章只讨论如何使用，暂不考虑其原理，之后有空会另外开篇文章说明。</p><h4 id="如何使用"><a href="#如何使用" class="headerlink" title="如何使用"></a>如何使用</h4><p>常见的触发硬件加速的css属性：</p><ul><li>transform</li><li>opacity</li><li>filters</li><li>Will-change</li></ul><h4 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h4><p>我们可以先看个<a href="https://chenjigeng.github.io/example/share/%E5%AF%B9%E6%AF%94gpu%E5%8A%A0%E9%80%9F/gpu%E5%8A%A0%E9%80%9F-transform.html" target="_blank" rel="noopener">例子</a>。我通过使用chrome的Performance捕获了一段时间的回流重绘情况，实际结果如下图：</p><p><img src="/2019/07/29/你真的了解回流和重绘吗/5.png" alt="image-20181210225609533"></p><p>从图中我们可以看出，在动画进行的时候，没有发生任何的回流重绘。如果感兴趣你也可以自己做下实验。</p><h4 id="重点"><a href="#重点" class="headerlink" title="重点"></a>重点</h4><ul><li>使用css3硬件加速，可以让transform、opacity、filters这些动画不会引起回流重绘 </li><li>对于动画的其它属性，比如background-color这些，还是会引起回流重绘的，不过它还是可以提升这些动画的性能。</li></ul><h4 id="css3硬件加速的坑"><a href="#css3硬件加速的坑" class="headerlink" title="css3硬件加速的坑"></a>css3硬件加速的坑</h4><ul><li><p>如果你为太多元素使用css3硬件加速，会导致内存占用较大，会有性能问题。</p></li><li><p>在GPU渲染字体会导致抗锯齿无效。这是因为GPU和CPU的算法不同。因此如果你不在动画结束的时候关闭硬件加速，会产生字体模糊。</p></li></ul><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>本文主要讲了浏览器的渲染过程、浏览器的优化机制以及如何减少甚至避免回流和重绘，希望可以帮助大家更好的理解回流重绘。</p><h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul><li><p><a href="https://developers.google.com/web/fundamentals/performance/critical-rendering-path/render-tree-construction?hl=zh-cn" target="_blank" rel="noopener">渲染树构建、布局及绘制</a></p></li><li><p>高性能Javascript</p></li></ul><p>文章出处-&gt;<a href="https://github.com/chenjigeng/blog" target="_blank" rel="noopener">博客地址</a>, 欢迎给个 start 或 follow</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;你真的了解回流和重绘吗&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="css" scheme="/categories/css/"/>
    
    
      <category term="web性能" scheme="/tags/web%E6%80%A7%E8%83%BD/"/>
    
  </entry>
  
  <entry>
    <title>模块化CommonJS与AMD的手写实现</title>
    <link href="/2019/07/24/%E6%A8%A1%E5%9D%97%E5%8C%96CommonJS%E4%B8%8EAMD%E7%9A%84%E6%89%8B%E5%86%99%E5%AE%9E%E7%8E%B0/"/>
    <id>/2019/07/24/模块化CommonJS与AMD的手写实现/</id>
    <published>2019-07-24T08:34:06.000Z</published>
    <updated>2019-07-24T09:09:10.064Z</updated>
    
    <content type="html"><![CDATA[<p>javascript模块化CommonJS与AMD是如何实现的<br><a id="more"></a></p><h2 id="模块化CommonJS与AMD的手写实现"><a href="#模块化CommonJS与AMD的手写实现" class="headerlink" title="模块化CommonJS与AMD的手写实现"></a>模块化CommonJS与AMD的手写实现</h2><p>现在的前端开发都采用的模块化思想，之前都是使用全局变量，但是弊端这里就不过多描述了。<br>模块化有CommonJS,AMD,CMD,ES6的模块新规范这4种，今天我们来实现以下CommonJS和AMD的规范。</p><h3 id="CommonJS"><a href="#CommonJS" class="headerlink" title="CommonJS"></a>CommonJS</h3><p>首先，CommonJS一般都用在nodejs里，写法如下:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入</span></span><br><span class="line"><span class="keyword">const</span> someFun= <span class="built_in">require</span>(<span class="string">'./moduleA'</span>);</span><br><span class="line">someFun();</span><br><span class="line"><span class="comment">// 导出</span></span><br><span class="line"><span class="built_in">module</span>.exports = someFunc;</span><br></pre></td></tr></table></figure></p><p>我们来看一下简单的实现方法<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// a.js</span></span><br><span class="line"><span class="keyword">let</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">let</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">let</span> b = req(<span class="string">'./b.js'</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">req</span>(<span class="params">mod</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> filename = path.join(__dirname, mod);</span><br><span class="line">    <span class="keyword">let</span> content = fs.readFileSync(filename, <span class="string">'utf8'</span>);</span><br><span class="line">    <span class="keyword">let</span> fn = <span class="keyword">new</span> <span class="built_in">Function</span>(<span class="string">'exports'</span>, <span class="string">'require'</span>, <span class="string">'module'</span>, <span class="string">'__filename'</span>, <span class="string">'__dirname'</span>, content + <span class="string">'\n return module.exports;'</span>);</span><br><span class="line">    <span class="keyword">let</span> <span class="built_in">module</span> = &#123;</span><br><span class="line">        exports: &#123;&#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> fn(<span class="built_in">module</span>.exports, req, <span class="built_in">module</span>, __filename, __dirname);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// b.js</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'bbb'</span>);</span><br><span class="line">exports.name = <span class="string">'zfpx'</span>;</span><br></pre></td></tr></table></figure></p><h3 id="AMD"><a href="#AMD" class="headerlink" title="AMD"></a>AMD</h3><p>我们再来看看AMD规范，AMD规范的实现库是大名鼎鼎requirejs<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义一个模块</span></span><br><span class="line">define(<span class="string">'a'</span>, [], <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'a'</span>;</span><br><span class="line">&#125;);</span><br><span class="line">define(<span class="string">'b'</span>, [<span class="string">'a'</span>], <span class="function"><span class="keyword">function</span> (<span class="params">a</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + <span class="string">'b'</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 导入和使用</span></span><br><span class="line"><span class="built_in">require</span>([<span class="string">'b'</span>], <span class="function"><span class="keyword">function</span> (<span class="params">b</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(b);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><p>简单的实现<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> factories = &#123;&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">define</span>(<span class="params">modName, dependencies, factory</span>) </span>&#123;</span><br><span class="line">    factory.dependencies = dependencies;</span><br><span class="line">    factories[modName] = factory;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">require</span>(<span class="params">modNames, callback</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> loadedModNames = modNames.map(<span class="function"><span class="keyword">function</span> (<span class="params">modName</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> factory = factories[modName];</span><br><span class="line">        <span class="keyword">let</span> dependencies = factory.dependencies;</span><br><span class="line">        <span class="keyword">let</span> exports;</span><br><span class="line">        <span class="built_in">require</span>(dependencies, <span class="function"><span class="keyword">function</span> (<span class="params">...dependencyMods</span>) </span>&#123;</span><br><span class="line">            exports = factory.apply(<span class="literal">null</span>, dependencyMods);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> exports;</span><br><span class="line">    &#125;)</span><br><span class="line">    callback.apply(<span class="literal">null</span>, loadedModNames);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="ES6-模块化"><a href="#ES6-模块化" class="headerlink" title="ES6 模块化"></a>ES6 模块化</h3><p>ES6 模块化是ECMA提出的JavaScript模块化规范，它在语言的层面上实现了模块化。浏览器厂商和Node.js 都宣布要原生支持该规范。它将逐渐取代CommonJS和AMD`规范，成为浏览器和服务器通用的模块解决方案。 采用 ES6 模块化导入及导出时的代码如下<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入</span></span><br><span class="line"><span class="keyword">import</span> &#123; name &#125; <span class="keyword">from</span> <span class="string">'./person.js'</span>;</span><br><span class="line"><span class="comment">// 导出</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> name = <span class="string">'zfpx'</span>;</span><br></pre></td></tr></table></figure></p><p>ES6模块虽然是终极模块化方案，但它的缺点在于目前无法直接运行在大部分 JavaScript 运行环境下，必须通过工具转换成标准的 ES5 后才能正常运行。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;javascript模块化CommonJS与AMD是如何实现的&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="javascript" scheme="/categories/javascript/"/>
    
    
      <category term="基础知识" scheme="/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
  </entry>
  
</feed>
